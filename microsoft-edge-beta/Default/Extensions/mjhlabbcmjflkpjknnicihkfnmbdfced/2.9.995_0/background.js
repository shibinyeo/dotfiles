!function(){var e={3465:function(e,t,n){e=n.nmd(e);var a="__lodash_hash_undefined__",i=9007199254740991,r="[object Arguments]",o="[object Boolean]",s="[object Date]",l="[object Function]",u="[object GeneratorFunction]",d="[object Map]",c="[object Number]",h="[object Object]",f="[object Promise]",p="[object RegExp]",v="[object Set]",m="[object String]",b="[object Symbol]",g="[object WeakMap]",y="[object ArrayBuffer]",w="[object DataView]",S="[object Float32Array]",x="[object Float64Array]",M="[object Int8Array]",I="[object Int16Array]",T="[object Int32Array]",P="[object Uint8Array]",k="[object Uint8ClampedArray]",E="[object Uint16Array]",A="[object Uint32Array]",j=/\w*$/,C=/^\[object .+?Constructor\]$/,_=/^(?:0|[1-9]\d*)$/,F={};F[r]=F["[object Array]"]=F[y]=F[w]=F[o]=F[s]=F[S]=F[x]=F[M]=F[I]=F[T]=F[d]=F[c]=F[h]=F[p]=F[v]=F[m]=F[b]=F[P]=F[k]=F[E]=F[A]=!0,F["[object Error]"]=F[l]=F[g]=!1;var O="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,D="object"==typeof self&&self&&self.Object===Object&&self,N=O||D||Function("return this")(),L=t&&!t.nodeType&&t,G=L&&e&&!e.nodeType&&e,R=G&&G.exports===L;function B(e,t){return e.set(t[0],t[1]),e}function U(e,t){return e.add(t),e}function $(e,t,n,a){var i=-1,r=e?e.length:0;for(a&&r&&(n=e[++i]);++i<r;)n=t(n,e[i],i,e);return n}function V(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function K(e){var t=-1,n=Array(e.size);return e.forEach((function(e,a){n[++t]=[a,e]})),n}function q(e,t){return function(n){return e(t(n))}}function W(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var z,H=Array.prototype,X=Function.prototype,Y=Object.prototype,J=N["__core-js_shared__"],Q=(z=/[^.]+$/.exec(J&&J.keys&&J.keys.IE_PROTO||""))?"Symbol(src)_1."+z:"",Z=X.toString,ee=Y.hasOwnProperty,te=Y.toString,ne=RegExp("^"+Z.call(ee).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ae=R?N.Buffer:void 0,ie=N.Symbol,re=N.Uint8Array,oe=q(Object.getPrototypeOf,Object),se=Object.create,le=Y.propertyIsEnumerable,ue=H.splice,de=Object.getOwnPropertySymbols,ce=ae?ae.isBuffer:void 0,he=q(Object.keys,Object),fe=Ne(N,"DataView"),pe=Ne(N,"Map"),ve=Ne(N,"Promise"),me=Ne(N,"Set"),be=Ne(N,"WeakMap"),ge=Ne(Object,"create"),ye=Ue(fe),we=Ue(pe),Se=Ue(ve),xe=Ue(me),Me=Ue(be),Ie=ie?ie.prototype:void 0,Te=Ie?Ie.valueOf:void 0;function Pe(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var a=e[t];this.set(a[0],a[1])}}function ke(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var a=e[t];this.set(a[0],a[1])}}function Ee(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var a=e[t];this.set(a[0],a[1])}}function Ae(e){this.__data__=new ke(e)}function je(e,t,n){var a=e[t];ee.call(e,t)&&$e(a,n)&&(void 0!==n||t in e)||(e[t]=n)}function Ce(e,t){for(var n=e.length;n--;)if($e(e[n][0],t))return n;return-1}function _e(e,t,n,a,i,f,g){var C;if(a&&(C=f?a(e,i,f,g):a(e)),void 0!==C)return C;if(!ze(e))return e;var _=Ve(e);if(_){if(C=function(e){var t=e.length,n=e.constructor(t);return t&&"string"==typeof e[0]&&ee.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!t)return function(e,t){var n=-1,a=e.length;for(t||(t=Array(a));++n<a;)t[n]=e[n];return t}(e,C)}else{var O=Ge(e),D=O==l||O==u;if(qe(e))return function(e,t){if(t)return e.slice();var n=new e.constructor(e.length);return e.copy(n),n}(e,t);if(O==h||O==r||D&&!f){if(V(e))return f?e:{};if(C=function(e){return"function"!=typeof e.constructor||Be(e)?{}:ze(t=oe(e))?se(t):{};var t}(D?{}:e),!t)return function(e,t){return Oe(e,Le(e),t)}(e,function(e,t){return e&&Oe(t,He(t),e)}(C,e))}else{if(!F[O])return f?e:{};C=function(e,t,n,a){var i,r=e.constructor;switch(t){case y:return Fe(e);case o:case s:return new r(+e);case w:return function(e,t){var n=t?Fe(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,a);case S:case x:case M:case I:case T:case P:case k:case E:case A:return function(e,t){var n=t?Fe(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}(e,a);case d:return function(e,t,n){return $(t?n(K(e),!0):K(e),B,new e.constructor)}(e,a,n);case c:case m:return new r(e);case p:return function(e){var t=new e.constructor(e.source,j.exec(e));return t.lastIndex=e.lastIndex,t}(e);case v:return function(e,t,n){return $(t?n(W(e),!0):W(e),U,new e.constructor)}(e,a,n);case b:return i=e,Te?Object(Te.call(i)):{}}}(e,O,_e,t)}}g||(g=new Ae);var N=g.get(e);if(N)return N;if(g.set(e,C),!_)var L=n?function(e){return function(e,t,n){var a=t(e);return Ve(e)?a:function(e,t){for(var n=-1,a=t.length,i=e.length;++n<a;)e[i+n]=t[n];return e}(a,n(e))}(e,He,Le)}(e):He(e);return function(e,t){for(var n=-1,a=e?e.length:0;++n<a&&!1!==t(e[n],n););}(L||e,(function(i,r){L&&(i=e[r=i]),je(C,r,_e(i,t,n,a,r,e,g))})),C}function Fe(e){var t=new e.constructor(e.byteLength);return new re(t).set(new re(e)),t}function Oe(e,t,n,a){n||(n={});for(var i=-1,r=t.length;++i<r;){var o=t[i],s=a?a(n[o],e[o],o,n,e):void 0;je(n,o,void 0===s?e[o]:s)}return n}function De(e,t){var n,a,i=e.__data__;return("string"==(a=typeof(n=t))||"number"==a||"symbol"==a||"boolean"==a?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function Ne(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!ze(e)||(t=e,Q&&Q in t))&&(We(e)||V(e)?ne:C).test(Ue(e));var t}(n)?n:void 0}Pe.prototype.clear=function(){this.__data__=ge?ge(null):{}},Pe.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Pe.prototype.get=function(e){var t=this.__data__;if(ge){var n=t[e];return n===a?void 0:n}return ee.call(t,e)?t[e]:void 0},Pe.prototype.has=function(e){var t=this.__data__;return ge?void 0!==t[e]:ee.call(t,e)},Pe.prototype.set=function(e,t){return this.__data__[e]=ge&&void 0===t?a:t,this},ke.prototype.clear=function(){this.__data__=[]},ke.prototype.delete=function(e){var t=this.__data__,n=Ce(t,e);return!(n<0||(n==t.length-1?t.pop():ue.call(t,n,1),0))},ke.prototype.get=function(e){var t=this.__data__,n=Ce(t,e);return n<0?void 0:t[n][1]},ke.prototype.has=function(e){return Ce(this.__data__,e)>-1},ke.prototype.set=function(e,t){var n=this.__data__,a=Ce(n,e);return a<0?n.push([e,t]):n[a][1]=t,this},Ee.prototype.clear=function(){this.__data__={hash:new Pe,map:new(pe||ke),string:new Pe}},Ee.prototype.delete=function(e){return De(this,e).delete(e)},Ee.prototype.get=function(e){return De(this,e).get(e)},Ee.prototype.has=function(e){return De(this,e).has(e)},Ee.prototype.set=function(e,t){return De(this,e).set(e,t),this},Ae.prototype.clear=function(){this.__data__=new ke},Ae.prototype.delete=function(e){return this.__data__.delete(e)},Ae.prototype.get=function(e){return this.__data__.get(e)},Ae.prototype.has=function(e){return this.__data__.has(e)},Ae.prototype.set=function(e,t){var n=this.__data__;if(n instanceof ke){var a=n.__data__;if(!pe||a.length<199)return a.push([e,t]),this;n=this.__data__=new Ee(a)}return n.set(e,t),this};var Le=de?q(de,Object):function(){return[]},Ge=function(e){return te.call(e)};function Re(e,t){return!!(t=null==t?i:t)&&("number"==typeof e||_.test(e))&&e>-1&&e%1==0&&e<t}function Be(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Y)}function Ue(e){if(null!=e){try{return Z.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function $e(e,t){return e===t||e!=e&&t!=t}(fe&&Ge(new fe(new ArrayBuffer(1)))!=w||pe&&Ge(new pe)!=d||ve&&Ge(ve.resolve())!=f||me&&Ge(new me)!=v||be&&Ge(new be)!=g)&&(Ge=function(e){var t=te.call(e),n=t==h?e.constructor:void 0,a=n?Ue(n):void 0;if(a)switch(a){case ye:return w;case we:return d;case Se:return f;case xe:return v;case Me:return g}return t});var Ve=Array.isArray;function Ke(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=i}(e.length)&&!We(e)}var qe=ce||function(){return!1};function We(e){var t=ze(e)?te.call(e):"";return t==l||t==u}function ze(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function He(e){return Ke(e)?function(e,t){var n=Ve(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&Ke(e)}(e)&&ee.call(e,"callee")&&(!le.call(e,"callee")||te.call(e)==r)}(e)?function(e,t){for(var n=-1,a=Array(e);++n<e;)a[n]=t(n);return a}(e.length,String):[],a=n.length,i=!!a;for(var o in e)!t&&!ee.call(e,o)||i&&("length"==o||Re(o,a))||n.push(o);return n}(e):function(e){if(!Be(e))return he(e);var t=[];for(var n in Object(e))ee.call(e,n)&&"constructor"!=n&&t.push(n);return t}(e)}e.exports=function(e){return _e(e,!0,!0)}},1296:function(e,t,n){var a=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,o=/^0o[0-7]+$/i,s=parseInt,l="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,u="object"==typeof self&&self&&self.Object===Object&&self,d=l||u||Function("return this")(),c=Object.prototype.toString,h=Math.max,f=Math.min,p=function(){return d.Date.now()};function v(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function m(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==c.call(e)}(e))return NaN;if(v(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=v(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var n=r.test(e);return n||o.test(e)?s(e.slice(2),n?2:8):i.test(e)?NaN:+e}e.exports=function(e,t,n){var a,i,r,o,s,l,u=0,d=!1,c=!1,b=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function g(t){var n=a,r=i;return a=i=void 0,u=t,o=e.apply(r,n)}function y(e){var n=e-l;return void 0===l||n>=t||n<0||c&&e-u>=r}function w(){var e=p();if(y(e))return S(e);s=setTimeout(w,function(e){var n=t-(e-l);return c?f(n,r-(e-u)):n}(e))}function S(e){return s=void 0,b&&a?g(e):(a=i=void 0,o)}function x(){var e=p(),n=y(e);if(a=arguments,i=this,l=e,n){if(void 0===s)return function(e){return u=e,s=setTimeout(w,t),d?g(e):o}(l);if(c)return s=setTimeout(w,t),g(l)}return void 0===s&&(s=setTimeout(w,t)),o}return t=m(t)||0,v(n)&&(d=!!n.leading,r=(c="maxWait"in n)?h(m(n.maxWait)||0,t):r,b="trailing"in n?!!n.trailing:b),x.cancel=function(){void 0!==s&&clearTimeout(s),u=0,a=l=i=s=void 0},x.flush=function(){return void 0===s?o:S(p())},x}}},t={};function n(a){var i=t[a];if(void 0!==i)return i.exports;var r=t[a]={id:a,loaded:!1,exports:{}};return e[a](r,r.exports,n),r.loaded=!0,r.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){"use strict";const e={sepia:{min:0,max:1,step:.1,sliderMin:0,sliderMax:1,default:0,format:e=>`sepia(${e})`},hueRotate:{step:8,sliderMin:-180,sliderMax:180,sliderStep:1,default:0,format:e=>`hue-rotate(${e}deg)`},grayscale:{min:0,max:1,step:.1,sliderMin:0,sliderMax:1,default:0,format:e=>`grayscale(${e})`},contrast:{min:0,step:.1,sliderMin:0,sliderMax:5,default:1,format:e=>`contrast(${e})`},brightness:{min:0,step:.1,sliderMin:0,sliderMax:5,sliderStep:.05,default:1,format:e=>`brightness(${e})`},saturate:{min:0,step:.1,sliderMin:0,sliderMax:5,sliderStep:.05,default:1,format:e=>`saturate(${e})`},invert:{min:0,max:1,step:.1,sliderMin:0,sliderMax:1,default:0,format:e=>`invert(${e})`},blur:{min:0,step:.1,sliderMin:0,sliderMax:10,sliderStep:.1,default:0,format:e=>`blur(${e}px)`},opacity:{min:0,max:1,step:.1,sliderMin:0,sliderMax:1,default:1,format:e=>`opacity(${e})`},scaleX:{isTransform:!0,step:.1,sliderMin:-1,sliderMax:3,sliderStep:.04,default:1,format:e=>`scaleX(${e})`},scaleY:{isTransform:!0,step:.1,sliderMin:-1,sliderMax:3,sliderStep:.04,default:1,format:e=>`scaleY(${e})`},translateX:{isTransform:!0,step:1,sliderMin:-300,sliderMax:300,sliderStep:5,default:0,format:e=>`translateX(${e}px)`},translateY:{isTransform:!0,step:1,sliderMin:-300,sliderMax:300,sliderStep:5,default:0,format:e=>`translateY(${e}px)`},rotateX:{isTransform:!0,step:1,sliderMin:-180,sliderMax:180,sliderStep:1,default:0,format:e=>`rotateX(${e}deg)`},rotateY:{isTransform:!0,step:1,sliderMin:-180,sliderMax:180,sliderStep:1,default:0,format:e=>`rotateY(${e}deg)`},rotateZ:{isTransform:!0,step:1,sliderMin:-180,sliderMax:180,sliderStep:1,default:0,format:e=>`rotateZ(${e}deg)`}};var t,a,i;const r=!(!("requestPictureInPicture"in HTMLVideoElement.prototype)||!("pictureInPictureElement"in Document.prototype)),o=(null===(t=document.featurePolicy)||void 0===t||t.allowsFeature("picture-in-picture"),null===(a=window.CSS)||void 0===a||null===(i=a.supports)||void 0===i?void 0:i.call(a,"backdrop-filter: invert(1)")),s=["speed","lastSpeed","enabled","enabledLatestViaPopup","elementFx","backdropFx","monoOutput","audioFx","audioFxAlt","audioPan"];let l,u,d;function c(e,t,n){let a=n;return null!=e&&(a=Math.max(e,a)),null!=t&&(a=Math.min(t,a)),a}function h(e,t){const n=10**t;return Math.round(e*n)/n}function f(){return Math.ceil(1e10*Math.random()).toString()}function p(){var e;return d=null!==(e=d)&&void 0!==e?e:navigator.userAgent.includes("Firefox/"),d}!function(e){e[e.SET=1]="SET",e[e.ADD=2]="ADD",e[e.CYCLE=3]="CYCLE"}(l||(l={})),function(e){e[e.FX=1]="FX",e[e.AUDIO_FX=2]="AUDIO_FX",e[e.MEDIA=3]="MEDIA",e[e.MISC=4]="MISC"}(u||(u={}));let v={nothing:{group:u.MISC,generate:()=>({id:f(),command:"nothing",enabled:!0,greedy:!0})},runCode:{group:u.MISC,valueType:"modalString",generate:()=>({id:f(),command:"runCode",enabled:!0,greedy:!0,valueString:"// code here"})},openUrl:{group:u.MISC,valueType:"string",generate:()=>({id:f(),command:"openUrl",enabled:!0,greedy:!0,valueString:"https://www.google.com/"})},adjustSpeed:{valueType:"adjustMode",hasFeedback:!0,valueMin:.07,valueMax:16,valueStep:.1,valueDefault:1,generate:()=>({id:f(),command:"adjustSpeed",enabled:!0,greedy:!0,adjustMode:l.SET})},speedChangesPitch:{valueType:"state",hasFeedback:!0,requiresMedia:!0,generate:()=>({id:f(),command:"speedChangesPitch",enabled:!0,greedy:!0,valueState:"toggle"})},setPin:{valueType:"state",hasFeedback:!0,generate:()=>({id:f(),command:"setPin",enabled:!0,greedy:!0,valueState:"toggle"})},setState:{valueType:"state",hasFeedback:!0,generate:()=>({id:f(),command:"setState",enabled:!0,greedy:!0,valueState:"toggle"})},seek:{group:u.MEDIA,valueType:"number",requiresMedia:!0,noNull:!0,hasFeedback:!0,generate:()=>({id:f(),command:"seek",enabled:!0,greedy:!0,valueNumber:10})},setPause:{group:u.MEDIA,valueType:"state",requiresMedia:!0,hasFeedback:!0,generate:()=>({id:f(),command:"setPause",enabled:!0,greedy:!0,valueState:"toggle"})},setMute:{group:u.MEDIA,hasFeedback:!0,valueType:"state",requiresMedia:!0,generate:()=>({id:f(),command:"setMute",enabled:!0,greedy:!0,valueState:"toggle"})},adjustVolume:{group:u.MEDIA,hasFeedback:!0,valueType:"number",requiresMedia:!0,valueDefault:.05,generate:()=>({id:f(),command:"adjustVolume",enabled:!0,greedy:!0})},setMark:{group:u.MEDIA,hasFeedback:!0,valueType:"string",requiresMedia:!0,generate:()=>({id:f(),command:"setMark",enabled:!0,greedy:!0,valueString:"mark1"})},seekMark:{group:u.MEDIA,hasFeedback:!0,valueType:"string",requiresMedia:!0,generate:()=>({id:f(),command:"seekMark",enabled:!0,greedy:!0,valueString:"mark1"})},toggleLoop:{group:u.MEDIA,hasFeedback:!0,valueType:"string",requiresMedia:!0,generate:()=>({id:f(),command:"toggleLoop",enabled:!0,greedy:!0,valueString:"mark1"})},fullscreen:{group:u.MEDIA,requiresVideo:!0,generate:()=>({id:f(),command:"fullscreen",enabled:!0,greedy:!0})},PiP:{group:u.MEDIA,valueType:"state",requiresVideo:!0,requiresPiPApi:!0,generate:()=>({id:f(),command:"PiP",enabled:!0,greedy:!0,valueState:"toggle"})},setFx:{group:u.FX,hasFeedback:!0,withFilterTarget:!0,valueType:"state",generate:()=>({id:f(),command:"setFx",enabled:!0,greedy:!0,valueState:"toggle",filterTarget:"element"})},resetFx:{group:u.FX,hasFeedback:!0,withFilterTarget:!0,generate:()=>({id:f(),command:"resetFx",enabled:!0,greedy:!0,filterTarget:"element"})},flipFx:{group:u.FX,hasFeedback:!0,generate:()=>({id:f(),command:"flipFx",enabled:!0,greedy:!0})},adjustFilter:{group:u.FX,hasFeedback:!0,valueType:"adjustMode",withFilterOption:!0,withFilterTarget:!0,generate:()=>({id:f(),command:"adjustFilter",filterOption:"hueRotate",enabled:!0,greedy:!0,filterTarget:"element",adjustMode:l.ADD})},adjustGain:{group:u.AUDIO_FX,hasFeedback:!0,valueType:"adjustMode",requiresTabCapture:!0,valueMin:0,valueMax:16,valueStep:.05,valueDefault:1,generate:()=>({id:f(),command:"adjustGain",enabled:!0,greedy:!0,adjustMode:l.ADD})},adjustPitch:{group:u.AUDIO_FX,hasFeedback:!0,valueType:"adjustMode",requiresTabCapture:!0,valueMin:-36,valueMax:36,valueStep:1,valueDefault:0,generate:()=>({id:f(),command:"adjustPitch",enabled:!0,greedy:!0,adjustMode:l.ADD})},adjustDelay:{group:u.AUDIO_FX,hasFeedback:!0,valueType:"adjustMode",requiresTabCapture:!0,valueMin:0,valueMax:60,valueStep:.05,valueDefault:0,generate:()=>({id:f(),command:"adjustDelay",enabled:!0,greedy:!0,adjustMode:l.ADD})},tabCapture:{group:u.AUDIO_FX,hasFeedback:!0,valueType:"state",requiresTabCapture:!0,generate:()=>({id:f(),command:"tabCapture",enabled:!0,greedy:!0,valueState:"toggle",global:!0})}};function m(){let e=[{...v.adjustSpeed.generate(),key:"KeyA",adjustMode:l.ADD,valueNumberAlt:-.1},{...v.adjustSpeed.generate(),key:"KeyS",valueNumber:1,adjustMode:l.SET},{...v.adjustSpeed.generate(),key:"KeyD",adjustMode:l.ADD,valueNumberAlt:.1,spacing:1},{...v.setPin.generate(),key:"KeyQ"},{...v.setState.generate(),key:{code:"KeyQ",shiftKey:!0},spacing:2},{...v.seek.generate(),key:"KeyZ",enabled:!0,valueNumber:-5},{...v.seek.generate(),key:"KeyX",enabled:!0,valueNumber:10,spacing:1},{...v.seek.generate(),key:{shiftKey:!0,code:"KeyZ"},enabled:!0,valueNumber:-.041,valueBool3:!0},{...v.seek.generate(),key:{shiftKey:!0,code:"KeyX"},enabled:!0,valueNumber:.041,spacing:1,valueBool3:!0},{...v.fullscreen.generate(),key:{shiftKey:!0,code:"KeyF"},enabled:!0,valueBool:!0,spacing:2},{...v.setMark.generate(),key:{shiftKey:!0,code:"KeyW"},valueString:"mark1"},{...v.seekMark.generate(),key:"KeyW",valueString:"mark1"},{...v.toggleLoop.generate(),key:"KeyR",valueString:"mark1",spacing:2,enabled:!1}];return o&&e.push({...v.adjustFilter.generate(),key:{code:"KeyE"},filterOption:"invert",filterTarget:"both",adjustMode:l.CYCLE,enabled:!1,valueCycle:[0,1]},{...v.adjustFilter.generate(),key:{code:"KeyE",shiftKey:!0},filterOption:"grayscale",filterTarget:"backdrop",adjustMode:l.CYCLE,enabled:!1,valueCycle:[0,1],spacing:2}),e}const b=function(e,t){let n=[],a=!1;for(let t of e)a&&(n.push(null),a=!1),n=[...n,...t],a=!0;return n}(function(e,t){let n=new Map;for(let i of e){var a;const e=t(i),r=null!==(a=n.get(e))&&void 0!==a?a:[];r.push(i),n.set(e,r)}const i=[];return n.forEach((e=>{i.push(e)})),i}(Object.entries(v).filter((e=>!e[1].requiresTabCapture||chrome.tabCapture)).filter((e=>!e[1].requiresPiPApi||r)).map((e=>{let[t,n]=e;return[t,n.group]})),(e=>e[1])).map((e=>e.map((e=>e[0])))));function g(){return{version:10,firstUse:(new Date).getTime(),keybinds:m(),common:{speed:1,enabled:!0,backdropFx:y(),elementFx:y(),audioFx:w()}}}function y(){const[t,n]=function(e,t){let n=[],a=[];return e.forEach((e=>{(e=>{let[t,n]=e;return n.isTransform})(e)?n.push(e):a.push(e)})),[n,a]}(Object.entries(e));return{filters:n.map((e=>{let[t,n]=e;return{name:t,value:n.default}})),transforms:t.map((e=>{let[t,n]=e;return{name:t,value:n.default}}))}}function w(){return{pitch:0,volume:1,delay:0,eq:{enabled:!1,factor:1,values:Array(10).fill(0)}}}function S(e){var t,n;const a=g();return!e||e.version<7?a:(7===e.version&&(e=function(e){var t;return e.version=8,null===(t=e.rules)||void 0===t||t.forEach((e=>{e.condition={parts:[{type:e.matchType||"CONTAINS",id:f(),value:e.match||""}]},delete e.matchType,delete e.match})),e}(e)),8===e.version&&(e=function(e){var t;return e.version=9,null===(t=e.keybinds)||void 0===t||t.forEach((e=>{"seek"===e.command&&(e.valueBool2=!0)})),e}(e)),9===e.version&&(e=function(e){var t;return e.version=10,null===(t=e.keybinds)||void 0===t||t.forEach((e=>{"preservePitch"===e.command&&(e.command="speedChangesPitch",e.valueState="on"===e.valueState?"off":"off"===e.valueState?"on":"toggle")})),e}(e)),null!==(t=e.keybinds)&&void 0!==t&&t.length&&(e.keybinds=e.keybinds.filter((e=>b.includes(e.command)))),(null===(n=e)||void 0===n?void 0:n.version)!==a.version?a:e)}function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function M(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==x(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,"string");if("object"!==x(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===x(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.freeze([{name:"1965",values:[-6,-17.2,-6,0,-3.6,9.2,1.2,9.2,3.6,-5.2]},{name:"1965 - Part 2",values:[-18,-14.4,0,0,-3.6,9.2,1.2,9.2,3.6,-5.2]},{name:"Lo-Fidelity",values:[-15.1,-9.4,0,2.3,-2,4.3,4.3,-2.3,-4.6,-8.9]},{name:"Musical Presence",values:[0,0,0,0,0,2.5,5,2.5,0,0]},{name:"Notch Every Two Octaves",values:[-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99]},{name:"Rattle The Trunk",values:[17.99,17.99,9,0,0,0,0,0,0,0]},{name:"Simple Bass Cut",values:[-4,-3,-2,-2,-2,0,0,0,0,0]},{name:"Simple Bass Lift",values:[6,6,3,3,3,0,0,0,0,0]},{name:"Simple High Cut",values:[0,0,0,0,0,-2,-2,-3,-3,-3]},{name:"Simple High Lift",values:[0,0,0,0,0,1,2,2,3,4]},{name:"Vocal Presence - Boost",values:[0,0,0,0,0,0,6.5,0,0,0]},{name:"Vocal Presence - Cut",values:[0,0,0,0,0,0,-6.5,0,0,0]}]),Object.freeze([{name:"20 Band Classic V",values:[5,6,3.54,.59,-.48,-2.5,-5,-7,-8,-8,-7,-5,-3,-2.5,-1,2,3,4,5,4.02]},{name:"Bowed String",values:[0,0,-1.2,-1.6,-2.4,-2.8,-1.6,-1.6,-1.6,0,0,0,0,0,2.4,3.6,5.6,0,0,0]},{name:"Bright and Punchy",values:[-3,3,6,4.5,3,1.5,0,0,0,0,0,0,0,1,2,3,4,4,4,4]},{name:"Cymbal Shimmer",values:[0,0,0,0,0,0,0,0,0,0,0,-.1,-.3,-.5,-.4,.2,1.3,2.6,3.6,4]},{name:"Dark and Dull",values:[-6,-4,-2,0,0,0,0,0,0,0,0,0,0,-3,-6,-9,-12,-15,-18,-18]},{name:"Destination - Car Stereo",values:[-4,-2,0,3,4,3,1.5,0,-1,-2,-2,-1,0,1,2,3,4,2,0,-3]},{name:"Heavy Guitar",values:[0,-.2,-.1,1,1.9,1.6,.4,-.5,-1.1,-2.2,-3.6,-3.9,-2.9,-1.6,-.5,.1,.1,0,0,0]},{name:"Liven up dead samples",values:[0,0,0,0,0,0,0,0,0,0,0,.1,.1,-.2,-.6,.5,3,3.9,1.5,-.4]},{name:"Notch Every Octave",values:[-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99]},{name:"Possible Bass",values:[0,0,5.2,6,3.2,0,-11.6,-5.2,-4,-4,0,3.2,4.8,0,0,0,-3.2,-7.2,-10.8,-14]},{name:"Sloping High End Boost",values:[0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,6,7,8,8]},{name:"Sloping Low End Boost",values:[8,8,8,8,7,6,5,4,3,2,1,0,0,0,0,0,0,0,0,0]},{name:"Tinny and Brittle",values:[-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,0,0,0,1,3.52,6,6,3,1]},{name:"Vocal Magic (breath)",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,.1,-.1,-.5,2,2.5,1]}]),Object.freeze([{name:"Bass - Increased Clarity",values:[-4,-3.4,-1.9,-.3,.6,.6,.2,-.3,-1.2,-1.5,1.4,2.9,.7,.2,.8,.5,0,-2,-.5,-.5,-.4,-.2,0,0,-.2,-.4,-.4,-.3,-.1,0]},{name:"Background Vocal",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-.2,-.3,-.4,-.4,-3,-6,-3,0,0,-.1,0,0,0]},{name:"Classic V",values:[3,2.5,1.3,.2,-.4,-.5,-.2,.2,.4,.3,-.3,-1.6,-3.4,-5.7,-8.2,-10.2,-10.9,-9.8,-7.4,-4.5,-2.3,-.9,-.1,0,-.2,-.3,.2,1.3,2.5,3]},{name:"Destination - Home Theater",values:[4.5,6,7.5,7.5,5,3,1.5,.5,0,-.5,-1.5,-3,-5,-3,-1.5,0,1.5,3,3,3,1.5,0,0,3,6,7.5,7.5,6,3,0]},{name:"Drums",values:[0,0,0,0,0,0,0,-.1,.3,.4,-2,-2.8,0,.6,-.2,-.1,0,-.2,-.3,-.5,-.4,-.1,0,0,.2,-.3,-.1,2.5,2.1,0]},{name:"Generic Attack Booster",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,-.1,-.1,-.1,.2,.6,1.3,2,2.8,3.1,2.7,1.8,.6,-.2,-.3,-.1,0]},{name:"Generic Mud Removal",values:[0,0,0,0,-.1,-.3,-.7,-1.5,-2.4,-3,-2.8,-2,-.8,0,.4,.3,0,-.1,-.1,0,0,0,0,0,0,0,0,0,0,0]},{name:"Gentle Hi Boost",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.5,1.5,3,5,5,3,1.5,.5]},{name:"Gentle Hi Cut",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-.5,-1.5,-3,-5,-5,-3,-1.5,-.5]},{name:"Gentle Low Boost",values:[0,.5,1.5,3,5,3,1.5,.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{name:"Gentle Low Cut",values:[0,-.5,-1.5,-3,-5,-3,-1.5,-.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{name:"Gentle Mid Boost",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,.5,1.5,3,5,5,3,1.5,.5,0,0,0,0,0,0,0,0,0]},{name:"Gentle Mid Cut",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,-.5,-1.5,-3,-5,-5,-3,-1.5,-.5,0,0,0,0,0,0,0,0,0]},{name:"Guitar - Increases Attack",values:[0,0,0,0,-1.5,-4,-2,0,0,0,0,0,0,0,0,0,0,-.2,-.3,-.4,2,0,-.1,0,0,0,-.1,0,0,0]},{name:"Keyboards - Bright and Clear",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-.2,-.3,-.4,-.4,2,5,2.5,0,0,-.1,0,0,0]},{name:"Kick - Less Boxy, more Attack",values:[0,0,0,0,0,0,0,0,0,0,-2.5,-6,-2.5,0,0,0,0,0,0,0,0,2,5,2,0,0,0,0,0,0]},{name:"Lead Vocal - Clarity",values:[0,0,0,0,0,0,0,0,-3,0,0,0,0,0,0,0,0,-.2,-.3,-.4,-.4,0,2,0,0,4,-.1,0,0,0]},{name:"Notch Every 2/3 Octave",values:[-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99]},{name:"RIAA De-Emphasis",values:[18.3,17.6,16.7,15.6,14.2,12.8,11.3,9.6,8,6.5,5,3.7,2.6,1.6,.7,0,-.7,-1.6,-2.6,-3.7,-5.1,-6.6,-8.2,-10,-11.9,-13.8,-15.7,-17.7,-19.7,-20]},{name:"Snare - Increase Snap",values:[0,-.1,-.2,-.1,.5,1.3,1.9,1.9,1.3,.4,-.1,-.3,-.2,0,.1,0,0,-.1,-.2,-.4,-.6,-.7,-.5,1.5,2,0,0,0,.9,0]},{name:"cymbals sans gong",values:[-8,-6.5,-3.3,-.4,.4,-.5,-2.3,-3.7,-4.5,-4.4,-3.7,-2.3,-.9,.1,.5,.3,0,-.3,-.5,-.5,-.4,-.2,0,.1,0,0,-.1,0,0,0]}]);var I=n(1296),T=n.n(I);function P(e){return new Promise(((t,n)=>{chrome.tabs.query(e,(e=>{chrome.runtime.lastError?n(chrome.runtime.lastError.message):t(e||[])}))}))}async function k(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;for(let a=0;a<Math.max(0,null!=t?t:3);a++){a&&await new Promise(((e,t)=>setTimeout((()=>e(!0)),null!=n?n:100)));try{return await P(e)}catch(e){}}}function E(e,t){var n,a;return(null==e?void 0:e.tabId)===(null==t?void 0:t.tabId)&&(null!==(n=null==e?void 0:e.frameId)&&void 0!==n?n:null)===(null!==(a=null==t?void 0:t.frameId)&&void 0!==a?a:null)}function A(e){if(e.tab)return{tabId:e.tab.id,frameId:e.frameId,windowId:e.tab.windowId}}function j(e){return e.toFixed(2).slice(0,4)}function C(e){const t={};return"backdrop"!==e&&"both"!==e||(t.backdrop=!0),"element"!==e&&"both"!==e||(t.element=!0),t}function _(e,t,n,a){chrome.tabs.sendMessage(n,{type:"APPLY_MEDIA_EVENT",event:e,key:t},null==a?void 0:{frameId:a})}function F(e,t,n){chrome.tabs.sendMessage(t,e,null==n?void 0:{frameId:n})}function O(e,t,n){let a=!1,i=!1;return t.parts.forEach((t=>{if(t.disabled)return;let n=!1;if("STARTS_WITH"===t.type)n=e.startsWith(t.value);else if("CONTAINS"===t.type)n=e.includes(t.value);else{if("REGEX"!==t.type)return;try{n=new RegExp(t.value).test(e)}catch(e){}}(t.inverse?n:!n)?a=!0:i=!0})),i||a?(!t.matchAll||!a)&&i:n}var D=n(3465),N=n.n(D);class L{constructor(e){var t;this.state=e,M(this,"subs",new Set),M(this,"pins",[]),M(this,"frozen",new Set),M(this,"reload",(e=>{try{let t=S(e);t.version===g().version&&(this.state=t,this.pins=[],this.subs.forEach((e=>{e.handleUpdate(this.get(e.selector,e.tabId))})),this.persist())}catch(e){return!1}return!0})),M(this,"get",((e,t)=>{const n={};for(let i in e){const e=i;if("isPinned"===e)n.isPinned=!!this.pins.find((e=>e.tabId===t));else if(s.includes(e)){var a;const i=(null===(a=this.pins.find((e=>e.tabId===t)))||void 0===a?void 0:a.ctx)||this.state.common;n[e]=i[e]}else n[e]=this.state[e]}return e.enabled&&this.get({superDisable:!0}).superDisable&&(n.enabled=!1),n})),M(this,"_set",((e,t,n,a)=>{n&&(this.state=g(),this.pins=[]);const i={real:[],contextCommon:[],contextCurrent:[],isPinnedCurrent:!1};let r;const o=e=>{if(!e&&r)return;const n=this.pins.find((e=>e.tabId===t));r={pin:n,ctx:(null==n?void 0:n.ctx)||this.state.common}};if("isPinned"in e&&null!=t){if(o(),e.isPinned&&!r.pin){i.isPinnedCurrent=!0,this.pins=this.pins||[];let e=this.state.common;var l,u;a&&this.state.inheritPreviousContext&&(e=null!==(l=null===(u=this.pins.find((e=>e.tabId===a)))||void 0===u?void 0:u.ctx)&&void 0!==l?l:this.state.common),this.pins.push({tabId:t,ctx:N()(e)}),o(!0)}!e.isPinned&&r.pin&&(i.isPinnedCurrent=!0,this.pins=(this.pins||[]).filter((e=>e.tabId!==t)),o(!0))}for(let[t,n]of Object.entries(e)){let a=t;if("isPinned"!==a)if(s.includes(a)){let n=t;o(),r.ctx[n]!==e[n]&&(r.ctx[n]=e[n],i[r.pin?"contextCurrent":"contextCommon"].push(n))}else n!==this.state[a]&&(this.state[a]=n,i.real.push(a))}return this.persistThrottled(),i})),M(this,"set",((e,t)=>{const n=Array.isArray(e)?e:[e];let a=!1;const i=new Set;for(let e of n){const{override:t,tabId:n,ignoreSub:r,overDefault:o}=e,s=this._set(t,n,o,e.inheritContextFromTabId);(s.contextCommon.includes("speed")||s.real.includes("freePitch"))&&(a=!0);for(let e of this.subs){if(r&&e.id===r)continue;const t=!!this.pins.find((t=>t.tabId===e.tabId));(o||G(e,t,n,s))&&i.add(e)}}if(t?i.forEach((e=>this.frozen.add(e))):i.forEach((e=>{e.handleUpdate(this.get(e.selector,e.tabId))})),a)try{this.updateBackgroundSpeed()}catch(e){}})),M(this,"unfreeze",(()=>{this.frozen.forEach((e=>{e.handleUpdate(this.get(e.selector,e.tabId))})),this.frozen.clear()})),M(this,"updateBackgroundSpeed",(()=>{window.globalMedia.scopes.forEach((e=>{var t,n,a,i;const r=this.get({enabled:!0,speed:!0,isPinned:!0,freePitch:!0},null===(t=e.tabInfo)||void 0===t?void 0:t.tabId);r.enabled&&!r.isPinned&&F({type:"BG_SPEED_OVERRIDE",speed:null!==(n=r.speed)&&void 0!==n?n:1,freePitch:r.freePitch},null===(a=e.tabInfo)||void 0===a?void 0:a.tabId,null===(i=e.tabInfo)||void 0===i?void 0:i.frameId)}))})),M(this,"persist",(()=>{chrome.storage.local.set({config:this.state})})),M(this,"persistThrottled",T()(this.persist,5e3,{trailing:!0,maxWait:15e3})),M(this,"handlePortConnect",(e=>{if(!e.name.startsWith("subscribe "))return;const{selector:t,tabId:n,wait:a,maxWait:i,id:r}=JSON.parse(e.name.slice(10)),o={selector:t,tabId:n,handleUpdate:T()((t=>{e.postMessage(t)}),null!=a?a:0,{leading:!0,trailing:!0,...null==i?{}:{maxWait:i}}),id:r};this.subs.add(o),e.onDisconnect.addListener((e=>{this.subs.delete(o)}))})),M(this,"handleMessage",((e,t,n)=>{"PUSH_VIEW"===e.type?(this.set(e.init),n(!0)):"FETCH_VIEW"===e.type?n(this.get(e.selector,e.tabId)):"GET_STATE"===e.type?n(this.state):"RELOAD_STATE"===e.type&&n(this.reload(e.state))})),chrome.runtime.onMessage.addListener(this.handleMessage),chrome.runtime.onConnect.addListener(this.handlePortConnect),null===(t=chrome.runtime.onSuspend)||void 0===t||t.addListener((()=>{this.persistThrottled.flush()}))}}function G(e,t,n,a){const i=e.tabId===n||-1===e.tabId;if(e.selector.enabled&&a.real.includes("superDisable"))return!0;if(e.selector.isPinned&&i&&a.isPinnedCurrent)return!0;for(let n in e.selector){const r=n;if(s.includes(r)){if(i&&a.isPinnedCurrent)return!0;if((t||-1===e.tabId)&&a.contextCurrent.includes(r)&&i)return!0;if((!t||-1===e.tabId)&&a.contextCommon.includes(r))return!0}else if(a.real.includes(r))return!0}}function R(e,t){return window.globalState?Promise.resolve(window.globalState.get(e,t)):new Promise(((n,a)=>{window.globalState?n(window.globalState.get(e,t)):chrome.runtime.sendMessage({type:"FETCH_VIEW",selector:e,tabId:t},(e=>{chrome.runtime.lastError?a(chrome.runtime.lastError):n(e)}))}))}function B(e,t,n,a,i,r){e=function(e){return Object.fromEntries(Object.entries(e).filter((e=>{let[t,n]=e;return n})))}(e);const o={cbs:a?new Set([a]):new Set,subId:f()},s=(e,t)=>{o.view=e,o.cbs.forEach((n=>{n(e,t)}))};if(window.globalState){const n=T()(s,null!=i?i:0,{trailing:!0,leading:!0,...null==r?{}:{maxWait:r}}),a={selector:e,tabId:t,handleUpdate:n,id:o.subId};window.globalState.subs.add(a),o.release=()=>{o.released||(o.released=!0,o.cbs.clear(),window.globalState.subs.delete(a))}}else{const n=chrome.runtime.connect({name:`subscribe ${JSON.stringify({selector:e,tabId:t,id:o.subId,wait:i,maxWait:r})}`});n.onMessage.addListener((e=>{s(e)})),o.release=()=>{o.released||(o.released=!0,o.cbs.clear(),n.disconnect())}}return o.push=n=>{const a={};var i,r;Object.keys(e).forEach((e=>{a[e]=n[e]})),s(a,!1),i={override:a,tabId:t,ignoreSub:o.subId},null!==(r=window.globalState)&&void 0!==r&&r.set?(window.globalState.set(i),Promise.resolve()):new Promise(((e,t)=>{const n={};for(let[e,t]of Object.entries(i.override||{}))n[e]=null!=t?t:null;i.override=n,chrome.runtime.sendMessage({type:"PUSH_VIEW",init:i},(n=>{chrome.runtime.lastError?t(chrome.runtime.lastError):e()}))}))},n&&R(e,t).then((e=>{s(e,!0)})),o}class U{constructor(){M(this,"client",B({enabled:!0,isPinned:!0,hideBadge:!0},-1,!0,(()=>{this.updateBadgesDeb()}),100)),M(this,"speedClient",B({speed:!0},-1,!0,(()=>{this.updateBadgesDeb()}),1e3)),M(this,"updateBadgesDeb",T()($,500,{trailing:!0,leading:!0})),chrome.tabs.onActivated.addListener((e=>{window.previousTabId=window.currentTabId,window.currentTabId=e.tabId,this.updateBadgesDeb()})),chrome.tabs.onUpdated.addListener(((e,t)=>{t.status&&this.updateBadgesDeb()}))}}async function $(){const e=await k({active:!0,currentWindow:void 0});if(null==e||!e.length)return;const t=e.map((e=>e.id)),n=await R({speed:!0,enabled:!0,hideBadge:!0});n.hideBadge||!n.enabled?chrome.browserAction.setBadgeText({text:"",tabId:null}):(chrome.browserAction.setBadgeBackgroundColor({color:"#a64646"}),chrome.browserAction.setBadgeText({text:j(n.speed),tabId:null})),chrome.browserAction.setIcon({path:n.enabled?V:K});for(let e of t){const t=await R({speed:!0,enabled:!0,isPinned:!0},e);n.hideBadge||!t.enabled?chrome.browserAction.setBadgeText({text:"",tabId:e}):(chrome.browserAction.setBadgeBackgroundColor({color:t.isPinned?"#44a":"#a64646",tabId:e}),chrome.browserAction.setBadgeText({text:j(t.speed),tabId:e})),chrome.browserAction.setIcon({path:t.enabled?V:K,tabId:e})}}const V={128:"icons/128.png"},K={128:"icons/128g.png"};class q{constructor(){M(this,"ports",[]),M(this,"disconnectListeners",new Set),M(this,"handleDisconnect",(e=>{this.ports=this.ports.filter((t=>t!==e)),this.disconnectListeners.forEach((t=>{t(e)}))})),chrome.runtime.onConnect.addListener((async e=>{this.ports.push(e),e.onDisconnect.addListener(this.handleDisconnect)}))}}const W=["en","es","it","ja","ko","pt_BR","ru","tr","vi","zh_CN","zh_TW"];class z{constructor(e){var t=this;this.lang=e,M(this,"gsm",void 0),M(this,"loadedLang",void 0),M(this,"client",B({language:!0},null,!0,(e=>{this.loadLocale(e.language)}))),M(this,"loadLocale",(async function(e){t.loadedLang&&t.loadedLang.lang==e||(t.gsm=await async function(e){let t=await new Promise(((e,t)=>{chrome.i18n.getAcceptLanguages((t=>e(t)))})),n=[e,...navigator.languages,...t,"en"].map((e=>(e||"").replace("-","_").toLowerCase()));for(let e of n){const t=W.findIndex((t=>t.toLowerCase()===e));if(!(t<0))try{return H(W[t])}catch(e){}}return H("en")}(e),t.loadedLang={lang:e},window.gsm=t.gsm)})),this.loadLocale(e),chrome.runtime.onMessage.addListener(((e,t,n)=>{"REQUEST_GSM"===e.type&&n(this.gsm)}))}}async function H(e){const t=await fetch(chrome.runtime.getURL(`locales/${e}.json`));return await t.json()}function X(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Y(e){return!!e&&!!e[De]}function J(e){var t;return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===Ne}(e)||Array.isArray(e)||!!e[Oe]||!!(null===(t=e.constructor)||void 0===t?void 0:t[Oe])||ne(e)||ae(e))}function Q(e,t,n){void 0===n&&(n=!1),0===Z(e)?(n?Object.keys:Le)(e).forEach((function(a){n&&"symbol"==typeof a||t(a,e[a],e)})):e.forEach((function(n,a){return t(a,n,e)}))}function Z(e){var t=e[De];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:ne(e)?2:ae(e)?3:0}function ee(e,t){return 2===Z(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function te(e,t,n){var a=Z(e);2===a?e.set(t,n):3===a?(e.delete(t),e.add(n)):e[t]=n}function ne(e){return je&&e instanceof Map}function ae(e){return Ce&&e instanceof Set}function ie(e){return e.o||e.t}function re(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=Ge(e);delete t[De];for(var n=Le(t),a=0;a<n.length;a++){var i=n[a],r=t[i];!1===r.writable&&(r.writable=!0,r.configurable=!0),(r.get||r.set)&&(t[i]={configurable:!0,writable:!0,enumerable:r.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function oe(e,t){return void 0===t&&(t=!1),le(e)||Y(e)||!J(e)||(Z(e)>1&&(e.set=e.add=e.clear=e.delete=se),Object.freeze(e),t&&Q(e,(function(e,t){return oe(t,!0)}),!0)),e}function se(){X(2)}function le(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function ue(e){var t=Re[e];return t||X(18,e),t}function de(){return Ee}function ce(e,t){t&&(ue("Patches"),e.u=[],e.s=[],e.v=t)}function he(e){fe(e),e.p.forEach(ve),e.p=null}function fe(e){e===Ee&&(Ee=e.l)}function pe(e){return Ee={p:[],l:Ee,h:e,m:!0,_:0}}function ve(e){var t=e[De];0===t.i||1===t.i?t.j():t.O=!0}function me(e,t){t._=t.p.length;var n=t.p[0],a=void 0!==e&&e!==n;return t.h.g||ue("ES5").S(t,e,a),a?(n[De].P&&(he(t),X(4)),J(e)&&(e=be(t,e),t.l||ye(t,e)),t.u&&ue("Patches").M(n[De].t,e,t.u,t.s)):e=be(t,n,[]),he(t),t.u&&t.v(t.u,t.s),e!==Fe?e:void 0}function be(e,t,n){if(le(t))return t;var a=t[De];if(!a)return Q(t,(function(i,r){return ge(e,a,t,i,r,n)}),!0),t;if(a.A!==e)return t;if(!a.P)return ye(e,a.t,!0),a.t;if(!a.I){a.I=!0,a.A._--;var i=4===a.i||5===a.i?a.o=re(a.k):a.o;Q(3===a.i?new Set(i):i,(function(t,r){return ge(e,a,i,t,r,n)})),ye(e,i,!1),n&&e.u&&ue("Patches").R(a,n,e.u,e.s)}return a.o}function ge(e,t,n,a,i,r){if(Y(i)){var o=be(e,i,r&&t&&3!==t.i&&!ee(t.D,a)?r.concat(a):void 0);if(te(n,a,o),!Y(o))return;e.m=!1}if(J(i)&&!le(i)){if(!e.h.F&&e._<1)return;be(e,i),t&&t.A.l||ye(e,i)}}function ye(e,t,n){void 0===n&&(n=!1),e.h.F&&e.m&&oe(t,n)}function we(e,t){var n=e[De];return(n?ie(n):e)[t]}function Se(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var a=Object.getOwnPropertyDescriptor(n,t);if(a)return a;n=Object.getPrototypeOf(n)}}function xe(e){e.P||(e.P=!0,e.l&&xe(e.l))}function Me(e){e.o||(e.o=re(e.t))}function Ie(e,t,n){var a=ne(t)?ue("MapSet").N(t,n):ae(t)?ue("MapSet").T(t,n):e.g?function(e,t){var n=Array.isArray(e),a={i:n?1:0,A:t?t.A:de(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=a,r=Be;n&&(i=[a],r=Ue);var o=Proxy.revocable(i,r),s=o.revoke,l=o.proxy;return a.k=l,a.j=s,l}(t,n):ue("ES5").J(t,n);return(n?n.A:de()).p.push(a),a}function Te(e){return Y(e)||X(22,e),function e(t){if(!J(t))return t;var n,a=t[De],i=Z(t);if(a){if(!a.P&&(a.i<4||!ue("ES5").K(a)))return a.t;a.I=!0,n=Pe(t,i),a.I=!1}else n=Pe(t,i);return Q(n,(function(t,i){a&&function(e,t){return 2===Z(e)?e.get(t):e[t]}(a.t,t)===i||te(n,t,e(i))})),3===i?new Set(n):n}(e)}function Pe(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return re(e)}var ke,Ee,Ae="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),je="undefined"!=typeof Map,Ce="undefined"!=typeof Set,_e="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,Fe=Ae?Symbol.for("immer-nothing"):((ke={})["immer-nothing"]=!0,ke),Oe=Ae?Symbol.for("immer-draftable"):"__$immer_draftable",De=Ae?Symbol.for("immer-state"):"__$immer_state",Ne=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),Le="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,Ge=Object.getOwnPropertyDescriptors||function(e){var t={};return Le(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},Re={},Be={get:function(e,t){if(t===De)return e;var n=ie(e);if(!ee(n,t))return function(e,t,n){var a,i=Se(t,n);return i?"value"in i?i.value:null===(a=i.get)||void 0===a?void 0:a.call(e.k):void 0}(e,n,t);var a=n[t];return e.I||!J(a)?a:a===we(e.t,t)?(Me(e),e.o[t]=Ie(e.A.h,a,e)):a},has:function(e,t){return t in ie(e)},ownKeys:function(e){return Reflect.ownKeys(ie(e))},set:function(e,t,n){var a=Se(ie(e),t);if(null==a?void 0:a.set)return a.set.call(e.k,n),!0;if(!e.P){var i=we(ie(e),t),r=null==i?void 0:i[De];if(r&&r.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(n,i)&&(void 0!==n||ee(e.t,t)))return!0;Me(e),xe(e)}return e.o[t]===n&&"number"!=typeof n&&(void 0!==n||t in e.o)||(e.o[t]=n,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==we(e.t,t)||t in e.t?(e.D[t]=!1,Me(e),xe(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=ie(e),a=Reflect.getOwnPropertyDescriptor(n,t);return a?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:a.enumerable,value:n[t]}:a},defineProperty:function(){X(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){X(12)}},Ue={};Q(Be,(function(e,t){Ue[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),Ue.deleteProperty=function(e,t){return Ue.set.call(this,e,t,void 0)},Ue.set=function(e,t,n){return Be.set.call(this,e[0],t,n,e[0])};var $e=function(){function e(e){var t=this;this.g=_e,this.F=!0,this.produce=function(e,n,a){if("function"==typeof e&&"function"!=typeof n){var i=n;n=e;var r=t;return function(e){var t=this;void 0===e&&(e=i);for(var a=arguments.length,o=Array(a>1?a-1:0),s=1;s<a;s++)o[s-1]=arguments[s];return r.produce(e,(function(e){var a;return(a=n).call.apply(a,[t,e].concat(o))}))}}var o;if("function"!=typeof n&&X(6),void 0!==a&&"function"!=typeof a&&X(7),J(e)){var s=pe(t),l=Ie(t,e,void 0),u=!0;try{o=n(l),u=!1}finally{u?he(s):fe(s)}return"undefined"!=typeof Promise&&o instanceof Promise?o.then((function(e){return ce(s,a),me(e,s)}),(function(e){throw he(s),e})):(ce(s,a),me(o,s))}if(!e||"object"!=typeof e){if(void 0===(o=n(e))&&(o=e),o===Fe&&(o=void 0),t.F&&oe(o,!0),a){var d=[],c=[];ue("Patches").M(e,o,d,c),a(d,c)}return o}X(21,e)},this.produceWithPatches=function(e,n){if("function"==typeof e)return function(n){for(var a=arguments.length,i=Array(a>1?a-1:0),r=1;r<a;r++)i[r-1]=arguments[r];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(i))}))};var a,i,r=t.produce(e,n,(function(e,t){a=e,i=t}));return"undefined"!=typeof Promise&&r instanceof Promise?r.then((function(e){return[e,a,i]})):[r,a,i]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){J(e)||X(8),Y(e)&&(e=Te(e));var t=pe(this),n=Ie(this,e,void 0);return n[De].C=!0,fe(t),n},t.finishDraft=function(e,t){var n=(e&&e[De]).A;return ce(n,t),me(void 0,n)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!_e&&X(20),this.g=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var a=t[n];if(0===a.path.length&&"replace"===a.op){e=a.value;break}}n>-1&&(t=t.slice(n+1));var i=ue("Patches").$;return Y(e)?i(e,t):this.produce(e,(function(e){return i(e,t)}))},e}(),Ve=new $e,Ke=Ve.produce,qe=(Ve.produceWithPatches.bind(Ve),Ve.setAutoFreeze.bind(Ve),Ve.setUseProxies.bind(Ve),Ve.applyPatches.bind(Ve),Ve.createDraft.bind(Ve),Ve.finishDraft.bind(Ve),Ke);let We;async function ze(e,t){const n=e=>window.globalState.get(e,null==t?void 0:t.tabId),a=e=>{t&&!n({hideIndicator:!0}).hideIndicator&&F({type:"SHOW_INDICATOR",opts:e,requiresFocus:null==t.frameId},t.tabId,t.frameId)};let i,r=e=>{i&&_(e,i.key,i.tabInfo.tabId,i.tabInfo.frameId)};for(let l of e){let e,u=v[l.command];var o;if(u.requiresMedia||u.requiresVideo)if(i&&u.requiresVideo&&!i.isVideo&&(i=void 0),i||(i=null!==(o=window.globalMedia.getAuto(t,u.requiresVideo))&&void 0!==o?o:null),!i)continue;const d=()=>{var t,n;if(e)return e.value;const a=(null!==(t=l.cycleIncrement)&&void 0!==t?t:0)+1;if(!((null===(n=l.valueCycle)||void 0===n?void 0:n.length)>0))throw Error("No items in cycle");return e={value:l.valueCycle[a%l.valueCycle.length],nextIncrement:a},e.value},c=e=>{null!=(null==t?void 0:t.tabId)&&(null==e?void 0:e.toFixed(6))!==u.valueDefault.toFixed(6)&&window.captureMgr.captureTab(t.tabId).catch((e=>{}))},h={};try{if(He[l.command]({autoCapture:c,getCycleValue:d,fetch:n,override:h,kb:l,commandInfo:u,tabInfo:t,media:i,applyToMedia:r,show:l.hideIndicator?()=>{}:a}),e){var s;const t=window.globalState.get({keybinds:!0}).keybinds||[];h.keybinds=qe(null!==(s=h.keybinds)&&void 0!==s?s:t,(t=>{t.find((e=>e.id===l.id)).cycleIncrement=e.nextIncrement}))}Object.keys(h).length&&window.globalState.set({override:h,tabId:null==t?void 0:t.tabId},!0)}catch(e){break}}window.globalState.unfreeze()}const He={nothing:async e=>{},runCode:async e=>{const{kb:t,tabInfo:n}=e;n&&F({type:"INJECT_SCRIPT",requiresFocus:null==n.frameId,code:t.valueString},n.tabId,n.frameId)},openUrl:async e=>{const{kb:t}=e;var n;chrome.tabs.create?chrome.tabs.create({url:t.valueString}):chrome.runtime.sendMessage&&(n=t.valueString,new Promise(((e,t)=>{chrome.runtime.sendMessage({type:"REQUEST_CREATE_TAB",url:n},(t=>{e(t)}))})))},setState:async e=>{const{kb:t,show:n,override:a,fetch:i}=e,r=i({enabled:!0});a.enabledLatestViaPopup=!1,"off"===t.valueState||"toggle"===t.valueState&&r.enabled?a.enabled=!1:a.enabled=!0,n({text:` ${window.gsm.token[a.enabled?"on":"off"]}`,icons:["power"]})},setPin:async e=>{const{kb:t,tabInfo:n,override:a,show:i,fetch:r}=e;if(!n)return;const o=r({speed:!0,isPinned:!0});let s=o.speed;"off"===t.valueState||"toggle"===t.valueState&&o.isPinned?(a.isPinned=!1,o.isPinned&&(s=window.globalState.state.common.speed)):a.isPinned=!0,i({text:a.isPinned?"local":"global",small:!0})},adjustSpeed:async e=>{const{kb:t,show:n,fetch:a,override:i,commandInfo:r,getCycleValue:o}=e,s=a({speed:!0,isPinned:!0,keybinds:!0,lastSpeed:!0});let u;if(t.adjustMode===l.CYCLE)u=o();else if(t.adjustMode===l.SET){var d;u=null!==(d=t.valueNumber)&&void 0!==d?d:r.valueDefault}else if(t.adjustMode===l.ADD){var f,p;u=(null!==(f=s.speed)&&void 0!==f?f:1)+(null!==(p=t.valueNumberAlt)&&void 0!==p?p:r.valueStep)}if(null==u||isNaN(u))throw Error("Value not NULL or NaN.");var v;u=c(r.valueMin,r.valueMax,h(u,3)),t.adjustMode===l.SET&&u===s.speed&&null!=s.lastSpeed?i.speed=s.lastSpeed:i.speed=u,i.lastSpeed=s.speed,n({text:(v=i.speed,v.toFixed(2))})},speedChangesPitch:async e=>{const{kb:t,show:n,override:a,fetch:i}=e,r=i({freePitch:!0});"off"===t.valueState||"toggle"===t.valueState&&r.freePitch?a.freePitch=!1:a.freePitch=!0,n({text:` ${window.gsm.token[a.freePitch?"on":"off"]}`,icons:["speedChangesPitch"]})},seek:async e=>{var t;const{kb:n,media:a,applyToMedia:i,show:r,fetch:o}=e;if(n.valueBool4){var s;const e=null!==(s=n.valueNumberAlt)&&void 0!==s?s:50;return r({text:`${null==e?void 0:e.toFixed(0)}%`}),void i({type:"SEEK",percent:!0,value:e/100,fast:n.valueBool2,autoPause:n.valueBool3})}const{showNetSeek:l}=o({showNetSeek:!0}),u=null!==(t=o({speed:!0}).speed)&&void 0!==t?t:1,d=n.valueBool?n.valueNumber*u:n.valueNumber;let c=` ${Math.abs(h(d,2))}`;if(l&&Math.abs(d)>=1){const e=(new Date).getTime();let t=0;We&&We.key===a.key&&We.time+1e3>e&&(t=We.net),t+=d,We={key:a.key,time:e,net:t},c=` ${t<0?"-":""}${function(e){const t=e/60,n=t/60;return n>=100?"":n>1?`${Math.floor(n)}:${Math.floor(t%60).toString().padStart(2,"0")}:${Math.floor(e%60).toString().padStart(2,"0")}`:`${Math.floor(t).toString().padStart(1,"0")}:${Math.floor(e%60).toString().padStart(2,"0")}`}(Math.abs(t))}`}n.valueNumber>=0?r({icons:["forward"],text:c}):r({icons:["backward"],text:c}),i({type:"SEEK",value:d,relative:!0,fast:n.valueBool2,autoPause:n.valueBool3})},setPause:async e=>{const{kb:t,media:n,applyToMedia:a,show:i}=e;"off"===t.valueState||"toggle"===t.valueState&&n.paused?i({icons:["play"]}):i({icons:["pause"]}),a({type:"PAUSE",state:t.valueState})},setMute:async e=>{const{kb:t,media:n,applyToMedia:a,show:i}=e;"off"===t.valueState||"toggle"===t.valueState&&n.muted?i({text:`${Math.round(100*n.volume)}%`}):i({text:"0%"}),a({type:"MUTE",state:t.valueState})},adjustVolume:async e=>{var t;const{kb:n,media:a,applyToMedia:i,show:r,commandInfo:o}=e,s=null!==(t=n.valueNumber)&&void 0!==t?t:o.valueDefault;r({text:`${(100*c(0,1,a.volume+s)).toFixed(Math.abs(s)>=.01?0:1)}%`}),i({type:"SET_VOLUME",value:s,relative:!0})},setMark:async e=>{var t;const{kb:n,applyToMedia:a,show:i}=e;let r=` ${n.valueString}`,o=["bookmark"];switch(null===(t=n.valueString)||void 0===t?void 0:t.toLowerCase()){case"::nameless":r=" nameless";break;case"::nameless-prev":r=" prev",o=["arrowLeft"];break;case"::nameless-next":r=" next",o=["arrowRight"]}i({icons:o,text:r,small:!0}),a({type:"SET_MARK",key:n.valueString})},seekMark:async e=>{const{media:t,kb:n,applyToMedia:a,show:i}=e;i({icons:t.marks.includes(n.valueString)?["arrowRight"]:["bookmark"],text:` ${n.valueString}`,small:!0}),a({type:"SEEK_MARK",key:n.valueString,fast:n.valueBool2})},toggleLoop:async e=>{const{media:t,kb:n,applyToMedia:a,show:i}=e;if(t.marks.includes(n.valueString))return i({icons:["loop"],text:" "+(t.inLoop?"off":"on"),small:!0}),void a({type:"TOGGLE_LOOP",key:n.valueString});i({icons:["loop"],text:` ${n.valueString}???`,small:!0})},fullscreen:async e=>{const{kb:t,applyToMedia:n}=e;n({type:"FULLSCREEN",direct:t.valueBool})},PiP:async e=>{const{kb:t,applyToMedia:n}=e;n({type:"PIP",state:t.valueState})},setFx:async e=>{const{kb:t,fetch:n,override:a,show:i}=e;let r=n({elementFx:!0,backdropFx:!0});const o=C(t.filterTarget);if(o.element){const e="on"===t.valueState||"toggle"===t.valueState&&!r.elementFx.enabled;a.elementFx={...r.elementFx,enabled:e}}if(o.backdrop){const e="on"===t.valueState||"toggle"===t.valueState&&!r.backdropFx.enabled;a.backdropFx={...r.backdropFx,enabled:e}}i({icons:["fx","power"]})},resetFx:async e=>{const{kb:t,show:n,override:a}=e,i=C(t.filterTarget);i.element&&(a.elementFx=y()),i.backdrop&&(a.backdropFx=y()),n({icons:["fx","reset"]})},flipFx:async e=>{const{fetch:t,show:n,override:a}=e,i=t({backdropFx:!0,elementFx:!0});a.elementFx=i.backdropFx,a.backdropFx=i.elementFx,n({icons:["swap"]})},adjustFilter:async t=>{const{kb:n,show:a,fetch:i,override:r,getCycleValue:o}=t,{element:s,backdrop:u}=C(n.filterTarget),d=e[n.filterOption];if(!d)throw Error("No filter type provided.");let h;var f;if(n.adjustMode===l.CYCLE)h={relative:!1,value:null!==(f=o())&&void 0!==f?f:d.default};else if(n.adjustMode===l.SET){var p;h={relative:!1,value:null!==(p=n.valueNumber)&&void 0!==p?p:d.default}}else if(n.adjustMode===l.ADD){var v;h={relative:!0,value:null!==(v=n.valueNumberAlt)&&void 0!==v?v:d.step}}const m=new Set;Object.assign(r,qe(i({elementFx:!0,backdropFx:!0}),(e=>{if(s){e.elementFx.enabled=!0;const t=e.elementFx[d.isTransform?"transforms":"filters"].find((e=>e.name===n.filterOption));t.value=c(d.min,d.max,h.relative?t.value+h.value:h.value),m.add(t.value)}if(u){e.backdropFx.enabled=!0;const t=e.backdropFx[d.isTransform?"transforms":"filters"].find((e=>e.name===n.filterOption));t.value=c(d.min,d.max,h.relative?t.value+h.value:h.value),m.add(t.value)}}))),a({text:Array.from(m).map((e=>e.toFixed(2))).join("\n")})},adjustPitch:async e=>{Xe(e,"pitch",(e=>`${e.toFixed(1)}`))},adjustGain:async e=>{Xe(e,"volume",(e=>`${(100*e).toFixed(0)}%`))},adjustDelay:async e=>{Xe(e,"delay",(e=>`${e.toFixed(2)}`))},tabCapture:async e=>{const{kb:t,show:n,tabInfo:a}=e;if(!a)return;let i="off";try{"off"===t.valueState?window.captureMgr.releaseTab(a.tabId):"on"===t.valueState?(await window.captureMgr.captureTab(a.tabId),i="on"):(await window.captureMgr.handleToggleTab(a.tabId),window.captureMgr.infos.find((e=>e.tabId===a.tabId))&&(i="on"))}catch(e){return}n({text:i})}};function Xe(e,t,n){const{kb:a,fetch:i,show:r,override:o,getCycleValue:s,commandInfo:u}=e;let d,h,{audioFx:f,audioFxAlt:p}=i({audioFx:!0,audioFxAlt:!0});if(f=f||w(),a.adjustMode===l.CYCLE)d=s(),h=d;else if(a.adjustMode===l.SET){var v;d=null!==(v=a.valueNumber)&&void 0!==v?v:u.valueDefault,h=d}else if(a.adjustMode===l.ADD){var m,b;d=f[t]+(null!==(m=a.valueNumberAlt)&&void 0!==m?m:u.valueStep),h=(p||f)[t]+(null!==(b=a.valueNumberAlt)&&void 0!==b?b:u.valueStep)}let g=new Set;if(null==d||isNaN(d))throw Error("Value not NULL or NaN.");d=c(u.valueMin,u.valueMax,d),o.audioFx={...f,[t]:d},g.add(n(d)),e.autoCapture(o.audioFx[t]),p&&!isNaN(h)&&null!=h&&(h=c(u.valueMin,u.valueMax,h),o.audioFxAlt={...p,[t]:h},g.add(n(h)),e.autoCapture(o.audioFxAlt[t])),r({text:Array.from(g).join(", ")})}class Ye{constructor(){M(this,"scopes",[]),M(this,"watchPorts",new Set),M(this,"canopyPorts",new Set),M(this,"latestPin",void 0),M(this,"pushVolume",void 0),M(this,"handleMessage",((e,t,n)=>{if("MEDIA_SET_PIN"===e.type)this.latestPin=e.value,this.sendUpdate(),n(!0);else if("MEDIA_PUSH_SCOPE"===e.type){const a=e.value;if(a.tabInfo=A(t),!a.tabInfo)return n(!0);a.pushTime=(new Date).getTime();const i=this.scopes.findIndex((e=>E(e.tabInfo,a.tabInfo)));-1===i?this.scopes.push(a):this.scopes.splice(i,1,a),this.sendUpdate(),n(!0)}else"MEDIA_PUSH_SOUND"===e.type&&(this.pushVolume=isNaN(e.volume)?.5:e.volume)})),M(this,"sendUpdate",(()=>{if(this.watchPorts.size){var e;const t={scopes:this.scopes,pinned:null===(e=this.latestPin)||void 0===e?void 0:e.key};this.watchPorts.forEach((e=>{e.postMessage(t)}))}})),M(this,"getAuto",((e,t)=>{var n,a;const i=window.globalState.get({ignorePiP:!0}).ignorePiP;let r=function(e){const t=[];return null==e||e.forEach((e=>{var n;null===(n=e.media)||void 0===n||n.forEach((n=>{t.push({...n,...e})}))})),t}(this.scopes).filter((e=>e.readyState));r=t?r.filter((e=>e.videoSize)):r;const o=r.find((e=>{var t;return e.key===(null===(t=this.latestPin)||void 0===t?void 0:t.key)}));if(o)return o;r.sort(((e,t)=>t.pushTime-e.pushTime));const s=r.find((e=>e.pipMode));if(!i&&s)return s;if(!e)return s||void 0;if(r=r.filter((t=>t.tabInfo.tabId===e.tabId)),!r.length)return s||void 0;let l,u=null===(n=r.filter((e=>null!=e.intersectionRatio)).sort(((e,t)=>t.intersectionRatio-e.intersectionRatio))[0])||void 0===n?void 0:n.intersectionRatio;return r.forEach((t=>{let n=0;E(t.tabInfo,e)&&0!==e.frameId&&(n+=32),t.intersectionRatio>.05&&t.intersectionRatio===u&&(n+=16),(t.infinity||t.duration>=1800)&&(n+=8),t.duration>=600&&(n+=4),t.duration>=180&&(n+=2),t.duration>=60&&(n+=1),t.isVideo&&"www.spotify.com"!==location.hostname&&!t.isConnected&&(n=-1),(!l||n>l.score||n===l.score&&(t.infinity?60:t.duration)>l.info.duration)&&(l={info:t,score:n})})),null===(a=l)||void 0===a?void 0:a.info})),chrome.runtime.onMessage.addListener(this.handleMessage),chrome.runtime.onConnect.addListener((e=>{"MEDIA_WATCH"===e.name?(this.watchPorts.add(e),this.sendUpdate(),e.onDisconnect.addListener((()=>{this.watchPorts.delete(e)}))):"MEDIA_CANOPY"===e.name&&(this.canopyPorts.add(e),e.onDisconnect.addListener((()=>{this.canopyPorts.delete(e),this.scopes=this.scopes.filter((t=>!E(t.tabInfo,A(e.sender)))),this.sendUpdate()})))}))}}class Je{constructor(){M(this,"appliedRules",new Map),M(this,"client",B({rules:!0,superDisable:!0},null,!0,(e=>{this.syncListeners(e)}))),M(this,"addedCommit",!1),M(this,"addedHistory",!1),M(this,"syncListeners",(e=>{const t=e.superDisable?[]:(e.rules||[]).filter((e=>e.enabled));let n=!1,a=!1;t.length&&(n=!0,t.some((e=>!e.initialLoadOnly))&&(a=!0)),n?chrome.webNavigation.onCommitted.addListener(this.handleCommit,{url:[{schemes:["http","https"]}]}):chrome.webNavigation.onCommitted.removeListener(this.handleCommit),a?chrome.webNavigation.onHistoryStateUpdated.addListener(this.handleHistoryUpdate,{url:[{schemes:["http","https"]}]}):chrome.webNavigation.onHistoryStateUpdated.removeListener(this.handleHistoryUpdate)})),M(this,"hasAppliedRule",((e,t)=>{var n;return!(null===(n=this.appliedRules.get(e))||void 0===n||!n.has(t))})),M(this,"setAppliedRule",((e,t)=>{var n;const a=null!==(n=this.appliedRules.get(e))&&void 0!==n?n:new Set;a.add(t),this.appliedRules.set(e,a)})),M(this,"handleCommit",(e=>{this.handleNavigation(e,!0)})),M(this,"handleHistoryUpdate",(e=>{this.handleNavigation(e,!1)})),M(this,"handleNavigation",((e,t)=>{var n,a;if(e.frameId||null==e.tabId)return;const i=[];null===(n=this.client.view)||void 0===n||null===(a=n.rules)||void 0===a||a.forEach((n=>{var a;if(n.enabled&&(!n.initialLoadOnly||t)&&(n.strict||!this.hasAppliedRule(n.id,e.tabId))&&O(e.url,n.condition,!1))if(this.setAppliedRule(n.id,e.tabId),"STATE"!==n.type)if("SPEED"!==n.type)if("FX"!==n.type)"JS"!==n.type||setTimeout((()=>{n.overrideJs&&chrome.tabs.sendMessage(e.tabId,{type:"RUN_JS",value:n.overrideJs},{frameId:e.frameId})}),p()&&t?500:100);else{var r;let e=null!==(r=n.overrideFx)&&void 0!==r?r:{elementFx:y(),backdropFx:y()};i.push({...e,isPinned:!0})}else i.push({speed:null!==(a=n.overrideSpeed)&&void 0!==a?a:1,isPinned:!0});else i.push({enabled:n.overrideEnabled,isPinned:!0})})),i.length&&window.globalState.set(i.map((t=>({override:t,tabId:e.tabId}))))}))}}const Qe=.05,Ze=.1;class et{constructor(e){this.ctx=e,M(this,"input",void 0),M(this,"output",void 0),M(this,"mod1Gain",void 0),M(this,"mod2Gain",void 0),M(this,"mod3Gain",void 0),M(this,"mod4Gain",void 0),M(this,"modGain1",void 0),M(this,"modGain2",void 0),M(this,"mod1",void 0),M(this,"mod2",void 0),M(this,"mod3",void 0),M(this,"mod4",void 0),M(this,"fade1",void 0),M(this,"fade2",void 0),M(this,"release",(()=>{this.fade1.stop(),this.fade1.stop(),this.mod1.stop(),this.mod2.stop(),this.mod3.stop(),this.mod4.stop(),this.input.disconnect(),this.output.disconnect(),et.releaseCached()})),M(this,"setDelay",(e=>{this.modGain1.gain.setTargetAtTime(.5*e,this.ctx.currentTime,.01),this.modGain2.gain.setTargetAtTime(.5*e,this.ctx.currentTime,.01)})),M(this,"setPitchOffset",(e=>{var t;t=e,(e=Math.pow(2,1+1/12*t)-2)>0?(this.mod1Gain.gain.value=0,this.mod2Gain.gain.value=0,this.mod3Gain.gain.value=1,this.mod4Gain.gain.value=1):(this.mod1Gain.gain.value=1,this.mod2Gain.gain.value=1,this.mod3Gain.gain.value=0,this.mod4Gain.gain.value=0),this.setDelay(.1*Math.abs(e))}));const t=et.getCache(e);this.input=e.createGain(),this.output=e.createGain(),this.mod1=e.createBufferSource(),this.mod2=e.createBufferSource(),this.mod3=e.createBufferSource(),this.mod4=e.createBufferSource(),this.mod1.buffer=t.down,this.mod2.buffer=t.down,this.mod3.buffer=t.up,this.mod4.buffer=t.up,this.mod1.loop=!0,this.mod2.loop=!0,this.mod3.loop=!0,this.mod4.loop=!0,this.mod1Gain=e.createGain(),this.mod2Gain=e.createGain(),this.mod3Gain=e.createGain(),this.mod3Gain.gain.value=0,this.mod4Gain=e.createGain(),this.mod4Gain.gain.value=0,this.mod1.connect(this.mod1Gain),this.mod2.connect(this.mod2Gain),this.mod3.connect(this.mod3Gain),this.mod4.connect(this.mod4Gain),this.modGain1=e.createGain(),this.modGain2=e.createGain();const n=e.createDelay(5),a=e.createDelay(5);this.mod1Gain.connect(this.modGain1),this.mod2Gain.connect(this.modGain2),this.mod3Gain.connect(this.modGain1),this.mod4Gain.connect(this.modGain2),this.modGain1.connect(n.delayTime),this.modGain2.connect(a.delayTime),this.fade1=e.createBufferSource(),this.fade2=e.createBufferSource();var i=t.fade;this.fade1.buffer=i,this.fade2.buffer=i,this.fade1.loop=!0,this.fade2.loop=!0;const r=e.createGain(),o=e.createGain();r.gain.value=0,o.gain.value=0,this.fade1.connect(r.gain),this.fade2.connect(o.gain),this.input.connect(n),this.input.connect(a),n.connect(r),a.connect(o),r.connect(this.output),o.connect(this.output);var s=e.currentTime+.05,l=s+Ze-Qe;this.mod1.start(s),this.mod2.start(l),this.mod3.start(s),this.mod4.start(l),this.fade1.start(s),this.fade2.start(l),this.setDelay(.1)}static getCache(e){return et.cached||(et.cached={down:nt(e,!1),up:nt(e,!0),fade:tt(e),references:0}),et.cached.references++,et.cached}static releaseCached(){et.cached&&(et.cached.references--,et.cached.references<=0&&delete et.cached)}}function tt(e){for(var t=Ze*e.sampleRate,n=t+(Ze-2*Qe)*e.sampleRate,a=e.createBuffer(1,n,e.sampleRate),i=a.getChannelData(0),r=Qe*e.sampleRate,o=r,s=t-r,l=0;l<t;++l){var u;u=l<o?Math.sqrt(l/r):l>=s?Math.sqrt(1-(l-s)/r):1,i[l]=u}for(l=t;l<n;++l)i[l]=0;return a}function nt(e,t){for(var n=Ze*e.sampleRate,a=n+(Ze-2*Qe)*e.sampleRate,i=e.createBuffer(1,a,e.sampleRate),r=i.getChannelData(0),o=0;o<n;++o)r[o]=t?(n-o)/a:o/n;for(o=n;o<a;++o)r[o]=0;return i}M(et,"cached",void 0);class at extends AudioWorkletNode{constructor(e){super(e,"sound-touch-processor",{channelCount:2,channelCountMode:"clamped-max"}),this.ctx=e,M(this,"release",(()=>{this.port.postMessage({type:"RELEASE"})})),M(this,"update",(e=>{this.parameters.get("semitone").value=e})),44100!==this.ctx.sampleRate&&console.warn("Audio context sample rate should be 44100.")}}M(at,"triedAddModule",!1),M(at,"addedModule",!1),M(at,"addModule",(async e=>{at.triedAddModule=!0,await e.audioWorklet.addModule("sound-touch-processor.js"),at.addedModule=!0}));class it extends AudioWorkletNode{constructor(e){super(e,"reverse-sound-processor",{channelCount:1,channelCountMode:"explicit",processorOptions:{maxSize:(arguments.length>1&&void 0!==arguments[1]?arguments[1]:300)*e.sampleRate}}),this.ctx=e,M(this,"endedCb",void 0),M(this,"playingCb",void 0),M(this,"ended",!1),M(this,"forceEnd",(()=>{this.port.postMessage({type:"RELEASE"})})),this.port.onmessage=e=>{let{data:t}=e;var n;if("RELEASED"===t.type)this.ended=!0,null===(n=this.endedCb)||void 0===n||n.call(this);else if("PLAYING"===t.type){var a;null===(a=this.playingCb)||void 0===a||a.call(this)}}}}M(it,"triedAddModule",!1),M(it,"addedModule",!1),M(it,"addModule",(async e=>{it.triedAddModule=!0,await e.audioWorklet.addModule("reverse-sound-processor.js"),it.addedModule=!0}));class rt{constructor(){M(this,"audioCtx",void 0),M(this,"infos",[]),M(this,"initReverse",(async(e,t)=>{var n;let a=this.infos.find((t=>t.tabId===e));if(null!==(n=a)&&void 0!==n&&n.reverse)return;if(!a)try{await this.captureTab(e)}catch(e){t.disconnect()}if(a=this.infos.find((t=>t.tabId===e)),a||t.disconnect(),!it.triedAddModule)try{await it.addModule(this.audioCtx)}catch(e){t.disconnect()}let i=[];const r=new it(this.audioCtx);r.playingCb=()=>{for(let t of window.globalMedia.scopes)if(t.tabInfo.tabId===e)for(let n of t.media)!n.paused&&n.volume&&(_({type:"PAUSE",state:"on"},n.key,e,t.tabInfo.frameId),i.push((()=>{_({type:"PAUSE",state:"off"},n.key,e,t.tabInfo.frameId)})));t.postMessage({type:"PLAYING"})},r.endedCb=()=>{t.disconnect(),o()},t.onMessage.addListener((e=>{"PLAY"===e.type&&a.outputNode.disconnect(r)}));const o=()=>{if(a.reverse){delete a.reverse,a.outputNode.connect(this.audioCtx.destination),r.disconnect();try{a.outputNode.disconnect(r)}catch(e){}r.ended||r.forceEnd(),i.forEach((e=>{e()}))}};a.reverse=o,t.onDisconnect.addListener(o),a.outputNode.disconnect(this.audioCtx.destination),a.outputNode.connect(r),r.connect(this.audioCtx.destination)})),M(this,"handleMessage",((e,t,n)=>{if("TAB_CAPTURE"===e.type){if(null==e.tabId)return n(!0);e.on?this.captureTab(e.tabId):!1===e.on?this.releaseTab(e.tabId):this.handleToggleTab(e.tabId),n(!0)}else"REQUEST_CAPTURE_STATUS"===e.type&&(chrome.runtime.sendMessage({type:"CAPTURE_STATUS",tabId:e.tabId,value:this.infos.some((t=>t.tabId===e.tabId))}),n(!0))})),M(this,"handleToggleTab",(e=>this.infos.find((t=>t.tabId===e))?(this.releaseTab(e),Promise.resolve(!0)):this.captureTab(e))),M(this,"captureTab",(async e=>{if(this.infos.find((t=>t.tabId===e)))return;let t;try{t=await new Promise(((e,t)=>{chrome.tabCapture.capture({audio:!0},(n=>{if(chrome.runtime.lastError)return t(chrome.runtime.lastError);e(n)}))}))}catch(e){return}this.audioCtx=this.audioCtx||new AudioContext({sampleRate:44100,latencyHint:0});const n=this.audioCtx.createGain();n.connect(this.audioCtx.destination);let a={tabId:e,stream:t,streamSrc:this.audioCtx.createMediaStreamSource(t),outputNode:n};this.infos.push(a),a.client=B({superDisable:!0,enabled:!0,audioFx:!0,audioFxAlt:!0,monoOutput:!0,audioPan:!0},e,!0,(e=>{this.handleChange(a,e.enabled,e.audioFx,e.audioFxAlt,e.monoOutput,e.audioPan),e.superDisable&&this.releaseTab(a.tabId)})),a.streamSrc.connect(n),chrome.runtime.sendMessage({type:"CAPTURE_STATUS",tabId:e,value:!0}),t.addEventListener("inactive",(t=>{this.releaseTab(e)}))})),M(this,"releaseTab",(e=>{var t,n,a,i;const r=this.infos.findIndex((t=>t.tabId===e));if(r<0)return;const o=this.infos[r];null===(t=o.reverse)||void 0===t||t.call(o),o.client.release(),o.stream.getAudioTracks().forEach((e=>{e.stop()})),delete o.stream,null===(n=o.client)||void 0===n||n.release(),this.infos.splice(r,1),null===(a=o.fx)||void 0===a||a.release(),delete o.fx,null===(i=o.outputNode)||void 0===i||i.disconnect(),delete o.outputNode,o.streamSrc.disconnect(),delete o.streamSrc,chrome.runtime.sendMessage({type:"CAPTURE_STATUS",tabId:e,value:!1})})),M(this,"handleChange",((e,t,n,a,i,r)=>{const{streamSrc:o}=e;o.disconnect(),e.fx=e.fx||new ot(this.audioCtx),e.fx.updateFx(t,n,a,i,r),o.connect(e.fx.input),e.fx.output.connect(e.outputNode)})),chrome.runtime.onMessage.addListener(this.handleMessage),chrome.runtime.onConnect.addListener((e=>{if(e.name.startsWith("REVERSE")){const t=JSON.parse(e.name.slice(8));if(null==(null==t?void 0:t.tabId))return;this.initReverse(t.tabId,e)}}))}}class ot{constructor(e){this.ctx=e,M(this,"input",void 0),M(this,"output",void 0),M(this,"main",void 0),M(this,"alt",void 0),M(this,"splitter",void 0),M(this,"merger",void 0),M(this,"pan",void 0),M(this,"release",(()=>{var e,t;this.estrange(),null===(e=this.main)||void 0===e||e.release(),null===(t=this.alt)||void 0===t||t.release()})),M(this,"updateFx",(async(e,t,n,a,i)=>{let r=this.input;var o,s;this.estrange(),this.main=this.main||new st(this.ctx),this.main.updateFx(e,t,!!n),e&&n?(r.channelCount=2,r.channelCountMode="explicit",this.splitter=this.splitter||this.ctx.createChannelSplitter(2),r.connect(this.splitter),this.alt=this.alt||new st(this.ctx),this.alt.updateFx(e,n),this.splitter.connect(this.main.input,0),this.splitter.connect(this.alt.input,1),this.merger=this.merger||this.ctx.createChannelMerger(2),this.main.output.connect(this.merger,void 0,0),this.alt.output.connect(this.merger,void 0,1),r=this.merger):(r.channelCountMode="max",null===(o=this.alt)||void 0===o||o.release(),delete this.alt,delete this.splitter,delete this.merger,r.connect(this.main.input),r=this.main.output),e&&i?(this.pan=this.pan||this.ctx.createStereoPanner(),this.pan.pan.value=c(-1,1,i||0),r.connect(this.pan),r=this.pan):(null===(s=this.pan)||void 0===s||s.disconnect(),delete this.pan),r.connect(this.output),r=this.output,e&&a?(r.channelCount=1,r.channelCountMode="clamped-max"):r.channelCountMode="max"})),M(this,"estrange",(()=>{var e,t,n,a,i;this.input.disconnect(),null===(e=this.main)||void 0===e||e.output.disconnect(),null===(t=this.alt)||void 0===t||t.output.disconnect(),null===(n=this.splitter)||void 0===n||n.disconnect(),null===(a=this.merger)||void 0===a||a.disconnect(),null===(i=this.pan)||void 0===i||i.disconnect()})),this.input=e.createGain(),this.output=e.createGain()}}class st{constructor(e){this.ctx=e,M(this,"input",void 0),M(this,"output",void 0),M(this,"filterNodes",void 0),M(this,"jungle",void 0),M(this,"soundTouchNode",void 0),M(this,"delayNode",void 0),M(this,"release",(()=>{var e,t;this.estrange(),null===(e=this.jungle)||void 0===e||e.release(),null===(t=this.soundTouchNode)||void 0===t||t.release(),delete this.jungle})),M(this,"prevUpdateFx",void 0),M(this,"updateFx",(async(e,t,n)=>{var a;this.prevUpdateFx=()=>this.updateFx(e,t),this.estrange();let i=this.input;var r,o;e&&t.jungleMode&&null!==t.pitch&&0!==t.pitch?(this.jungle=null!==(r=this.jungle)&&void 0!==r?r:new et(this.ctx),this.jungle.setPitchOffset(t.pitch),i.connect(this.jungle.input),i=this.jungle.output):(null===(o=this.jungle)||void 0===o||o.release(),delete this.jungle);const s=e&&!t.jungleMode&&null!==t.pitch&&0!==t.pitch;if(!at.triedAddModule&&s)try{await at.addModule(this.ctx)}catch(e){}var l;if(at.addedModule&&s?(this.soundTouchNode||(this.soundTouchNode=new at(this.ctx),this.soundTouchNode.onprocessorerror=e=>{var t;console.error("SoundTouchProcessor error: ",e),null===(t=this.soundTouchNode)||void 0===t||t.release(),delete this.soundTouchNode,at.addedModule=!1,at.triedAddModule=!0,this.prevUpdateFx()}),this.soundTouchNode.update(t.pitch),i.connect(this.soundTouchNode),i=this.soundTouchNode):(null===(l=this.soundTouchNode)||void 0===l||l.release(),delete this.soundTouchNode),e&&null!==(a=t.eq)&&void 0!==a&&a.enabled&&t.eq.values.some((e=>0!==e))){const{eq:e}=t;this.filterNodes=this.filterNodes||[];const n=[],a=()=>{var e;return null!==(e=this.filterNodes.shift())&&void 0!==e?e:this.ctx.createBiquadFilter()},r=e.values.length/10*1.41;t.eq.values.forEach(((t,o)=>{var s;if(0===t)return;t*=null!==(s=e.factor)&&void 0!==s?s:1;const l=h(31.25*2**(o/Math.round(e.values.length/10)),2),u=a();n.push(u),i.connect(u),i=u,u.frequency.value=l,u.gain.value=t,u.Q.value=r,0===o?u.type="lowshelf":o===e.values.length-1?u.type="highshelf":u.type="peaking"})),delete this.filterNodes,this.filterNodes=n}else delete this.filterNodes;let u;var d;e&&t.delay>0?(this.delayNode=null!==(d=this.delayNode)&&void 0!==d?d:this.ctx.createDelay(10),t.delay>this.delayNode.delayTime.maxValue&&(this.delayNode=this.ctx.createDelay(179.99)),this.delayNode.delayTime.value=c(0,this.delayNode.delayTime.maxValue,t.delay),t.delayMerge&&(u=i),i.connect(this.delayNode),i=this.delayNode):delete this.delayNode,i.connect(this.output),u&&u.connect(this.output),e&&null!=t.volume&&1!==t.volume?this.output.gain.value=t.volume*t.volume:this.output.gain.value=1})),M(this,"estrange",(()=>{var e,t,n,a,i;this.input.disconnect(),null===(e=this.delayNode)||void 0===e||e.disconnect(),null===(t=this.filterNodes)||void 0===t||t.forEach((e=>{e.disconnect()})),null===(n=this.jungle)||void 0===n||null===(a=n.output)||void 0===a||a.disconnect(),null===(i=this.soundTouchNode)||void 0===i||i.disconnect()})),this.input=e.createGain(),this.output=e.createGain()}}async function lt(e){if(!window.globalState.get({enabled:!0}).enabled)return;const t=window.globalState.get({keybinds:!0,keybindsUrlCondition:!0});let n=(t.keybinds||[]).filter((t=>t.enabled&&t.global&&(t.globalKey||"commandA")===e));if(!n.length)return;const a=await async function(){let e=await k({active:!0,currentWindow:!0},3,75);if(!e.length)return;const[t]=e;return{tabId:t.id,windowId:t.windowId,url:t.url}}(),i=(null==a?void 0:a.url)||"";t.keybindsUrlCondition&&!O(i,t.keybindsUrlCondition,!0)||(n=n.filter((e=>{var t;return!((null===(t=e.condition)||void 0===t?void 0:t.parts.length)>0)||O(i,e.condition,!0)})),ze(n,a))}function ut(e,t,n){"REQUEST_TAB_INFO"===e.type?n({tabId:t.tab.id,frameId:t.frameId}):"REQUEST_CREATE_TAB"===e.type?(chrome.tabs.create({url:e.url}),n(!0)):"REQUEST_SEND_MSG"===e.type?(chrome.tabs.sendMessage(e.tabId,e.msg,null==e.frameId?{}:{frameId:e.frameId}),n(!0)):"TRIGGER_KEYBINDS"===e.type&&(ze(window.globalState.get({keybinds:!0}).keybinds.filter((t=>e.ids.includes(t.id))),{tabId:t.tab.id,frameId:t.frameId,windowId:t.tab.windowId}),n(!0))}p()||chrome.runtime.onInstalled.addListener((async function e(t){chrome.runtime.onInstalled.removeListener(e);const n=await k({url:["https://*/*","http://*/*"]});n&&n.forEach((e=>{chrome.tabs.executeScript(e.id,{file:"contentScript.js",allFrames:!0},(()=>{chrome.runtime.lastError}))}))})),async function(){let e;window.isBackground=!0,window.portCapture=new q;try{e=S((await("config",new Promise(((e,t)=>{chrome.storage.local.get("config",(n=>{chrome.runtime.lastError?t(chrome.runtime.lastError):e(n)}))})))).config)}catch(e){}e=e||g(),window.globalMedia=new Ye,window.globalState=new L(e),window.badgeMgr=new U,window.ruleManager=new Je,window.gsmMgr=new z(e.language),chrome.tabCapture&&rt&&(window.captureMgr=new rt),chrome.runtime.onMessage.addListener(ut),p()||chrome.commands.onCommand.addListener(lt),chrome.tabs.onCreated.addListener((e=>{if(window.globalState.get({pinByDefault:!0}).pinByDefault){var t,n;let a=e.openerTabId;if(a||(a=window.currentTabId,window.currentTabId===(null==e?void 0:e.id)&&(a=window.previousTabId)),window.globalState.unfreeze(),null!==(t=window.globalState.pins)&&void 0!==t&&t.find((t=>t.tabId===e.id)))return;window.globalState.set([{tabId:e.id,inheritContextFromTabId:null!==(n=a)&&void 0!==n?n:null,override:{isPinned:!0}}])}}))}()}()}();