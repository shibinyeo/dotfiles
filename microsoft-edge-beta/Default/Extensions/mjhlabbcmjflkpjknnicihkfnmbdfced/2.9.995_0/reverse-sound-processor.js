!function(){"use strict";function e(r){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(r)}function r(r,t,s){return(t=function(r){var t=function(r,t){if("object"!==e(r)||null===r)return r;var s=r[Symbol.toPrimitive];if(void 0!==s){var i=s.call(r,"string");if("object"!==e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}(r);return"symbol"===e(t)?t:String(t)}(t))in r?Object.defineProperty(r,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[t]=s,r}class t extends AudioWorkletProcessor{constructor(e){super(),r(this,"buffer",new Float32Array(441e3)),r(this,"recordSize",0),r(this,"playSize",0),r(this,"maxBufferSize",void 0),r(this,"phase",s.pre),r(this,"release",(()=>{this.phase!==s.released&&(this.phase=s.released,this.port.postMessage({type:"RELEASED"}))})),this.maxBufferSize=e.processorOptions.maxSize||2646e3,this.port.onmessage=e=>{let{data:r}=e;"RELEASE"===r.type&&this.release()}}process(e,r,t){if(this.phase===s.released)return!1;const i=e[0],o=r[0],n=o[0].length;if(this.phase===s.pre){if(!i[0])return!0;this.phase=s.recording}if(this.phase===s.recording)if(i[0]){const e=this.recordSize+n;if(e>this.maxBufferSize)this.phase=s.playing,this.buffer.subarray(0,this.recordSize).reverse(),this.port.postMessage({type:"PLAYING"});else{if(e>this.buffer.length){const e=new Float32Array(2*this.buffer.length);e.set(this.buffer),this.buffer=e}this.buffer.set(i[0],this.recordSize),this.recordSize=e}}else this.phase=s.playing,this.buffer.subarray(0,this.recordSize).reverse(),this.port.postMessage({type:"PLAYING"});return this.phase===s.playing?this.playSize<this.recordSize?(o[0].set(this.buffer.subarray(this.playSize,this.playSize+n)),this.playSize+=n,!0):(this.release(),!1):(o[0].set(i[0]),!0)}}var s;!function(e){e[e.pre=1]="pre",e[e.recording=2]="recording",e[e.playing=3]="playing",e[e.released=4]="released"}(s||(s={})),registerProcessor("reverse-sound-processor",t)}();