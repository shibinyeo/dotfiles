!function(){var e={3174:function(e,t,i){"use strict";i.d(t,{$:function(){return n}});const n={}},3465:function(e,t,i){e=i.nmd(e);var n="__lodash_hash_undefined__",r=9007199254740991,s="[object Arguments]",a="[object Boolean]",o="[object Date]",l="[object Function]",d="[object GeneratorFunction]",c="[object Map]",u="[object Number]",h="[object Object]",v="[object Promise]",p="[object RegExp]",m="[object Set]",f="[object String]",g="[object Symbol]",y="[object WeakMap]",w="[object ArrayBuffer]",b="[object DataView]",E="[object Float32Array]",k="[object Float64Array]",M="[object Int8Array]",T="[object Int16Array]",S="[object Int32Array]",C="[object Uint8Array]",I="[object Uint8ClampedArray]",x="[object Uint16Array]",L="[object Uint32Array]",_=/\w*$/,F=/^\[object .+?Constructor\]$/,P=/^(?:0|[1-9]\d*)$/,D={};D[s]=D["[object Array]"]=D[w]=D[b]=D[a]=D[o]=D[E]=D[k]=D[M]=D[T]=D[S]=D[c]=D[u]=D[h]=D[p]=D[m]=D[f]=D[g]=D[C]=D[I]=D[x]=D[L]=!0,D["[object Error]"]=D[l]=D[y]=!1;var A="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g,O="object"==typeof self&&self&&self.Object===Object&&self,R=A||O||Function("return this")(),j=t&&!t.nodeType&&t,N=j&&e&&!e.nodeType&&e,H=N&&N.exports===j;function B(e,t){return e.set(t[0],t[1]),e}function U(e,t){return e.add(t),e}function z(e,t,i,n){var r=-1,s=e?e.length:0;for(n&&s&&(i=e[++r]);++r<s;)i=t(i,e[r],r,e);return i}function V(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function $(e){var t=-1,i=Array(e.size);return e.forEach((function(e,n){i[++t]=[n,e]})),i}function K(e,t){return function(i){return e(t(i))}}function X(e){var t=-1,i=Array(e.size);return e.forEach((function(e){i[++t]=e})),i}var Y,G=Array.prototype,q=Function.prototype,W=Object.prototype,J=R["__core-js_shared__"],Q=(Y=/[^.]+$/.exec(J&&J.keys&&J.keys.IE_PROTO||""))?"Symbol(src)_1."+Y:"",Z=q.toString,ee=W.hasOwnProperty,te=W.toString,ie=RegExp("^"+Z.call(ee).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ne=H?R.Buffer:void 0,re=R.Symbol,se=R.Uint8Array,ae=K(Object.getPrototypeOf,Object),oe=Object.create,le=W.propertyIsEnumerable,de=G.splice,ce=Object.getOwnPropertySymbols,ue=ne?ne.isBuffer:void 0,he=K(Object.keys,Object),ve=Re(R,"DataView"),pe=Re(R,"Map"),me=Re(R,"Promise"),fe=Re(R,"Set"),ge=Re(R,"WeakMap"),ye=Re(Object,"create"),we=Ue(ve),be=Ue(pe),Ee=Ue(me),ke=Ue(fe),Me=Ue(ge),Te=re?re.prototype:void 0,Se=Te?Te.valueOf:void 0;function Ce(e){var t=-1,i=e?e.length:0;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}function Ie(e){var t=-1,i=e?e.length:0;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}function xe(e){var t=-1,i=e?e.length:0;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}function Le(e){this.__data__=new Ie(e)}function _e(e,t,i){var n=e[t];ee.call(e,t)&&ze(n,i)&&(void 0!==i||t in e)||(e[t]=i)}function Fe(e,t){for(var i=e.length;i--;)if(ze(e[i][0],t))return i;return-1}function Pe(e,t,i,n,r,v,y){var F;if(n&&(F=v?n(e,r,v,y):n(e)),void 0!==F)return F;if(!Ye(e))return e;var P=Ve(e);if(P){if(F=function(e){var t=e.length,i=e.constructor(t);return t&&"string"==typeof e[0]&&ee.call(e,"index")&&(i.index=e.index,i.input=e.input),i}(e),!t)return function(e,t){var i=-1,n=e.length;for(t||(t=Array(n));++i<n;)t[i]=e[i];return t}(e,F)}else{var A=Ne(e),O=A==l||A==d;if(Ke(e))return function(e,t){if(t)return e.slice();var i=new e.constructor(e.length);return e.copy(i),i}(e,t);if(A==h||A==s||O&&!v){if(V(e))return v?e:{};if(F=function(e){return"function"!=typeof e.constructor||Be(e)?{}:Ye(t=ae(e))?oe(t):{};var t}(O?{}:e),!t)return function(e,t){return Ae(e,je(e),t)}(e,function(e,t){return e&&Ae(t,Ge(t),e)}(F,e))}else{if(!D[A])return v?e:{};F=function(e,t,i,n){var r,s=e.constructor;switch(t){case w:return De(e);case a:case o:return new s(+e);case b:return function(e,t){var i=t?De(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}(e,n);case E:case k:case M:case T:case S:case C:case I:case x:case L:return function(e,t){var i=t?De(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}(e,n);case c:return function(e,t,i){return z(t?i($(e),!0):$(e),B,new e.constructor)}(e,n,i);case u:case f:return new s(e);case p:return function(e){var t=new e.constructor(e.source,_.exec(e));return t.lastIndex=e.lastIndex,t}(e);case m:return function(e,t,i){return z(t?i(X(e),!0):X(e),U,new e.constructor)}(e,n,i);case g:return r=e,Se?Object(Se.call(r)):{}}}(e,A,Pe,t)}}y||(y=new Le);var R=y.get(e);if(R)return R;if(y.set(e,F),!P)var j=i?function(e){return function(e,t,i){var n=t(e);return Ve(e)?n:function(e,t){for(var i=-1,n=t.length,r=e.length;++i<n;)e[r+i]=t[i];return e}(n,i(e))}(e,Ge,je)}(e):Ge(e);return function(e,t){for(var i=-1,n=e?e.length:0;++i<n&&!1!==t(e[i],i););}(j||e,(function(r,s){j&&(r=e[s=r]),_e(F,s,Pe(r,t,i,n,s,e,y))})),F}function De(e){var t=new e.constructor(e.byteLength);return new se(t).set(new se(e)),t}function Ae(e,t,i,n){i||(i={});for(var r=-1,s=t.length;++r<s;){var a=t[r],o=n?n(i[a],e[a],a,i,e):void 0;_e(i,a,void 0===o?e[a]:o)}return i}function Oe(e,t){var i,n,r=e.__data__;return("string"==(n=typeof(i=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==i:null===i)?r["string"==typeof t?"string":"hash"]:r.map}function Re(e,t){var i=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!Ye(e)||(t=e,Q&&Q in t))&&(Xe(e)||V(e)?ie:F).test(Ue(e));var t}(i)?i:void 0}Ce.prototype.clear=function(){this.__data__=ye?ye(null):{}},Ce.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Ce.prototype.get=function(e){var t=this.__data__;if(ye){var i=t[e];return i===n?void 0:i}return ee.call(t,e)?t[e]:void 0},Ce.prototype.has=function(e){var t=this.__data__;return ye?void 0!==t[e]:ee.call(t,e)},Ce.prototype.set=function(e,t){return this.__data__[e]=ye&&void 0===t?n:t,this},Ie.prototype.clear=function(){this.__data__=[]},Ie.prototype.delete=function(e){var t=this.__data__,i=Fe(t,e);return!(i<0||(i==t.length-1?t.pop():de.call(t,i,1),0))},Ie.prototype.get=function(e){var t=this.__data__,i=Fe(t,e);return i<0?void 0:t[i][1]},Ie.prototype.has=function(e){return Fe(this.__data__,e)>-1},Ie.prototype.set=function(e,t){var i=this.__data__,n=Fe(i,e);return n<0?i.push([e,t]):i[n][1]=t,this},xe.prototype.clear=function(){this.__data__={hash:new Ce,map:new(pe||Ie),string:new Ce}},xe.prototype.delete=function(e){return Oe(this,e).delete(e)},xe.prototype.get=function(e){return Oe(this,e).get(e)},xe.prototype.has=function(e){return Oe(this,e).has(e)},xe.prototype.set=function(e,t){return Oe(this,e).set(e,t),this},Le.prototype.clear=function(){this.__data__=new Ie},Le.prototype.delete=function(e){return this.__data__.delete(e)},Le.prototype.get=function(e){return this.__data__.get(e)},Le.prototype.has=function(e){return this.__data__.has(e)},Le.prototype.set=function(e,t){var i=this.__data__;if(i instanceof Ie){var n=i.__data__;if(!pe||n.length<199)return n.push([e,t]),this;i=this.__data__=new xe(n)}return i.set(e,t),this};var je=ce?K(ce,Object):function(){return[]},Ne=function(e){return te.call(e)};function He(e,t){return!!(t=null==t?r:t)&&("number"==typeof e||P.test(e))&&e>-1&&e%1==0&&e<t}function Be(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||W)}function Ue(e){if(null!=e){try{return Z.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function ze(e,t){return e===t||e!=e&&t!=t}(ve&&Ne(new ve(new ArrayBuffer(1)))!=b||pe&&Ne(new pe)!=c||me&&Ne(me.resolve())!=v||fe&&Ne(new fe)!=m||ge&&Ne(new ge)!=y)&&(Ne=function(e){var t=te.call(e),i=t==h?e.constructor:void 0,n=i?Ue(i):void 0;if(n)switch(n){case we:return b;case be:return c;case Ee:return v;case ke:return m;case Me:return y}return t});var Ve=Array.isArray;function $e(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}(e.length)&&!Xe(e)}var Ke=ue||function(){return!1};function Xe(e){var t=Ye(e)?te.call(e):"";return t==l||t==d}function Ye(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Ge(e){return $e(e)?function(e,t){var i=Ve(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&$e(e)}(e)&&ee.call(e,"callee")&&(!le.call(e,"callee")||te.call(e)==s)}(e)?function(e,t){for(var i=-1,n=Array(e);++i<e;)n[i]=t(i);return n}(e.length,String):[],n=i.length,r=!!n;for(var a in e)!t&&!ee.call(e,a)||r&&("length"==a||He(a,n))||i.push(a);return i}(e):function(e){if(!Be(e))return he(e);var t=[];for(var i in Object(e))ee.call(e,i)&&"constructor"!=i&&t.push(i);return t}(e)}e.exports=function(e){return Pe(e,!0,!0)}},1296:function(e,t,i){var n=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,a=/^0o[0-7]+$/i,o=parseInt,l="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g,d="object"==typeof self&&self&&self.Object===Object&&self,c=l||d||Function("return this")(),u=Object.prototype.toString,h=Math.max,v=Math.min,p=function(){return c.Date.now()};function m(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function f(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==u.call(e)}(e))return NaN;if(m(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=m(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var i=s.test(e);return i||a.test(e)?o(e.slice(2),i?2:8):r.test(e)?NaN:+e}e.exports=function(e,t,i){var n,r,s,a,o,l,d=0,c=!1,u=!1,g=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var i=n,s=r;return n=r=void 0,d=t,a=e.apply(s,i)}function w(e){var i=e-l;return void 0===l||i>=t||i<0||u&&e-d>=s}function b(){var e=p();if(w(e))return E(e);o=setTimeout(b,function(e){var i=t-(e-l);return u?v(i,s-(e-d)):i}(e))}function E(e){return o=void 0,g&&n?y(e):(n=r=void 0,a)}function k(){var e=p(),i=w(e);if(n=arguments,r=this,l=e,i){if(void 0===o)return function(e){return d=e,o=setTimeout(b,t),c?y(e):a}(l);if(u)return o=setTimeout(b,t),y(l)}return void 0===o&&(o=setTimeout(b,t)),a}return t=f(t)||0,m(i)&&(c=!!i.leading,s=(u="maxWait"in i)?h(f(i.maxWait)||0,t):s,g="trailing"in i?!!i.trailing:g),k.cancel=function(){void 0!==o&&clearTimeout(o),d=0,n=l=r=o=void 0},k.flush=function(){return void 0===o?a:E(p())},k}}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={id:n,loaded:!1,exports:{}};return e[n](s,s.exports,i),s.loaded=!0,s.exports}i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,{a:t}),t},i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(t,i,n){return(i=function(t){var i=function(t,i){if("object"!==e(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===e(i)?i:String(i)}(i))in t?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t}var n=i(3174).$;function r(e){if(!e)return;const t=document.createElement("script");t.type="text/javascript",t.text=e,document.documentElement.appendChild(t),t.remove()}function s(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]){const e=document.createElement("script");e.type="text/javascript",e.src=chrome.runtime.getURL("ctx.js"),e.async=!0,document.documentElement.appendChild(e)}else r("!function(){\"use strict\";function t(e){return t=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t},t(e)}function e(e,a,i){return(a=function(e){var a=function(e,a){if(\"object\"!==t(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,\"string\");if(\"object\"!==t(o))return o;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return String(e)}(e);return\"symbol\"===t(a)?a:String(a)}(a))in e?Object.defineProperty(e,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[a]=i,e}const a={dispatchEvent:EventTarget.prototype.dispatchEvent,stopImmediatePropagation:Event.prototype.stopImmediatePropagation,appendChild:Node.prototype.appendChild,map:{clear:Map.prototype.clear,set:Map.prototype.set,has:Map.prototype.has,get:Map.prototype.get},array:{push:Array.prototype.push,includes:Array.prototype.includes},Map:Map,ShadowRoot:ShadowRoot,HTMLMediaElement:HTMLMediaElement,CustomEvent:CustomEvent,JSON:{parse:JSON.parse,stringify:JSON.stringify}};let i;var o;null===(o=document.currentScript)||void 0===o||o.remove();let n,r,c,l,s,p=[],u=[];function d(t,e,a){const i=null==t?void 0:t.prototype[e];if(i){t.prototype[e]=function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];const n=i.apply(this,e);return a(e,this,n),n};try{c.set(t.prototype[e],i)}catch(t){}}}function h(t,e,i){e instanceof a.HTMLMediaElement&&(a.array.includes.call(p,e)||(a.array.push.call(p,e),n.wiggleOn(e)))}function y(t,e,i){i instanceof a.ShadowRoot&&(a.array.includes.call(u,i)||(a.array.push.call(u,i),n.wiggleOn(i)))}class m{constructor(){if(e(this,\"originalFn\",Function.prototype.toString),e(this,\"outputMap\",new Map),e(this,\"set\",((t,e)=>{try{const i=this.originalFn.call(e);i&&a.map.set.call(this.outputMap,t,i)}catch(t){}})),location.hostname.includes(\"twitch\"))return;let t=this;Function.prototype.toString=function(){try{const e=a.map.get.call(t.outputMap,this);if(e)return e}catch(t){}for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return t.originalFn.apply(this,i)},this.set(Function.prototype.toString,this.originalFn)}}class f{constructor(){e(this,\"active\",!1),e(this,\"tempTimeout\",void 0),e(this,\"dummyAudio\",new Audio),e(this,\"ogDesc\",{playbackRate:Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,\"playbackRate\"),defaultPlaybackRate:Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,\"defaultPlaybackRate\")}),e(this,\"coherence\",{playbackRate:new Map,defaultPlaybackRate:new Map}),e(this,\"activate\",(()=>{this.tempTimeout&&(clearTimeout(this.tempTimeout),delete this.tempTimeout),this.active||(this.active=!0,a.map.clear.call(this.coherence.playbackRate),a.map.clear.call(this.coherence.defaultPlaybackRate),p.forEach((t=>{a.map.set.call(this.coherence.playbackRate,t,this.ogDesc.playbackRate.get.call(t)),a.map.set.call(this.coherence.defaultPlaybackRate,t,this.ogDesc.defaultPlaybackRate.get.call(t))})))})),e(this,\"deactivate\",(()=>{this.tempTimeout&&(clearTimeout(this.tempTimeout),delete this.tempTimeout),this.active&&(this.active=!1)})),e(this,\"activateFor\",(t=>{this.active||(this.activate(),this.tempTimeout=setTimeout(this.deactivate,t))}));for(let t of[\"playbackRate\",\"defaultPlaybackRate\"]){const e=this.ogDesc[t];let i=this.coherence[t],o=this;try{Object.defineProperty(HTMLMediaElement.prototype,t,{configurable:!0,enumerable:!0,get:function(){return o.ogDesc[t].get.call(this),o.active?a.map.has.call(i,this)?a.map.get.call(i,this):1:e.get.call(this)},set:function(n){!o.active||this instanceof a.HTMLMediaElement||o.ogDesc[t].set.call(this,n);try{let t=e.set.call(o.active?o.dummyAudio:this,n),r=e.get.call(o.active?o.dummyAudio:this);return a.map.set.call(i,this,r),t}catch(t){throw t}}});const n=Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,t);c.set(n.get,e.get),c.set(n.set,e.set)}catch(t){}}}}class g{constructor(){e(this,\"parasite\",document.createElement(\"div\")),e(this,\"parasiteRoot\",this.parasite.attachShadow({mode:\"open\"})),e(this,\"handle\",(t=>{let e;a.stopImmediatePropagation.call(t);try{t.detail&&(e=a.JSON.parse(t.detail))}catch(t){}if(e)if(\"SEEK_NETFLIX\"===e.type)!function(t){try{(function(){const t=window.netflix.appContext.state.playerApp.getAPI().videoPlayer;return t.getAllPlayerSessionIds().map((e=>t.getVideoPlayerBySessionId(e)))})().forEach((e=>e.seek(1e3*t)))}catch(t){}}(e.value);else if(\"GHOST\"===e.type)e.off?r.deactivate():r.activate();else if(\"YT_RATE_CHANGE\"===e.type){var i;e.value&&(null===(i=s)||void 0===i||i(e.value))}})),e(this,\"send\",(t=>{a.dispatchEvent.call(this.parasiteRoot,new a.CustomEvent(\"GS_SERVER\",{detail:a.JSON.stringify({type:\"MSG\",data:t})}))})),e(this,\"wiggleOn\",(t=>{a.appendChild.call(t,this.parasite),a.dispatchEvent.call(this.parasiteRoot,new a.CustomEvent(\"GS_SERVER\",{detail:a.JSON.stringify({type:\"WIGGLE\"})}))})),this.parasite.id=\"GS_PARASITE\",this.parasiteRoot.addEventListener(\"GS_CLIENT\",this.handle,{capture:!0}),document.documentElement.appendChild(this.parasite),this.parasite.dispatchEvent(new CustomEvent(\"GS_INIT\"))}}!function(){if(i=null!==(t=i)&&void 0!==t?t:navigator.userAgent.includes(\"Firefox/\"),i){if(window.loadedGsCtx)return;window.loadedGsCtx=!0,function(){if(!document.domain.includes(\"soundcloud.com\"))return;const t=AudioContext.prototype.createMediaElementSource;AudioContext.prototype.createMediaElementSource=function(){return t.apply(this,[document.createElement(\"audio\")])}}()}var t;!function(){if(!location.hostname.includes(\"pan.baidu.com\"))return;let t=navigator.userAgent;t=t.replace(\"Windows NT\",\"Windоws NT\"),t=t.replace(\"Macintosh\",\"Macintоsh\"),t=t.replace(\"Chrome\",\"Chrоme\"),t=t.replace(\"Firefox\",\"Firefоx\"),t=t.replace(\"Edg\",\"Eԁg\"),t=t.replace(\"Safari\",\"Sаfari\");const e=Object.getOwnPropertyDescriptor(Navigator.prototype,\"userAgent\");Object.defineProperty(Navigator.prototype,\"userAgent\",{...e,get:function(){return t}})}(),c=new m,function(){if(!document.domain.includes(\"bilibili.com\"))return;let t=window.localStorage.getItem;window.localStorage.getItem=function(){for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];let o=t.apply(this,a);try{if(\"bwphevc_supported\"===a[0]){var n;let t=JSON.parse(o);if(t.supported&&(null==t||null===(n=t.info)||void 0===n||!n.isBrowserHEVCTypeSupported))return t.supported=!1,JSON.stringify(t)}}catch(t){}return o},c.set(window.localStorage.getItem,t)}(),r=new f,n=new g,\"www.youtube.com\"===location.hostname&&window.addEventListener(\"timeupdate\",(function(){var t;let e=document.querySelector(\"#movie_player\");if(e){try{e.getAvailablePlaybackRates().push(16)}catch(t){return}s=t=>{if(l!==t){l=t;try{r.activateFor(1e3),e.setPlaybackRate(t)}catch(t){}}},null===(t=n)||void 0===t||t.send({type:\"YT_REQUEST_RATE\"})}}),{capture:!0,once:!0}),d(HTMLMediaElement,\"play\",h),d(HTMLMediaElement,\"pause\",h),d(HTMLMediaElement,\"load\",h),d(Element,\"createShadowRoot\",y),d(Element,\"attachShadow\",y)}()}();")}function a(){var e;return document.hasFocus()&&!("IFRAME"===(null===(e=document.activeElement)||void 0===e?void 0:e.tagName))}class o{constructor(){var e;t(this,"downCbs",new Set),t(this,"upCbs",new Set),t(this,"withinFrame",void 0),t(this,"setup",(()=>{window.addEventListener("keydown",this.handleKeyDown,!0),window.addEventListener("keyup",this.handleKeyUp,!0),this.withinFrame&&n.mediaTower.ensureEventListeners()})),t(this,"release",(()=>{window.removeEventListener("keydown",this.handleKeyDown,!0),window.removeEventListener("keyup",this.handleKeyUp,!0)})),t(this,"handleKeyDown",(e=>{this.downCbs.forEach((t=>{t(e)}))})),t(this,"handleKeyUp",(e=>{this.upCbs.forEach((t=>{t(e)}))})),this.setup(),"IFRAME"===(null===(e=window.frameElement)||void 0===e?void 0:e.tagName)&&(this.withinFrame=!0,window.frameElement.addEventListener("load",this.setup,{capture:!0,passive:!0}))}}function l(e){const t=null==e?void 0:e.activeElement;if(!t)return;const i=function(e){if(e.shadowRoot)return e.shadowRoot;for(let t of n.mediaTower.docs)if(t instanceof ShadowRoot&&t.host===e)return t}(t);return i&&i.activeElement?l(i):t}function d(){return new Promise(((e,t)=>{chrome.runtime.sendMessage({type:"REQUEST_TAB_INFO"},(i=>{chrome.runtime.lastError?t(chrome.runtime.lastError):e(i)}))}))}function c(e,t,i){let n=i;return null!=e&&(n=Math.max(e,n)),null!=t&&(n=Math.min(t,n)),n}function u(){return Math.ceil(1e10*Math.random()).toString()}let h;const v={sepia:{min:0,max:1,step:.1,sliderMin:0,sliderMax:1,default:0,format:e=>`sepia(${e})`},hueRotate:{step:8,sliderMin:-180,sliderMax:180,sliderStep:1,default:0,format:e=>`hue-rotate(${e}deg)`},grayscale:{min:0,max:1,step:.1,sliderMin:0,sliderMax:1,default:0,format:e=>`grayscale(${e})`},contrast:{min:0,step:.1,sliderMin:0,sliderMax:5,default:1,format:e=>`contrast(${e})`},brightness:{min:0,step:.1,sliderMin:0,sliderMax:5,sliderStep:.05,default:1,format:e=>`brightness(${e})`},saturate:{min:0,step:.1,sliderMin:0,sliderMax:5,sliderStep:.05,default:1,format:e=>`saturate(${e})`},invert:{min:0,max:1,step:.1,sliderMin:0,sliderMax:1,default:0,format:e=>`invert(${e})`},blur:{min:0,step:.1,sliderMin:0,sliderMax:10,sliderStep:.1,default:0,format:e=>`blur(${e}px)`},opacity:{min:0,max:1,step:.1,sliderMin:0,sliderMax:1,default:1,format:e=>`opacity(${e})`},scaleX:{isTransform:!0,step:.1,sliderMin:-1,sliderMax:3,sliderStep:.04,default:1,format:e=>`scaleX(${e})`},scaleY:{isTransform:!0,step:.1,sliderMin:-1,sliderMax:3,sliderStep:.04,default:1,format:e=>`scaleY(${e})`},translateX:{isTransform:!0,step:1,sliderMin:-300,sliderMax:300,sliderStep:5,default:0,format:e=>`translateX(${e}px)`},translateY:{isTransform:!0,step:1,sliderMin:-300,sliderMax:300,sliderStep:5,default:0,format:e=>`translateY(${e}px)`},rotateX:{isTransform:!0,step:1,sliderMin:-180,sliderMax:180,sliderStep:1,default:0,format:e=>`rotateX(${e}deg)`},rotateY:{isTransform:!0,step:1,sliderMin:-180,sliderMax:180,sliderStep:1,default:0,format:e=>`rotateY(${e}deg)`},rotateZ:{isTransform:!0,step:1,sliderMin:-180,sliderMax:180,sliderStep:1,default:0,format:e=>`rotateZ(${e}deg)`}};function p(e){let t=[];return null==e||e.forEach((e=>{const i=v[e.name];null!=e.value&&e.value!==i.default&&t.push(i.format(e.value))})),t.join(" ")}function m(e,t,i){let n=!1,r=!1;return t.parts.forEach((t=>{if(t.disabled)return;let i=!1;if("STARTS_WITH"===t.type)i=e.startsWith(t.value);else if("CONTAINS"===t.type)i=e.includes(t.value);else{if("REGEX"!==t.type)return;try{i=new RegExp(t.value).test(e)}catch(e){}}(t.inverse?i:!i)?n=!0:r=!0})),r||n?(!t.matchAll||!n)&&r:i}var f,g,y;const w=!(!("requestPictureInPicture"in HTMLVideoElement.prototype)||!("pictureInPictureElement"in Document.prototype)),b=(null===(f=document.featurePolicy)||void 0===f||f.allowsFeature("picture-in-picture"),null===(g=window.CSS)||void 0===g||null===(y=g.supports)||void 0===y||y.call(g,"backdrop-filter: invert(1)"),(document.URL||"").startsWith("https://www.netflix.com")),E=(document.URL||"").startsWith("https://www.amazon"),k=b||E,M="www.bilibili.com"===location.hostname,T="www.youtube.com"===location.hostname,S="vimeo.com"===location.hostname,C=location.hostname.endsWith("reddit.com"),I=location.hostname.endsWith("facebook.com"),x=!(b||I),L=!(S||C);var _=i(3174).$;function F(e,t,i,n){i&&(t<10||Math.abs(e.currentTime-t)<3)&&(i=!1);const r=e.paused;n&&e.pause(),b?_.mediaTower.server.send({type:"SEEK_NETFLIX",value:t}):(i&&e.fastSeek?e.fastSeek(t):e.currentTime=t,E&&!n&&(r?e.play():e.pause(),r?e.pause():e.play()))}function P(e,t){e.readyState&&(e.gsMarks=e.gsMarks||{},e.gsMarks[t]=e.currentTime,_.mediaTower.sendUpdate())}function D(e,t,i){let n;return e.forEach(((e,r)=>{if("N"===i&&e<=t)return;if("P"===i&&e>=t)return;let s=Math.abs(t-e);(!n||s<n.diff)&&(n={index:r,diff:s})})),n||("N"===i&&e.length&&(n={index:0,diff:Math.abs(t-e[0])}),"P"===i&&e.length&&(n={index:e.length-1,diff:Math.abs(t-e[e.length-1])})),n}function A(e,t){e.gsNameless=e.gsNameless||[];let i=D(e.gsNameless,e.currentTime-(t?0:1),t?"N":"P");i&&F(e,e.gsNameless[i.index])}class O{static checkLimited(e){var t;if(!e||e.gsRateBanned)return!0;const i=2e4*Math.ceil((new Date).getTime()/2e4);var n;if((null===(t=e.gsRateCounter)||void 0===t?void 0:t.time)===i){if(++e.gsRateCounter.count>1e3)return e.gsRateViolations=null!==(n=e.gsRateViolations)&&void 0!==n?n:0,++e.gsRateViolations>=3&&(e.gsRateBanned=!0),delete e.gsRateCounter,!0}else e.gsRateCounter={time:i,count:1};return!1}static _set(e,t,i){if(!O.checkLimited(e)){t=c(.0625,16,t);try{e.playbackRate.toFixed(3)!==t.toFixed(3)&&(e.playbackRate=t)}catch(e){}try{e.defaultPlaybackRate.toFixed(3)!==t.toFixed(3)&&(e.defaultPlaybackRate=t)}catch(e){}e.preservesPitch=!i,e.mozPreservesPitch=!i,e.webkitPreservesPitch=!i}}static _setYt(e,t,i){e.hasAttribute("yss-skip")||this._set(e,t,i)}}function R(e,t){if(e)if("PLAYBACK_RATE"===t.type)O.set(e,t.value,t.freePitch);else if("SEEK"===t.type){if(t.percent)return void function(e,t,i,n){Math.abs(e.duration)!==1/0&&F(e,e.duration*t,i,n)}(e,t.value,t.fast,t.autoPause);!function(e,t,i,n,r){let s=i?e.currentTime+t:t;if(i&&e.seekToNextFrame&&!k&&.041===Math.abs(t)){if(e.paused||e.pause(),!(t<0)){let t=e.currentTime;return void e.seekToNextFrame().then((()=>{e.gsFrameSpan=function(e,t){return Math.ceil(1e4*e)/1e4}(e.currentTime-t),(e.gsFrameSpan>.05||e.gsFrameSpan<1/65)&&(e.gsFrameSpan=.04)}))}var a;s=e.currentTime-(null!==(a=e.gsFrameSpan)&&void 0!==a?a:.04)}F(e,s,n,r)}(e,t.value,t.relative,t.fast,t.autoPause)}else if("PAUSE"===t.type)!function(e,t){"on"===t||"toggle"===t&&!e.paused?e.pause():e.play()}(e,t.state);else if("MUTE"===t.type)!function(e,t){e.muted="on"===t||"off"!==t&&!e.muted}(e,t.state);else if("SET_VOLUME"===t.type)!function(e,t,i){e.volume=c(0,1,i?e.volume+t:t)}(e,t.value,t.relative);else if("SET_MARK"===t.type){let i=(t.key||"").toLowerCase();"::nameless"===t.key?function(e){e.gsNameless=e.gsNameless||[];const t=e.gsNameless,i=D(t,e.currentTime,"C");(null==i?void 0:i.diff)<=1?t.splice(i.index,1):t.push(e.currentTime)}(e):"::nameless-prev"===i?A(e):"::nameless-next"===i?A(e,!0):P(e,t.key)}else"SEEK_MARK"===t.type?function(e,t,i){var n;const r=null===(n=e.gsMarks)||void 0===n?void 0:n[t];null==r?P(e,t):F(e,r,i)}(e,t.key,t.fast):"TOGGLE_LOOP"===t.type?function(e,t){var i;let n=null===(i=e.gsMarks)||void 0===i?void 0:i[t];const r=()=>{e.removeEventListener("timeupdate",e.gsLoopTimeUpdateHandler,!0),e.removeEventListener("seeking",e.gsLoopSeekingHandler,!0),delete e.gsLoopTimeUpdateHandler,delete e.gsLoopSeekingHandler,_.mediaTower.sendUpdate()};if(e.gsLoopTimeUpdateHandler)return void r();if(null==n)return;let s=e.currentTime;n>s&&([n,s]=[s,n]),e.gsLoopTimeUpdateHandler=()=>{e.currentTime>s&&F(e,n)},e.gsLoopSeekingHandler=()=>{(e.currentTime<n-2||e.currentTime>s+2)&&r()},e.addEventListener("timeupdate",e.gsLoopTimeUpdateHandler,{capture:!0,passive:!0}),e.addEventListener("seeking",e.gsLoopSeekingHandler,{capture:!0,passive:!0}),_.mediaTower.sendUpdate()}(e,t.key):"PIP"===t.type?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"toggle";if(!w)return;let i="off"===t;if("toggle"===t&&e.getRootNode().pictureInPictureElement===e&&(i=!0),i)document.exitPictureInPicture();else{var n;if(!e.isConnected)return;e.removeAttribute("disablePictureInPicture"),null===(n=e.requestPictureInPicture)||void 0===n||n.call(e).catch((e=>{"SecurityError"===(null==e?void 0:e.name)&&null!=e&&e.message.includes("permissions policy")&&alert("PiP blocking detected. To circumvent, try my 'PiP Unblocker' extension.")}))}}(e,t.state):"FULLSCREEN"===t.type&&function(e,t){if(M&&!t){let e=document.querySelector(".bilibili-player-video-btn-fullscreen");if(e)return void e.click()}if(T&&!t){let e=document.querySelector(".ytp-fullscreen-button.ytp-button");if(e)return void e.click()}!x||!t&&L?!L||t&&x||_.smartFs.toggleSafe(e):_.nativeFs.toggleSafe(e)}(e,t.direct)}t(O,"set",T?O._setYt:O._set);var j=i(1296),N=i.n(j);let H,B;var U;(U=H||(H={}))[U.SET=1]="SET",U[U.ADD=2]="ADD",U[U.CYCLE=3]="CYCLE",function(e){e[e.FX=1]="FX",e[e.AUDIO_FX=2]="AUDIO_FX",e[e.MEDIA=3]="MEDIA",e[e.MISC=4]="MISC"}(B||(B={}));let z={nothing:{group:B.MISC,generate:()=>({id:u(),command:"nothing",enabled:!0,greedy:!0})},runCode:{group:B.MISC,valueType:"modalString",generate:()=>({id:u(),command:"runCode",enabled:!0,greedy:!0,valueString:"// code here"})},openUrl:{group:B.MISC,valueType:"string",generate:()=>({id:u(),command:"openUrl",enabled:!0,greedy:!0,valueString:"https://www.google.com/"})},adjustSpeed:{valueType:"adjustMode",hasFeedback:!0,valueMin:.07,valueMax:16,valueStep:.1,valueDefault:1,generate:()=>({id:u(),command:"adjustSpeed",enabled:!0,greedy:!0,adjustMode:H.SET})},speedChangesPitch:{valueType:"state",hasFeedback:!0,requiresMedia:!0,generate:()=>({id:u(),command:"speedChangesPitch",enabled:!0,greedy:!0,valueState:"toggle"})},setPin:{valueType:"state",hasFeedback:!0,generate:()=>({id:u(),command:"setPin",enabled:!0,greedy:!0,valueState:"toggle"})},setState:{valueType:"state",hasFeedback:!0,generate:()=>({id:u(),command:"setState",enabled:!0,greedy:!0,valueState:"toggle"})},seek:{group:B.MEDIA,valueType:"number",requiresMedia:!0,noNull:!0,hasFeedback:!0,generate:()=>({id:u(),command:"seek",enabled:!0,greedy:!0,valueNumber:10})},setPause:{group:B.MEDIA,valueType:"state",requiresMedia:!0,hasFeedback:!0,generate:()=>({id:u(),command:"setPause",enabled:!0,greedy:!0,valueState:"toggle"})},setMute:{group:B.MEDIA,hasFeedback:!0,valueType:"state",requiresMedia:!0,generate:()=>({id:u(),command:"setMute",enabled:!0,greedy:!0,valueState:"toggle"})},adjustVolume:{group:B.MEDIA,hasFeedback:!0,valueType:"number",requiresMedia:!0,valueDefault:.05,generate:()=>({id:u(),command:"adjustVolume",enabled:!0,greedy:!0})},setMark:{group:B.MEDIA,hasFeedback:!0,valueType:"string",requiresMedia:!0,generate:()=>({id:u(),command:"setMark",enabled:!0,greedy:!0,valueString:"mark1"})},seekMark:{group:B.MEDIA,hasFeedback:!0,valueType:"string",requiresMedia:!0,generate:()=>({id:u(),command:"seekMark",enabled:!0,greedy:!0,valueString:"mark1"})},toggleLoop:{group:B.MEDIA,hasFeedback:!0,valueType:"string",requiresMedia:!0,generate:()=>({id:u(),command:"toggleLoop",enabled:!0,greedy:!0,valueString:"mark1"})},fullscreen:{group:B.MEDIA,requiresVideo:!0,generate:()=>({id:u(),command:"fullscreen",enabled:!0,greedy:!0})},PiP:{group:B.MEDIA,valueType:"state",requiresVideo:!0,requiresPiPApi:!0,generate:()=>({id:u(),command:"PiP",enabled:!0,greedy:!0,valueState:"toggle"})},setFx:{group:B.FX,hasFeedback:!0,withFilterTarget:!0,valueType:"state",generate:()=>({id:u(),command:"setFx",enabled:!0,greedy:!0,valueState:"toggle",filterTarget:"element"})},resetFx:{group:B.FX,hasFeedback:!0,withFilterTarget:!0,generate:()=>({id:u(),command:"resetFx",enabled:!0,greedy:!0,filterTarget:"element"})},flipFx:{group:B.FX,hasFeedback:!0,generate:()=>({id:u(),command:"flipFx",enabled:!0,greedy:!0})},adjustFilter:{group:B.FX,hasFeedback:!0,valueType:"adjustMode",withFilterOption:!0,withFilterTarget:!0,generate:()=>({id:u(),command:"adjustFilter",filterOption:"hueRotate",enabled:!0,greedy:!0,filterTarget:"element",adjustMode:H.ADD})},adjustGain:{group:B.AUDIO_FX,hasFeedback:!0,valueType:"adjustMode",requiresTabCapture:!0,valueMin:0,valueMax:16,valueStep:.05,valueDefault:1,generate:()=>({id:u(),command:"adjustGain",enabled:!0,greedy:!0,adjustMode:H.ADD})},adjustPitch:{group:B.AUDIO_FX,hasFeedback:!0,valueType:"adjustMode",requiresTabCapture:!0,valueMin:-36,valueMax:36,valueStep:1,valueDefault:0,generate:()=>({id:u(),command:"adjustPitch",enabled:!0,greedy:!0,adjustMode:H.ADD})},adjustDelay:{group:B.AUDIO_FX,hasFeedback:!0,valueType:"adjustMode",requiresTabCapture:!0,valueMin:0,valueMax:60,valueStep:.05,valueDefault:0,generate:()=>({id:u(),command:"adjustDelay",enabled:!0,greedy:!0,adjustMode:H.ADD})},tabCapture:{group:B.AUDIO_FX,hasFeedback:!0,valueType:"state",requiresTabCapture:!0,generate:()=>({id:u(),command:"tabCapture",enabled:!0,greedy:!0,valueState:"toggle",global:!0})}};!function(e,t){let i=[],n=!1;for(let t of e)n&&(i.push(null),n=!1),i=[...i,...t],n=!0}(function(e,t){let i=new Map;for(let t of e){var n;const e=t[1],r=null!==(n=i.get(e))&&void 0!==n?n:[];r.push(t),i.set(e,r)}const r=[];return i.forEach((e=>{r.push(e)})),r}(Object.entries(z).filter((e=>!e[1].requiresTabCapture||chrome.tabCapture)).filter((e=>!e[1].requiresPiPApi||w)).map((e=>{let[t,i]=e;return[t,i.group]}))).map((e=>e.map((e=>e[0]))))),Object.freeze([{name:"1965",values:[-6,-17.2,-6,0,-3.6,9.2,1.2,9.2,3.6,-5.2]},{name:"1965 - Part 2",values:[-18,-14.4,0,0,-3.6,9.2,1.2,9.2,3.6,-5.2]},{name:"Lo-Fidelity",values:[-15.1,-9.4,0,2.3,-2,4.3,4.3,-2.3,-4.6,-8.9]},{name:"Musical Presence",values:[0,0,0,0,0,2.5,5,2.5,0,0]},{name:"Notch Every Two Octaves",values:[-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99]},{name:"Rattle The Trunk",values:[17.99,17.99,9,0,0,0,0,0,0,0]},{name:"Simple Bass Cut",values:[-4,-3,-2,-2,-2,0,0,0,0,0]},{name:"Simple Bass Lift",values:[6,6,3,3,3,0,0,0,0,0]},{name:"Simple High Cut",values:[0,0,0,0,0,-2,-2,-3,-3,-3]},{name:"Simple High Lift",values:[0,0,0,0,0,1,2,2,3,4]},{name:"Vocal Presence - Boost",values:[0,0,0,0,0,0,6.5,0,0,0]},{name:"Vocal Presence - Cut",values:[0,0,0,0,0,0,-6.5,0,0,0]}]),Object.freeze([{name:"20 Band Classic V",values:[5,6,3.54,.59,-.48,-2.5,-5,-7,-8,-8,-7,-5,-3,-2.5,-1,2,3,4,5,4.02]},{name:"Bowed String",values:[0,0,-1.2,-1.6,-2.4,-2.8,-1.6,-1.6,-1.6,0,0,0,0,0,2.4,3.6,5.6,0,0,0]},{name:"Bright and Punchy",values:[-3,3,6,4.5,3,1.5,0,0,0,0,0,0,0,1,2,3,4,4,4,4]},{name:"Cymbal Shimmer",values:[0,0,0,0,0,0,0,0,0,0,0,-.1,-.3,-.5,-.4,.2,1.3,2.6,3.6,4]},{name:"Dark and Dull",values:[-6,-4,-2,0,0,0,0,0,0,0,0,0,0,-3,-6,-9,-12,-15,-18,-18]},{name:"Destination - Car Stereo",values:[-4,-2,0,3,4,3,1.5,0,-1,-2,-2,-1,0,1,2,3,4,2,0,-3]},{name:"Heavy Guitar",values:[0,-.2,-.1,1,1.9,1.6,.4,-.5,-1.1,-2.2,-3.6,-3.9,-2.9,-1.6,-.5,.1,.1,0,0,0]},{name:"Liven up dead samples",values:[0,0,0,0,0,0,0,0,0,0,0,.1,.1,-.2,-.6,.5,3,3.9,1.5,-.4]},{name:"Notch Every Octave",values:[-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99]},{name:"Possible Bass",values:[0,0,5.2,6,3.2,0,-11.6,-5.2,-4,-4,0,3.2,4.8,0,0,0,-3.2,-7.2,-10.8,-14]},{name:"Sloping High End Boost",values:[0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,6,7,8,8]},{name:"Sloping Low End Boost",values:[8,8,8,8,7,6,5,4,3,2,1,0,0,0,0,0,0,0,0,0]},{name:"Tinny and Brittle",values:[-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,0,0,0,1,3.52,6,6,3,1]},{name:"Vocal Magic (breath)",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,.1,-.1,-.5,2,2.5,1]}]),Object.freeze([{name:"Bass - Increased Clarity",values:[-4,-3.4,-1.9,-.3,.6,.6,.2,-.3,-1.2,-1.5,1.4,2.9,.7,.2,.8,.5,0,-2,-.5,-.5,-.4,-.2,0,0,-.2,-.4,-.4,-.3,-.1,0]},{name:"Background Vocal",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-.2,-.3,-.4,-.4,-3,-6,-3,0,0,-.1,0,0,0]},{name:"Classic V",values:[3,2.5,1.3,.2,-.4,-.5,-.2,.2,.4,.3,-.3,-1.6,-3.4,-5.7,-8.2,-10.2,-10.9,-9.8,-7.4,-4.5,-2.3,-.9,-.1,0,-.2,-.3,.2,1.3,2.5,3]},{name:"Destination - Home Theater",values:[4.5,6,7.5,7.5,5,3,1.5,.5,0,-.5,-1.5,-3,-5,-3,-1.5,0,1.5,3,3,3,1.5,0,0,3,6,7.5,7.5,6,3,0]},{name:"Drums",values:[0,0,0,0,0,0,0,-.1,.3,.4,-2,-2.8,0,.6,-.2,-.1,0,-.2,-.3,-.5,-.4,-.1,0,0,.2,-.3,-.1,2.5,2.1,0]},{name:"Generic Attack Booster",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,-.1,-.1,-.1,.2,.6,1.3,2,2.8,3.1,2.7,1.8,.6,-.2,-.3,-.1,0]},{name:"Generic Mud Removal",values:[0,0,0,0,-.1,-.3,-.7,-1.5,-2.4,-3,-2.8,-2,-.8,0,.4,.3,0,-.1,-.1,0,0,0,0,0,0,0,0,0,0,0]},{name:"Gentle Hi Boost",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.5,1.5,3,5,5,3,1.5,.5]},{name:"Gentle Hi Cut",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-.5,-1.5,-3,-5,-5,-3,-1.5,-.5]},{name:"Gentle Low Boost",values:[0,.5,1.5,3,5,3,1.5,.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{name:"Gentle Low Cut",values:[0,-.5,-1.5,-3,-5,-3,-1.5,-.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{name:"Gentle Mid Boost",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,.5,1.5,3,5,5,3,1.5,.5,0,0,0,0,0,0,0,0,0]},{name:"Gentle Mid Cut",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,-.5,-1.5,-3,-5,-5,-3,-1.5,-.5,0,0,0,0,0,0,0,0,0]},{name:"Guitar - Increases Attack",values:[0,0,0,0,-1.5,-4,-2,0,0,0,0,0,0,0,0,0,0,-.2,-.3,-.4,2,0,-.1,0,0,0,-.1,0,0,0]},{name:"Keyboards - Bright and Clear",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-.2,-.3,-.4,-.4,2,5,2.5,0,0,-.1,0,0,0]},{name:"Kick - Less Boxy, more Attack",values:[0,0,0,0,0,0,0,0,0,0,-2.5,-6,-2.5,0,0,0,0,0,0,0,0,2,5,2,0,0,0,0,0,0]},{name:"Lead Vocal - Clarity",values:[0,0,0,0,0,0,0,0,-3,0,0,0,0,0,0,0,0,-.2,-.3,-.4,-.4,0,2,0,0,4,-.1,0,0,0]},{name:"Notch Every 2/3 Octave",values:[-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99]},{name:"RIAA De-Emphasis",values:[18.3,17.6,16.7,15.6,14.2,12.8,11.3,9.6,8,6.5,5,3.7,2.6,1.6,.7,0,-.7,-1.6,-2.6,-3.7,-5.1,-6.6,-8.2,-10,-11.9,-13.8,-15.7,-17.7,-19.7,-20]},{name:"Snare - Increase Snap",values:[0,-.1,-.2,-.1,.5,1.3,1.9,1.9,1.3,.4,-.1,-.3,-.2,0,.1,0,0,-.1,-.2,-.4,-.6,-.7,-.5,1.5,2,0,0,0,.9,0]},{name:"cymbals sans gong",values:[-8,-6.5,-3.3,-.4,.4,-.5,-2.3,-3.7,-4.5,-4.4,-3.7,-2.3,-.9,.1,.5,.3,0,-.3,-.5,-.5,-.4,-.2,0,.1,0,0,-.1,0,0,0]}]);function V(e,t){return window.globalState?Promise.resolve(window.globalState.get(e,t)):new Promise(((i,n)=>{window.globalState?i(window.globalState.get(e,t)):chrome.runtime.sendMessage({type:"FETCH_VIEW",selector:e,tabId:t},(e=>{chrome.runtime.lastError?n(chrome.runtime.lastError):i(e)}))}))}function $(e,t,i,n,r,s){e=function(e){return Object.fromEntries(Object.entries(e).filter((e=>{let[t,i]=e;return i})))}(e);const a={cbs:n?new Set([n]):new Set,subId:u()},o=(e,t)=>{a.view=e,a.cbs.forEach((i=>{i(e,t)}))};if(window.globalState){const i=N()(o,null!=r?r:0,{trailing:!0,leading:!0,...null==s?{}:{maxWait:s}}),n={selector:e,tabId:t,handleUpdate:i,id:a.subId};window.globalState.subs.add(n),a.release=()=>{a.released||(a.released=!0,a.cbs.clear(),window.globalState.subs.delete(n))}}else{const i=chrome.runtime.connect({name:`subscribe ${JSON.stringify({selector:e,tabId:t,id:a.subId,wait:r,maxWait:s})}`});i.onMessage.addListener((e=>{o(e)})),a.release=()=>{a.released||(a.released=!0,a.cbs.clear(),i.disconnect())}}return a.push=i=>{const n={};var r,s;Object.keys(e).forEach((e=>{n[e]=i[e]})),o(n,!1),r={override:n,tabId:t,ignoreSub:a.subId},null!==(s=window.globalState)&&void 0!==s&&s.set?(window.globalState.set(r),Promise.resolve()):new Promise(((e,t)=>{const i={};for(let[e,t]of Object.entries(r.override||{}))i[e]=null!=t?t:null;r.override=i,chrome.runtime.sendMessage({type:"PUSH_VIEW",init:r},(i=>{chrome.runtime.lastError?t(chrome.runtime.lastError):e()}))}))},i&&V(e,t).then((e=>{o(e,!0)})),a}i(3465);var K=i(3174).$;class X{constructor(){t(this,"released",void 0),t(this,"intervalId",void 0),t(this,"client",$({speed:!0,freePitch:!0},K.tabInfo.tabId,!0,(e=>{X.latest={speed:e.speed,freePitch:e.freePitch},this.updatePage()}),150,300)),t(this,"release",(()=>{var e;this.released||(null===(e=this.client)||void 0===e||e.release(),delete this.client,this.released=!0,this.intervalId=clearInterval(this.intervalId),K.mediaTower.newMediaCallbacks.delete(this.updatePage))})),t(this,"updatePage",(()=>{X.latest&&K.mediaTower.applySpeedToAll(X.latest.speed,X.latest.freePitch)})),this.intervalId=setInterval(this.updatePage,1e3),K.mediaTower.newMediaCallbacks.add(this.updatePage)}}t(X,"applySpeedOnHiddenDoc",!0),t(X,"latest",void 0),t(X,"handleHiddenDocSpeedPrompt",(()=>{X.latest&&X.applySpeedOnHiddenDoc&&K.mediaTower.applySpeedToAll(X.latest.speed,X.latest.freePitch)}));var Y=i(3174).$;class G{constructor(){t(this,"media",[]),t(this,"docs",[]),t(this,"canopy",chrome.runtime.connect({name:"MEDIA_CANOPY"})),t(this,"server",new q),t(this,"newDocCallbacks",new Set),t(this,"newMediaCallbacks",new Set),t(this,"observer",void 0),t(this,"observe",(e=>{window.IntersectionObserver&&(this.observer=this.observer||new IntersectionObserver(this.handleObservation,{threshold:[0,.2,.4,.6,.8,1]}),this.observer.observe(e))})),t(this,"handleObservation",(e=>{e.forEach((e=>{e.target.intersectionRatio=e.intersectionRatio})),this.sendUpdateDeb()})),t(this,"handleWiggle",(e=>{e instanceof ShadowRoot?this.processDoc(e):e instanceof HTMLMediaElement&&this.processMedia(e)})),t(this,"handleServerMessage",(e=>{if("YT_REQUEST_RATE"===(null==e?void 0:e.type)){var t;const e=null===(t=X.latest)||void 0===t?void 0:t.speed;e&&this.server.send({type:"YT_RATE_CHANGE",value:e})}})),t(this,"handleMessage",((e,t,i)=>{if("APPLY_MEDIA_EVENT"!==e.type)return"RUN_JS"===e.type?(r(e.value),void i(!0)):"BG_SPEED_OVERRIDE"===e.type?(X.latest={speed:e.speed,freePitch:e.freePitch},X.handleHiddenDocSpeedPrompt(),void i(!0)):void 0;if(e.key){const t=this.media.find((t=>t.gsKey===e.key));t&&R(t,e.event)}else this.media.forEach((t=>{R(t,e.event)}));i(!0)})),t(this,"processDoc",(e=>{this.docs.includes(e)||(this.docs.push(e),this.ensureDocEventListeners(e),this.newDocCallbacks.forEach((e=>e())))})),t(this,"processMedia",(e=>{if(this.media.includes(e))return;e.gsKey=e.gsKey||u();const t=null==e?void 0:e.getRootNode();t instanceof ShadowRoot&&this.processDoc(t),this.ensureMediaEventListeners(e),e instanceof HTMLVideoElement&&this.observe(e),this.media.push(e),this.sendUpdate(),this.newMediaCallbacks.forEach((e=>e()))})),t(this,"ensureDocEventListeners",(e=>{e.addEventListener("play",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("timeupdate",this.handleMediaEventDeb,{capture:!0,passive:!0}),e.addEventListener("pause",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("volumechange",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("loadedmetadata",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("emptied",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("enterpictureinpicture",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("leavepictureinpicture",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("fullscreenchange",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("webkitfullscreenchange",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("ratechange",this.handleMediaEvent,{capture:!0,passive:!0}),T&&e.addEventListener("ratechange",this.handleYoutubeRateChange,{capture:!0,passive:!0})})),t(this,"ensureMediaEventListeners",(e=>{e.addEventListener("play",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("pause",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("volumechange",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("loadedmetadata",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("emptied",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("ratechange",this.handleMediaEvent,{capture:!0,passive:!0})})),t(this,"ensureEventListeners",(()=>{this.docs.forEach((e=>this.ensureDocEventListeners(e))),this.media.forEach((e=>this.ensureMediaEventListeners(e)))})),t(this,"handleYoutubeRateChange",(e=>{const t=e.target.playbackRate;t&&Y.mediaTower.server.send({type:"YT_RATE_CHANGE",value:t})})),t(this,"hiddenSpeedUpdateTimeout",void 0),t(this,"handleMediaEvent",(e=>{if(null==e||!e.isTrusted)return;if(e.processed)return;e.processed=!0;let t=e.target;t instanceof HTMLMediaElement&&(this.processMedia(t),this.sendUpdate(),document.hidden&&X.applySpeedOnHiddenDoc&&("play"===e.type||"ratechange"===e.type)&&(clearTimeout(this.hiddenSpeedUpdateTimeout),this.hiddenSpeedUpdateTimeout=setTimeout((()=>{document.hidden&&X.handleHiddenDocSpeedPrompt()}),200)),"ratechange"===e.type?Y.ghostMode&&e.stopImmediatePropagation():"emptied"===e.type&&(delete t.gsMarks,delete t.gsNameless))})),t(this,"handleMediaEventDeb",N()(this.handleMediaEvent,5e3,{leading:!0,trailing:!0,maxWait:5e3})),t(this,"sendUpdate",(()=>{if(!Y.tabInfo)return;const e=(t=Y.tabInfo,i=this.media,{tabInfo:{...t},metaTitle:null===(n=navigator.mediaSession)||void 0===n||null===(r=n.metadata)||void 0===r?void 0:r.title,title:document.title,domain:document.domain,url:document.URL,media:i.map((e=>function(e){var t,i,n,r;const s=e.getRootNode(),a=e instanceof HTMLVideoElement,o=e.videoWidth,l=e.videoHeight,d=a&&o&&l?{w:o,h:l}:null;return{key:e.gsKey,isVideo:a,duration:e.duration,infinity:e.duration===1/0||void 0,paused:e.paused,volume:e.volume,muted:e.muted,pipMode:(null==s?void 0:s.pictureInPictureElement)===e,shadowMode:s instanceof ShadowRoot?s.mode:void 0,isConnected:e.isConnected,readyState:e.readyState,hasVideoTrack:!!(null!==(t=null===(i=e.videoTracks)||void 0===i?void 0:i.length)&&void 0!==t?t:d),hasAudioTrack:!(null!==(n=null===(r=e.audioTracks)||void 0===r?void 0:r.length)&&void 0!==n&&!n),videoSize:d,inLoop:!!e.gsLoopTimeUpdateHandler,marks:Object.keys(e.gsMarks||{}),intersectionRatio:d&&e.intersectionRatio}}(e)))});var t,i,n,r;chrome.runtime.sendMessage({type:"MEDIA_PUSH_SCOPE",value:e})})),t(this,"sendUpdateDeb",N()(this.sendUpdate,500,{leading:!0,trailing:!0,maxWait:2e3})),t(this,"applyMediaEventTo",((e,t,i)=>{let n=this.media.filter((e=>e.readyState));t?n=n.filter((e=>e.gsKey===t)):i&&(n=n.sort(((e,t)=>t.duration-e.duration)).slice(0,1)),0!==n.length&&n.forEach((t=>{R(this.media.find((e=>e.gsKey===t.gsKey)),e)}))})),t(this,"applySpeedToAll",((e,t)=>{e&&(e=function(e){return c(.07,16,function(e,t){const i=10**t;return Math.round(e*i)/i}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:2))}(e),this.media.forEach((i=>{R(i,{type:"PLAYBACK_RATE",value:e,freePitch:t})})))})),this.processDoc(window),this.server.wiggleCbs.add(this.handleWiggle),T&&this.server.msgCbs.add(this.handleServerMessage),chrome.runtime.onMessage.addListener(this.handleMessage)}}class q{constructor(){t(this,"parasite",void 0),t(this,"parasiteRoot",void 0),t(this,"wiggleCbs",new Set),t(this,"msgCbs",new Set),t(this,"initCbs",new Set),t(this,"initialized",!1),t(this,"handleInit",(e=>{e.target instanceof HTMLDivElement&&"GS_PARASITE"===e.target.id&&e.target.shadowRoot&&(this.parasite=e.target,this.parasiteRoot=this.parasite.shadowRoot,this.parasite.remove(),window.removeEventListener("GS_INIT",this.handleInit,!0),this.parasiteRoot.addEventListener("GS_SERVER",this.handle,{capture:!0}),this.initialized=!0,this.initCbs.forEach((e=>e())),this.initCbs.clear())})),t(this,"handle",(e=>{if(e.stopImmediatePropagation(),"GS_SERVER"!==e.type||!e.detail)return;let t;try{t=JSON.parse(e.detail)}catch(e){}if("WIGGLE"===t.type){const e=this.parasite.parentNode;e&&(this.parasite.remove(),this.wiggleCbs.forEach((t=>t(e))))}else"MSG"===t.type&&this.msgCbs.forEach((e=>e(t.data||{})))})),t(this,"send",(e=>{this.parasiteRoot.dispatchEvent(new CustomEvent("GS_CLIENT",{detail:JSON.stringify(e)}))})),window.addEventListener("GS_INIT",this.handleInit,!0)}}var W=i(3174).$;class J{constructor(){t(this,"released",void 0),t(this,"elementQuery",void 0),t(this,"elementIntervalId",void 0),t(this,"backdropIntervalId",void 0),t(this,"styleJail",new Q),t(this,"documentTransform",new Z),t(this,"elemFilter",void 0),t(this,"elemTransform",void 0),t(this,"elemTransformOrigin",void 0),t(this,"backdropFilter",void 0),t(this,"backdropTransform",void 0),t(this,"backdropTransformOrigin",void 0),t(this,"lastResult",void 0),t(this,"client",$({elementFx:!0,backdropFx:!0},W.tabInfo.tabId,!0,(e=>{this.handleChange(e)}))),t(this,"release",(()=>{var e;this.released||(null===(e=this.client)||void 0===e||e.release(),delete this.client,this.released=!0,this.backdropIntervalId=clearInterval(this.backdropIntervalId),this.elementIntervalId=clearInterval(this.elementIntervalId),this.styleJail.clear(),W.overlay.updateBackdrop(),this.documentTransform.clear())})),t(this,"handleChange",(e=>{var t,i;this.elemFilter=p(null===(t=e.elementFx)||void 0===t?void 0:t.filters),this.elemTransform=p(null===(i=e.elementFx)||void 0===i?void 0:i.transforms.slice().reverse()),this.elemTransformOrigin=`${e.elementFx.originX||"center"} ${e.elementFx.originY||"center"}`,this.backdropFilter=p(e.backdropFx.filters),this.backdropTransform=p(e.backdropFx.transforms.slice().reverse()),this.backdropTransformOrigin=`${e.backdropFx.originX||"center"} ${e.backdropFx.originY||"top"}`;const n=e.elementFx.enabled&&!(!this.elemFilter&&!this.elemTransform),r=e.backdropFx.enabled&&!(!this.backdropFilter&&!this.backdropTransform);var s,a;this.elementQuery=e.elementFx.query||"video",n?(this.elementIntervalId=null!==(s=this.elementIntervalId)&&void 0!==s?s:setInterval(this.handleElementInterval,1e3),this.handleElementInterval()):(clearInterval(this.elementIntervalId),delete this.elementIntervalId,this.styleJail.clear()),r?(this.backdropIntervalId=null!==(a=this.backdropIntervalId)&&void 0!==a?a:setInterval(this.handleBackdropInterval,1e3),this.handleBackdropInterval()):(clearInterval(this.backdropIntervalId),delete this.backdropIntervalId,this.documentTransform.clear(),W.overlay.updateBackdrop())})),t(this,"handleElementInterval",(()=>{let e=[];e="video"===this.elementQuery?W.mediaTower.media.filter((e=>e.isConnected&&e instanceof HTMLVideoElement)):ee.get(this.elementQuery),this.styleJail.set(e,{filter:this.elemFilter},{transform:this.elemTransform,origin:this.elemTransformOrigin})})),t(this,"handleBackdropInterval",(()=>{this.backdropFilter&&(window.top===window.self||document.fullscreenElement)?W.overlay.updateBackdrop(this.backdropFilter):W.overlay.updateBackdrop(),this.backdropTransform&&(window.top===window.self||document.fullscreenElement)?this.documentTransform.set(this.backdropTransform,this.backdropTransformOrigin):this.documentTransform.clear()}))}}class Q{constructor(){t(this,"elems",[]),t(this,"set",((e,t,i)=>{this.elems.forEach((t=>{e.includes(t)||(this.clearFilter(t),this.clearTransform(t))})),this.elems=e,this.elems.forEach((e=>{t?(e.ogFilter||(e.ogFilter={filter:e.style.filter}),e.style.filter!=t.filter&&(e.style.filter=t.filter)):this.clearFilter(e),i?(e.ogTransform||(e.ogTransform={transform:e.style.transform,origin:e.style.transformOrigin}),e.style.transform!=i.transform&&(e.style.transform=i.transform),e.style.transformOrigin!=i.origin&&(e.style.transformOrigin=i.origin)):this.clearTransform(e)}))})),t(this,"clear",(()=>{this.elems.forEach((e=>{e.style&&(this.clearFilter(e),this.clearTransform(e))})),this.elems=[]})),t(this,"clearFilter",(e=>{e.ogFilter&&(e.style.filter!=e.ogFilter.filter&&(e.style.filter=e.ogFilter.filter),delete e.ogFilter)})),t(this,"clearTransform",(e=>{e.ogTransform&&(e.style.transform!=e.ogTransform.transform&&(e.style.transform=e.ogTransform.transform),e.style.transformOrigin!=e.ogTransform.origin&&(e.style.transformOrigin=e.ogTransform.origin),delete e.ogTransform)}))}}class Z{constructor(){t(this,"memoized",void 0),t(this,"set",((e,t)=>{this.memoized=this.memoized||{transform:document.body.style.transform,origin:document.body.style.transformOrigin},document.body.style.transform!==e&&(document.body.style.transform=e),document.body.style.transformOrigin!==t&&(document.body.style.transformOrigin=t)})),t(this,"clear",(()=>{this.memoized&&(document.body.style.transform=this.memoized.transform,document.body.style.transformOrigin=this.memoized.origin,delete this.memoized)}))}}class ee{static get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;const{prev:i}=ee,n=(new Date).getTime();if(i&&i.query===e&&n-i.time<t)return i.value;const r=i&&i.query===e?i.tagNames:function(e){let t=[];for(let i of e.trim().split(",").map((e=>e.trim()))){if(!te.test(i))return;t.push(i)}return t}(e),s=function(e,t){let i=[];if(null!=t&&t.length)t.forEach((e=>{i=[...i,...document.getElementsByTagName(e)]}));else try{i=[...document.querySelectorAll(e)]}catch(e){return i.filter((e=>e instanceof HTMLElement))}return W.mediaTower.docs.forEach((t=>{if(t instanceof ShadowRoot&&t.isConnected)try{i=[...i,...t.querySelectorAll(e)]}catch(e){return i.filter((e=>e instanceof HTMLElement))}})),i.filter((e=>e instanceof HTMLElement))}(e,r);return ee.prev={query:e,tagNames:r,time:n,value:s},s}}t(ee,"prev",void 0);const te=/^[_a-z]+[_a-z0-9-]*$/i;function ie(e){let t=document.createElement("div");return t.innerHTML=e,t.children[0]}class ne{constructor(e){var i;this.filter=e,t(this,"div",document.createElement("div")),t(this,"innerDiv",document.createElement("div")),t(this,"sDiv",new se(this.div)),t(this,"hasBorder",!0),t(this,"colorInput",void 0),t(this,"releaseCb",void 0),t(this,"release",(()=>{var e;delete this.div,null===(e=this.sDiv)||void 0===e||e.release(),delete this.sDiv,ne.deletePane(this)})),t(this,"sync",(()=>{this.hasBorder?(this.div.style.border="1px solid black",this.div.classList.add("hasBorder")):(this.div.style.border="none",this.div.classList.remove("hasBorder")),this.colorInput?(this.innerDiv.style.backgroundColor=this.colorInput.value,this.innerDiv.style.backdropFilter="none"):(this.innerDiv.style.backdropFilter=this.filter,this.innerDiv.style.backgroundColor="transparent")})),this.innerDiv.classList.add("inner"),this.div.appendChild(this.innerDiv),this.div.classList.add("pane"),ne.addPane(this),null===(i=ne.shadowRoot)||void 0===i||i.append(this.div),this.div.tabIndex=0,this.div.addEventListener("contextmenu",(e=>{e.preventDefault(),e.stopImmediatePropagation(),this.release()}),{once:!0});const n={clone:ie('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M464 0c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48H176c-26.51 0-48-21.49-48-48V48c0-26.51 21.49-48 48-48h288M176 416c-44.112 0-80-35.888-80-80V128H48c-26.51 0-48 21.49-48 48v288c0 26.51 21.49 48 48 48h288c26.51 0 48-21.49 48-48v-48H176z"></path></svg>'),times:ie('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 352 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"></path></svg>'),paintRoller:ie('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M416 128V32c0-17.67-14.33-32-32-32H32C14.33 0 0 14.33 0 32v96c0 17.67 14.33 32 32 32h352c17.67 0 32-14.33 32-32zm32-64v128c0 17.67-14.33 32-32 32H256c-35.35 0-64 28.65-64 64v32c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h64c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32v-32h160c53.02 0 96-42.98 96-96v-64c0-35.35-28.65-64-64-64z"></path></svg>'),borderAll:ie('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H32A32 32 0 0 0 0 64v384a32 32 0 0 0 32 32h384a32 32 0 0 0 32-32V64a32 32 0 0 0-32-32zm-32 64v128H256V96zm-192 0v128H64V96zM64 416V288h128v128zm192 0V288h128v128z"></path></svg>')},r=document.createElement("div");this.div.appendChild(r),r.classList.add("menu"),r.appendChild(n.clone),r.appendChild(n.paintRoller),r.appendChild(n.borderAll),r.appendChild(n.times),n.clone.addEventListener("click",(e=>{ne.clone(this).div.focus()})),n.paintRoller.addEventListener("click",(e=>{this.colorInput?(delete this.colorInput,this.sync()):(this.colorInput=document.createElement("input"),this.colorInput.type="color",this.colorInput.addEventListener("input",this.sync),this.colorInput.click())})),n.borderAll.addEventListener("click",(e=>{this.hasBorder=!this.hasBorder,this.sync()})),n.times.addEventListener("click",(e=>{this.release()})),this.sync()}}var re;t(ne,"panes",new Set),t(ne,"shadowRoot",void 0),t(ne,"addPane",(e=>{if(ne.panes.add(e),ne.panes.size&&!ne.shadowRoot){ne.shadowRoot=document.createElement("div").attachShadow({mode:"closed"});const e=document.createElement("style");e.textContent="\n        .pane:focus { outline: none; }\n        .pane.hasBorder:focus { outline: 2px solid black; }\n\n        .menu {\n          position: absolute;\n          right: 3px;\n          top: 3px;\n          display: none;\n          grid-auto-flow: column;\n          justify-content: right;\n          grid-column-gap: 5px;\n          font-size: 16px;\n        }\n\n        .inner {\n          width: 100%;\n          height: 100%;\n        }\n\n        .pane:focus > .menu, .pane:hover > .menu {\n          display: grid;\n        }\n\n        svg {\n          opacity: 0.5;\n          background-color: black;\n          color: white;\n          padding: 5px;\n        }\n\n        svg:hover {\n          opacity: 1;\n        }\n      ",ne.shadowRoot.appendChild(e),document.body.appendChild(ne.shadowRoot.host)}})),t(ne,"deletePane",(e=>{ne.panes.delete(e),0===ne.panes.size&&ne.shadowRoot&&(ne.shadowRoot.host.remove(),delete ne.shadowRoot)})),t(ne,"clone",(e=>{const t=new ne(e.filter,!0);return t.colorInput=e.colorInput?e.colorInput.cloneNode():null,t.sDiv.x=e.sDiv.x+20,t.sDiv.y=e.sDiv.y+20,t.sDiv.width=e.sDiv.width,t.sDiv.height=e.sDiv.height,t.sDiv.sync(),t.hasBorder=e.hasBorder,t.sync(),t})),function(e){e[e.X_LEFT=1]="X_LEFT",e[e.X_RIGHT=2]="X_RIGHT",e[e.Y_TOP=3]="Y_TOP",e[e.Y_BOTTOM=4]="Y_BOTTOM",e[e.MOVING=5]="MOVING"}(re||(re={}));class se{constructor(e){this.div=e,t(this,"width",500),t(this,"height",350),t(this,"x",(window.innerWidth-this.width)/2+window.scrollX),t(this,"y",(window.innerHeight-this.height)/2+window.scrollY),t(this,"ref",void 0),t(this,"handleDimChange",void 0),t(this,"release",(()=>{this.handleMouseUp(),this.div.remove(),this.div.removeEventListener("mousedown",this.handleMouseDown)})),t(this,"handleMouseDown",(e=>{if(0!==e.button)return;if(e.stopImmediatePropagation(),this.ref)return void this.handleMouseUp();const t=new Set;e.offsetX<20?t.add(re.X_LEFT):this.width-e.offsetX<20&&t.add(re.X_RIGHT),e.offsetY<20?t.add(re.Y_TOP):this.height-e.offsetY<20&&t.add(re.Y_BOTTOM),0===t.size&&t.add(re.MOVING),this.ref={x:this.x,y:this.y,width:this.width,height:this.height,cursorX:e.pageX,cursorY:e.pageY,transforms:t},window.addEventListener("mousemove",this.handleMouseMove,{capture:!0,passive:!0}),window.addEventListener("mouseup",this.handleMouseUp,{capture:!0,passive:!0})})),t(this,"handleMouseUp",(()=>{delete this.ref,window.removeEventListener("mousemove",this.handleMouseMove,{capture:!0}),window.removeEventListener("mouseup",this.handleMouseUp,{capture:!0})})),t(this,"handleMouseMove",(e=>{if(!this.ref)return void this.handleMouseUp();var t={x:this.x,y:this.y,width:this.width,height:this.height};const i=e.pageX-this.ref.cursorX,n=e.pageY-this.ref.cursorY;this.ref.transforms.has(re.X_LEFT)?(t.width=Math.max(this.ref.width-i,150),t.x=this.ref.x-(t.width-this.ref.width)):this.ref.transforms.has(re.X_RIGHT)&&(t.width=this.ref.width+i),this.ref.transforms.has(re.Y_TOP)?(t.height=Math.max(this.ref.height-n,100),t.y=this.ref.y-(t.height-this.ref.height)):this.ref.transforms.has(re.Y_BOTTOM)&&(t.height=this.ref.height+(e.pageY-this.ref.cursorY)),this.ref.transforms.has(re.MOVING)&&(t.x=this.ref.x+i,t.y=this.ref.y+n),this.width=Math.max(150,t.width),this.height=Math.max(100,t.height),this.x=t.x,this.y=t.y,this.sync()})),this.div.addEventListener("mousedown",this.handleMouseDown),this.sync()}sync(){this.div.style.width=`${this.width}px`,this.div.style.height=`${this.height}px`,this.div.style.position="absolute",this.div.style.left=`${this.x}px`,this.div.style.top=`${this.y}px`,this.div.style.zIndex="99999999999",this.div.style.userSelect="none"}}var ae=i(3174).$;const oe=["v.qq.com","www.qq.com","sports.qq.com","wetv.vip","web.whatsapp.com","pan.baidu.com","onedrive.live.com"];class le{constructor(){t(this,"port",void 0),t(this,"released",!1),t(this,"blockKeyUp",!1),t(this,"lastTrigger",0),t(this,"fxSync",void 0),t(this,"speedSync",void 0),t(this,"client",$({ghostMode:!0,enabled:!0,enabledLatestViaPopup:!0,keybinds:!0,keybindsUrlCondition:!0,superDisable:!0},ae.tabInfo.tabId,!0,(()=>{this.handleEnabledChange()}),300)),t(this,"indicatorClient",$({indicatorInit:!0},ae.tabInfo.tabId,!0,(e=>{var t;null===(t=ae.overlay)||void 0===t||t.setInit(e.indicatorInit||{})}),500)),t(this,"release",(()=>{var e,t,i,n;this.released||(null===(e=this.client)||void 0===e||e.release(),delete this.client,this.released=!0,null===(t=this.fxSync)||void 0===t||t.release(),delete this.fxSync,null===(i=this.speedSync)||void 0===i||i.release(),delete this.speedSync,null===(n=this.port)||void 0===n||n.disconnect(),delete this.port,ae.keyListener.downCbs.delete(this.handleKeyDown),ae.keyListener.upCbs.delete(this.handleKeyUp),chrome.runtime.onMessage.removeListener(this.handleMessage))})),t(this,"handleEnabledChange",(()=>{var e,t,i,n,r,s,a;if(null!==(e=this.client.view)&&void 0!==e&&e.enabled?(X.applySpeedOnHiddenDoc=!0,this.fxSync=null!==(n=this.fxSync)&&void 0!==n?n:new J,this.speedSync=null!==(r=this.speedSync)&&void 0!==r?r:new X):(X.applySpeedOnHiddenDoc=!1,null===(s=this.fxSync)||void 0===s||s.release(),delete this.fxSync,null===(a=this.speedSync)||void 0===a||a.release(),delete this.speedSync),null!==(t=this.client.view)&&void 0!==t&&t.enabled&&(null!==(i=this.client.view)&&void 0!==i&&i.ghostMode||oe.some((e=>(location.hostname||"").includes(e))))){if(ae.ghostMode)return;ae.ghostMode=!0;const e=()=>{ae.mediaTower.server.send({type:"GHOST"})};ae.mediaTower.server.initialized?e():ae.mediaTower.server.initCbs.add(e)}else{if(!ae.ghostMode)return;ae.ghostMode=!1;const e=()=>{ae.mediaTower.server.send({type:"GHOST",off:!0})};ae.mediaTower.server.initialized?e():ae.mediaTower.server.initCbs.add(e)}})),t(this,"handleKeyUp",(e=>{this.lastTrigger=0,this.blockKeyUp&&(this.blockKeyUp=!1,e.stopImmediatePropagation(),e.preventDefault())})),t(this,"handleKeyDown",(e=>{var t,i,n;if(null===(t=this.client)||void 0===t||!t.view)return;if(this.client.view.superDisable)return;const r=this.client.view.enabled;if(!r&&this.client.view.enabledLatestViaPopup)return;const s=this.client.view.keybinds;this.blockKeyUp=!1;const a=e.target;if(["INPUT","TEXTAREA"].includes(a.tagName)||a.isContentEditable)return;const o=l(document);if(a!==o&&(["INPUT","TEXTAREA"].includes(o.tagName)||o.isContentEditable))return;if(null!==(i=this.client.view.keybindsUrlCondition)&&void 0!==i&&null!==(n=i.parts)&&void 0!==n&&n.length&&!m(location.href||"",this.client.view.keybindsUrlCondition,!0))return;const d={ctrlKey:(c=e).ctrlKey,altKey:c.altKey,shiftKey:c.shiftKey,metaKey:c.metaKey,code:c.code};var c;let u=r?s:s.filter((e=>"setState"===e.command));if(u=u.filter((e=>{return e.enabled&&!e.global&&(t=e.key,i=d,null!=t&&null!=i&&("string"==typeof t&&(t={code:t}),"string"==typeof i&&(i={code:i}),!0===t.ctrlKey==(!0===i.ctrlKey)&&!0===t.altKey==(!0===i.altKey)&&!0===t.shiftKey==(!0===i.shiftKey)&&!0===t.metaKey==(!0===i.metaKey)&&t.code===i.code));var t,i})),u=u.filter((e=>{var t;return!((null===(t=e.condition)||void 0===t?void 0:t.parts.length)>0)||m(window.location.href||"",e.condition,!0)})),u.some((e=>e.greedy))&&(this.blockKeyUp=!0,e.preventDefault(),e.stopImmediatePropagation()),u.length){const e=(new Date).getTime();e-this.lastTrigger>50&&(this.lastTrigger=e,chrome.runtime.sendMessage({type:"TRIGGER_KEYBINDS",ids:u.map((e=>e.id))}))}})),t(this,"handleMessage",((e,t,i)=>{if("SHOW_INDICATOR"===e.type){if(e.requiresFocus&&!a())return;return ae.overlay.show(e.opts),void i(!0)}if("INJECT_SCRIPT"===e.type){if(e.requiresFocus&&!a())return;return r(e.code),void i(!0)}"ADD_PANE"===e.type?new ne(e.filter):"CLEAR_PANES"===e.type&&[...ne.panes].forEach((e=>{e.release()}))})),this.port=chrome.runtime.connect({name:"configSync"}),setTimeout((()=>{ae.keyListener.downCbs.add(this.handleKeyDown),ae.keyListener.upCbs.add(this.handleKeyUp)}),100),chrome.runtime.onMessage.addListener(this.handleMessage)}}var de=i(3174).$;class ce{constructor(e){var i;t(this,"wrapper",document.createElement("div")),t(this,"shadowRoot",this.wrapper.attachShadow({mode:"closed"})),t(this,"indicator",document.createElement("div")),t(this,"backdrop",document.createElement("div")),t(this,"timeoutId",void 0),t(this,"icons",{play:ie('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="0.8em" width="0.8em" xmlns="http://www.w3.org/2000/svg"><path d="M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"></path></svg>'),pause:ie('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="0.8em" width="0.8em" xmlns="http://www.w3.org/2000/svg"><path d="M144 479H48c-26.5 0-48-21.5-48-48V79c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v352c0 26.5-21.5 48-48 48zm304-48V79c0-26.5-21.5-48-48-48h-96c-26.5 0-48 21.5-48 48v352c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48z"></path></svg>'),bookmark:ie('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 384 512" height="0.8em" width="0.8em" xmlns="http://www.w3.org/2000/svg"><path d="M0 512V48C0 21.49 21.49 0 48 0h288c26.51 0 48 21.49 48 48v464L192 400 0 512z"></path></svg>'),arrowRight:ie('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"></path></svg>'),arrowLeft:ie('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"></path></svg>'),forward:ie('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M500.5 231.4l-192-160C287.9 54.3 256 68.6 256 96v320c0 27.4 31.9 41.8 52.5 24.6l192-160c15.3-12.8 15.3-36.4 0-49.2zm-256 0l-192-160C31.9 54.3 0 68.6 0 96v320c0 27.4 31.9 41.8 52.5 24.6l192-160c15.3-12.8 15.3-36.4 0-49.2z"></path></svg>'),backward:ie('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11.5 280.6l192 160c20.6 17.2 52.5 2.8 52.5-24.6V96c0-27.4-31.9-41.8-52.5-24.6l-192 160c-15.3 12.8-15.3 36.4 0 49.2zm256 0l192 160c20.6 17.2 52.5 2.8 52.5-24.6V96c0-27.4-31.9-41.8-52.5-24.6l-192 160c-15.3 12.8-15.3 36.4 0 49.2z"></path></svg>'),loop:ie('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 640 512" height="1.1em" width="1.1em" xmlns="http://www.w3.org/2000/svg"><path d="M471.1 96C405 96 353.3 137.3 320 174.6 286.7 137.3 235 96 168.9 96 75.8 96 0 167.8 0 256s75.8 160 168.9 160c66.1 0 117.8-41.3 151.1-78.6 33.3 37.3 85 78.6 151.1 78.6 93.1 0 168.9-71.8 168.9-160S564.2 96 471.1 96zM168.9 320c-40.2 0-72.9-28.7-72.9-64s32.7-64 72.9-64c38.2 0 73.4 36.1 94 64-20.4 27.6-55.9 64-94 64zm302.2 0c-38.2 0-73.4-36.1-94-64 20.4-27.6 55.9-64 94-64 40.2 0 72.9 28.7 72.9 64s-32.7 64-72.9 64z"></path></svg>'),fx:ie('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 10 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 7H6l3-7-9 9h4l-3 7 9-9z"></path></svg>'),power:ie('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="0.95em" width="0.95em" xmlns="http://www.w3.org/2000/svg"><path d="M400 54.1c63 45 104 118.6 104 201.9 0 136.8-110.8 247.7-247.5 248C120 504.3 8.2 393 8 256.4 7.9 173.1 48.9 99.3 111.8 54.2c11.7-8.3 28-4.8 35 7.7L162.6 90c5.9 10.5 3.1 23.8-6.6 31-41.5 30.8-68 79.6-68 134.9-.1 92.3 74.5 168.1 168 168.1 91.6 0 168.6-74.2 168-169.1-.3-51.8-24.7-101.8-68.1-134-9.7-7.2-12.4-20.5-6.5-30.9l15.8-28.1c7-12.4 23.2-16.1 34.8-7.8zM296 264V24c0-13.3-10.7-24-24-24h-32c-13.3 0-24 10.7-24 24v240c0 13.3 10.7 24 24 24h32c13.3 0 24-10.7 24-24z"></path></svg>'),swap:ie('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M0 168v-16c0-13.255 10.745-24 24-24h360V80c0-21.367 25.899-32.042 40.971-16.971l80 80c9.372 9.373 9.372 24.569 0 33.941l-80 80C409.956 271.982 384 261.456 384 240v-48H24c-13.255 0-24-10.745-24-24zm488 152H128v-48c0-21.314-25.862-32.08-40.971-16.971l-80 80c-9.372 9.373-9.372 24.569 0 33.941l80 80C102.057 463.997 128 453.437 128 432v-48h360c13.255 0 24-10.745 24-24v-16c0-13.255-10.745-24-24-24z"></path></svg>'),reset:ie('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M248.91 50c11.882-.006 23.875 1.018 35.857 3.13 85.207 15.025 152.077 81.895 167.102 167.102 15.023 85.208-24.944 170.917-99.874 214.178-32.782 18.927-69.254 27.996-105.463 27.553-46.555-.57-92.675-16.865-129.957-48.15l30.855-36.768c50.95 42.75 122.968 49.05 180.566 15.797 57.597-33.254 88.152-98.777 76.603-164.274-11.55-65.497-62.672-116.62-128.17-128.168-51.656-9.108-103.323 7.98-139.17 43.862L185 192H57V64l46.34 46.342C141.758 71.962 194.17 50.03 248.91 50z"></path></svg>'),speedChangesPitch:ie('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M12 13c0 1.105-1.12 2-2.5 2S7 14.105 7 13s1.12-2 2.5-2 2.5.895 2.5 2z"></path><path fill-rule="evenodd" d="M12 3v10h-1V3h1z" clip-rule="evenodd"></path><path d="M11 2.82a1 1 0 01.804-.98l3-.6A1 1 0 0116 2.22V4l-5 1V2.82z"></path><path fill-rule="evenodd" d="M0 11.5a.5.5 0 01.5-.5H4a.5.5 0 010 1H.5a.5.5 0 01-.5-.5zm0-4A.5.5 0 01.5 7H8a.5.5 0 010 1H.5a.5.5 0 01-.5-.5zm0-4A.5.5 0 01.5 3H8a.5.5 0 010 1H.5a.5.5 0 01-.5-.5z" clip-rule="evenodd"></path></svg>')}),t(this,"released",!1),t(this,"hasIndicator",!1),t(this,"hasFilter",!1),t(this,"root",document.documentElement),t(this,"scaling",1),t(this,"duration",1),t(this,"static",!1),t(this,"setInit",(e=>{var t,i,n,r,s;e=e||{},this.indicator.style.backgroundColor=e.backgroundColor||"#000000",this.indicator.style.color=e.textColor||"#ffffff",this.static=e.static,this.duration=null!==(t=e.duration)&&void 0!==t?t:1,this.scaling=null!==(i=e.scaling)&&void 0!==i?i:1;const a=(null!==(n=e.rounding)&&void 0!==n?n:0)*this.scaling;this.indicator.style.padding=10*(this.scaling+.12*a)+"px",this.indicator.style.fontSize=30*this.scaling+"px",this.indicator.style.borderRadius=a?10*a+"px":"0px",this.indicator.style.left=30*(null!==(r=e.offset)&&void 0!==r?r:1)+"px",this.indicator.style.top=30*(null!==(s=e.offset)&&void 0!==s?s:1)+"px"})),t(this,"release",(()=>{var e;this.released||(this.released=!0,window.removeEventListener("fullscreenchange",this.handleFullscreenChange,{capture:!0}),window.removeEventListener("webkitfullscreenchange",this.handleFullscreenChange,{capture:!0}),null===(e=this.wrapper)||void 0===e||e.remove(),delete this.wrapper)})),t(this,"show",(e=>{var t;this.timeoutId&&clearTimeout(this.timeoutId),this.indicator.innerText=e.preText||"",(e.icons||[]).forEach((e=>{this.indicator.appendChild(this.icons[e])})),this.indicator.append(e.text||"");const i=(null!==(t=e.duration)&&void 0!==t?t:900)*this.duration;this.indicator.style.fontSize=(e.small?24.9:30)*this.scaling+"px",this.indicator.style.animation=e.static||this.static?"":`gsScale ${i}ms ease-out forwards`,this.indicator.remove(),this.shadowRoot.appendChild(this.indicator),this.hasIndicator=!0,this.syncWrapper(),this.timeoutId=setTimeout((()=>{this.indicator.remove(),this.hasIndicator=!1,this.syncWrapper(),delete this.timeoutId}),i)})),t(this,"updateBackdrop",(e=>{e?(this.backdrop.style.backdropFilter!==e&&(this.backdrop.style.backdropFilter=e),this.backdrop.isConnected||this.shadowRoot.appendChild(this.backdrop),this.hasFilter=!0,this.syncWrapper()):(this.backdrop.remove(),this.hasFilter=!1,this.syncWrapper())})),t(this,"syncWrapper",(()=>{if(this.hasFilter||this.hasIndicator){var e;if(this.root=null!==(e=this.root)&&void 0!==e&&e.isConnected?this.root:document.documentElement,this.wrapper.parentNode===this.root)return;try{this.root.appendChild(this.wrapper)}catch(e){this.root!==document.documentElement&&(this.root=document.documentElement,document.documentElement.appendChild(this.wrapper))}}else{var t;null===(t=this.wrapper)||void 0===t||t.remove()}})),t(this,"handleFullscreenChange",(e=>{let t=document.documentElement,i=ue(document);i&&"IFRAME"!==i.tagName&&(t=i),this.root=t,this.syncWrapper()})),this.indicator.setAttribute("style","\n      box-sizing: border-box; \n      position: fixed;\n      font-family: Courier, monospace;\n      color: white;\n      background-color: black;\n      z-index: 999999999999;\n      white-space: pre;\n      display: grid;\n      grid-auto-flow: column;\n      align-items: center;\n      border: none;\n      user-select: none;\n    "),this.backdrop.setAttribute("style","\n      position: fixed;\n      left: 0;\n      top: 0;\n      width: 100vw;\n      height: 100vh;\n      z-index: 999999999999;\n      pointer-events: none;\n    ");let n=document.createElement("style");this.shadowRoot.appendChild(n),n.textContent="\n      @keyframes gsScale {\n        from {\n          transform: scale(0.95);\n          opacity: 1;\n        }\n        to {\n          transform: scale(1.05);\n          opacity: 0;\n        }\n      }\n    ",e||(window.addEventListener("fullscreenchange",this.handleFullscreenChange,{capture:!0,passive:!0}),window.addEventListener("webkitfullscreenchange",this.handleFullscreenChange,{capture:!0,passive:!0})),null===(i=this.setInit)||void 0===i||i.call(this,{})}}function ue(e){if(!e.fullscreenElement)return null;const t=e.fullscreenElement;let i=t.shadowRoot;if(i&&de.mediaTower.processDoc(t.shadowRoot),i||(i=de.mediaTower.docs.find((e=>e instanceof ShadowRoot&&e.host===t))),i){let e=ue(i);if(e)return e}return t}var he=i(3174).$;class ve{constructor(){t(this,"lock",void 0),t(this,"operationLock",void 0),t(this,"handleFullscreenChange",(e=>{if(this.lock){if(document.fullscreenElement&&this.lock.getRootNode().fullscreenElement===this.lock)return;this.lock=null}document.fullscreenElement&&this.attemptIntegration()})),t(this,"attemptIntegration",(async()=>{if(!document.fullscreenElement||document.fullscreenElement instanceof HTMLVideoElement)return;let e=he.mediaTower.media.filter((e=>e.readyState&&e instanceof HTMLVideoElement&&e.videoWidth&&e.isConnected)).map((e=>function(e){var t;if(!e)return;let i=null===(t=function(e){if(!e)return;let t=e;for(;;){var i;let e=null===(i=t)||void 0===i?void 0:i.getRootNode();if(!e)return;if(e.fullscreenElement)return e;if(!(e instanceof ShadowRoot))return;t=e.host}}(e))||void 0===t?void 0:t.fullscreenElement;return i&&i!==e?function(e,t){if(!e||!t)return;let i=0,n=t;for(;;){var r,s;if(n=(null===(r=n)||void 0===r?void 0:r.parentNode)||(null===(s=n)||void 0===s?void 0:s.host),i++,!n)return;if(n===e)return{ancestor:e,distance:i,child:t}}}(i,e):void 0}(e))).filter((e=>e));if(e.length>1&&(e=e.filter((e=>e.child.intersectionRatio)).sort(((e,t)=>t.child.intersectionRatio-e.child.intersectionRatio)).slice(0,1)),1!==e.length)return;const t=me(e[0]);t&&await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,{profiles:i,key:n}=await fe();i=i.filter((e=>e.created>(new Date).getTime()-7776e6));let r=i.map((t=>({profile:t,score:pe(t,e)}))).sort(((e,t)=>t.score-e.score))[0];if((null==r?void 0:r.score)>0&&r.score/e.maxScore>(null!=t?t:.5)){let e=i.indexOf(r.profile);e>=0&&i.splice(e,1)}i.unshift(e),chrome.storage.local.set({[n]:i.slice(0,10)})}(t)})),t(this,"toggleSafe",(async e=>{this.operationLock||(this.operationLock=!0,await this.toggle(e).finally((()=>{delete this.operationLock})))})),t(this,"toggle",(async e=>{if(document.fullscreenElement)return void await document.exitFullscreen();if(!(L&&null!=e&&e.isConnected&&e.readyState&&e.videoWidth))return;const t=await async function(e){let t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,{profiles:n}=await fe();if(new Set(n.map((e=>e.distance))).forEach((i=>{let r=function(e,t){let i=e;for(let e=0;e<t;e++)if(i=i.parentNode||i.host,!i)return;return i}(e,i);if(!(r instanceof Element))return;const s=me({distance:i,child:e,ancestor:r});n.filter((e=>e.distance===i)).forEach((e=>{const i=pe(s,e);(!t||i>t.score)&&(t={profile:e,score:i,ancestor:r})}))})),t&&t.score/t.profile.maxScore>i)return t}(e,.5);t?(await t.ancestor.requestFullscreen(),this.lock=t.ancestor):await he.nativeFs.toggleSafe(e)})),window.addEventListener("fullscreenchange",this.handleFullscreenChange,{passive:!0,capture:!0}),window.addEventListener("webkitfullscreenchange",this.handleFullscreenChange,{passive:!0,capture:!0})}}function pe(e,t){if(e.distance!==t.distance)return-1/0;if(e.parentTag!==t.parentTag)return-1/0;let i=0;return new Set([...e.videoAttributes,...t.videoAttributes]).forEach((n=>{i+=e.videoAttributes.includes(n)&&t.videoAttributes.includes(n)?10:-10})),new Set([...e.parentAttributes,...t.parentAttributes]).forEach((n=>{i+=e.parentAttributes.includes(n)&&t.parentAttributes.includes(n)?10:-10})),new Set([...e.videoClassNames,...t.videoClassNames]).forEach((n=>{i+=e.videoClassNames.includes(n)&&t.videoClassNames.includes(n)?10:0})),new Set([...e.parentClassNames,...t.parentClassNames]).forEach((n=>{i+=e.parentClassNames.includes(n)&&t.parentClassNames.includes(n)?10:0})),i+=e.videoId===t.videoId?e.videoId?25:10:0,i+=e.parentId===t.parentId?e.parentId?25:10:0,e.slashes[0]&&t.slashes[1]&&(i+=e.slashes[0]===t.slashes[1]?25:0),e.slashes[1]&&t.slashes[1]&&(i+=e.slashes[1]===t.slashes[1]?10:0),i}function me(e){var t,i,n,r;let{distance:s,child:a,ancestor:o}=e,l=[],d=((null===(t=document)||void 0===t||null===(i=t.location)||void 0===i?void 0:i.pathname)||"").substr(1);d&&(l=d.split("/").slice(0,3));const c={created:(new Date).getTime(),distance:s,videoId:(null==a?void 0:a.id)||null,videoClassNames:[...(null==a?void 0:a.classList)||[]],videoAttributes:null!==(n=null==a?void 0:a.getAttributeNames())&&void 0!==n?n:[],parentId:o.id||null,parentTag:o.tagName,parentClassNames:[...(null==o?void 0:o.classList)||[]],parentAttributes:null!==(r=null==o?void 0:o.getAttributeNames())&&void 0!==r?r:[],slashes:l};return c.maxScore=pe(c,c),c}async function fe(){const e=`fs::${location.hostname}`;return{key:e,profiles:(await function(e){return new Promise(((t,i)=>{chrome.storage.local.get(e,(e=>{chrome.runtime.lastError?i(chrome.runtime.lastError):t(e)}))}))}(e))[e]||[]}}class ge{constructor(){t(this,"lock",void 0),t(this,"operationLock",void 0),t(this,"toggleSafe",(async e=>{this.operationLock||(this.operationLock=!0,await this.toggle(e).finally((()=>{delete this.operationLock})))})),t(this,"toggle",(async e=>{this.lock?await this.release():document.fullscreenElement?await document.exitFullscreen():null!=e&&e.isConnected&&x&&await this.activate(e)})),t(this,"ensureProper",(()=>{if(!this.lock)return;let{video:e,resetCount:t}=this.lock;e&&(e.controls||(e.controls=!0,t++>1e3&&this.release()),"initial"!==e.style.pointerEvents&&(e.style.pointerEvents="initial",t++>1e3&&this.release()),"none"!==e.style.background&&(e.style.background="none",t++>1e3&&this.release()))})),t(this,"release",(async()=>{var e;let{lock:t,lock:{video:i,originalValues:{scrollX:n,scrollY:r}}}=this;t&&(null===(e=t.mo)||void 0===e||e.disconnect(),delete t.mo,t.modifiedSheets.forEach((e=>{let{sheet:t,original:i}=e;t.disabled=i})),i.controls=t.originalValues.controls,i.style.pointerEvents=t.originalValues.pointerEvents,i.style.background=t.originalValues.background,document.fullscreenElement&&await document.exitFullscreen(),window.scrollTo(n,r),delete this.lock)})),t(this,"handleFsChange",(()=>{var e;const t=null===(e=this.lock)||void 0===e?void 0:e.video;t&&t.getRootNode().fullscreenElement!==t&&this.release()})),window.addEventListener("fullscreenchange",this.handleFsChange,{capture:!0,passive:!0}),window.addEventListener("webkitfullscreenchange",this.handleFsChange,{capture:!0,passive:!0})}async activate(e){await e.requestFullscreen(),this.lock={video:e,originalValues:{controls:e.controls,pointerEvents:e.style.pointerEvents,background:e.style.background,scrollX:window.scrollX,scrollY:window.scrollY},mo:new MutationObserver(this.ensureProper),modifiedSheets:[],resetCount:0};let{mo:t,modifiedSheets:i}=this.lock;t.observe(e,{attributeFilter:["controls","style"]}),[...document.styleSheets].forEach((e=>{try{const t=e.disabled;e.disabled=!0,i.push({sheet:e,original:t})}catch(e){}})),this.ensureProper()}}var ye=i(3174).$;function we(){ye.visibleSync=new be,chrome.runtime.connect({name:"canopy"}).onDisconnect.addListener((()=>{var e,t,i,n;null===(e=ye.visibleSync)||void 0===e||e.release(),delete ye.visibleSync,null===(t=ye.configSync)||void 0===t||t.release(),delete ye.configSync,null===(i=ye.overlay)||void 0===i||i.release(),delete ye.overlay,null===(n=ye.keyListener)||void 0===n||n.release(),delete ye.keyListener}))}class be{constructor(){t(this,"timeoutId",void 0),t(this,"release",(()=>{window.removeEventListener("visibilitychange",this.handleChange,!0)})),t(this,"handleChange",(()=>{this.timeoutId&&(this.timeoutId=clearTimeout(this.timeoutId)),document.hidden?this.timeoutId=setTimeout(this.sync,1500):this.sync()})),t(this,"sync",(()=>{var e,t;document.hidden?(null===(e=ye.configSync)||void 0===e||e.release(),delete ye.configSync):ye.configSync=null!==(t=ye.configSync)&&void 0!==t?t:new le})),window.addEventListener("visibilitychange",this.handleChange,{capture:!0,passive:!0}),this.sync()}}!async function(){var e,t;if(document.gvar=ye,ye.mediaTower=new G,ye.smartFs=new ve,ye.nativeFs=new ge,ye.keyListener=new o,"ajaxframe"!==(null===(e=window.frameElement)||void 0===e?void 0:e.id)&&(s(),h=null!==(t=h)&&void 0!==t?t:navigator.userAgent.includes("Firefox/"),h&&s(!0)),await Promise.all([d().then((e=>{ye.tabInfo=e}),(e=>{}))]),!ye.tabInfo){await new Promise(((e,t)=>setTimeout((()=>e(!0)),3e3)));try{await Promise.all([d().then((e=>{ye.tabInfo=e}))])}catch(e){return}}const i=await V({staticOverlay:!0,indicatorInit:!0})||{};ye.overlay=ye.overlay||new ce(i.staticOverlay),ye.overlay.setInit(i.indicatorInit||{}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",we,{capture:!0,passive:!0,once:!0}):we()}()}()}();