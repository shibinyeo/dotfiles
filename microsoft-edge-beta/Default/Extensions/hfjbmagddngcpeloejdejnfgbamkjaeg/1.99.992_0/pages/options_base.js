"use strict";__filename="pages/options_base.js",define(["require","exports","./async_bg"],function(t,n,i){var e,s,r,u,o,a;Object.defineProperty(n,"__esModule",{value:true}),n.t=n.e=n.s=n.r=n.u=n.o=n.a=n.h=n.f=n.v=n.p=void 0,e={},s=function(){var t,e,s,r,u,o;if("en"!==i.m){if(t=i.m.split(",")[0],e=navigator.language||t,(r=(s=i.$("#keyMappings"))&&n.t("keyMappingsP"))&&(s.placeholder=r),e&&(!t.startsWith("zh")||"zh-CN"!==e))for(s of i.$$("input[type=text], textarea"))s.lang=e;for(s of i.$$("[data-i]"))o=(u=s.dataset.i).endsWith("-t"),null!=(r=i.y(o?u.slice(0,-2):u))&&(o?s.title=r:s.textContent=r);document.documentElement.lang="zh"===t?"zh-CN":t}},n.p=s,window.__extends=function(t,n){var i=function(){this.constructor=t};i.prototype=n.prototype,t.prototype=new i},n.v=function(t,n,i,e){var s,r=0,u=function(){var o=Date.now()-s;if(!(o<n-4&&o>=0))return r=0,s!==e?t.call(i):void 0;r=setTimeout(u,n-o)};return e=e?1:0,function(){if(s=Date.now(),!r)return r=setTimeout(u,n),e?(e=s,t.call(i)):void 0;e&&(e=s-1)}},n.f=function(t){var s,r,u="string"!=typeof t?t.type:t;for(s of e[u]||[])for(r of"string"==typeof s.g?i.$$(s.g):[s.g])"on"!==s.k?r.addEventListener(u,s.x,s.k):r["on"+u]=s.x;e[u]=null,removeEventListener(u,n.f,true)},n.h=function(t,i,s,r){var u=e[i];u||(addEventListener(i,n.f,true),u=e[i]=[]),u.push({g:t,x:s,k:r||false})},r=null,n.a=function(t){r=t},n.o=function(){return r},n.u={b:"",S:null,w:function(){r=null},N:function(){return r?r instanceof Promise?r:Promise.resolve():(n.u.S||i.O(0).then(function(t){n.u.S=t[0],i.P(t[1]),n.u.b=t[2],i.R(1)}),r=i.O(1).then(function(t){r=t}))},z:function(t){var n,i=this;return null==r&&this.N(),r instanceof Promise?r.then(function(){return i.z(t)}):void 0!==(n=r[t])?n:this.S[t]},J:function(t,e){var s,u;return u=e,void 0!==(s=n.u.S[t])&&("object"==typeof s?JSON.stringify(e)===JSON.stringify(s):e===s)&&(u=null),i.O(2,{key:t,val:u}).then(function(n){r[t]=null!==n?n:e})},L:{__proto__:null,filterLinkHints:"f",keyLayout:"l",mouseReachable:"e",keyboard:"k",keyupTime:"u",linkHintCharacters:"c",linkHintNumbers:"n",passEsc:"p",regexFindMode:"r",smoothScroll:"s",scrollStepSize:"t",waitForEnter:"w"},M:{__proto__:null,c:1,n:1,l:1,d:1}},n.u.N(),u=(function(){function t(t,i){var e=t.id;this.T=e,this.j=t,this.C=this.E=null,this.K=false,e in n.u.L?i=this.A.bind(this,i):"autoDarkMode"!==e&&"autoReduceMotion"!==e||(i=this.D.bind(this,i)),this.E=n.v(i,330,this,1),this.H(t)}return t.prototype.F=function(){},t.prototype.Z=function(){var n,e=this;if(this.K=true,(n=this.q())instanceof Promise)return n.then(t.prototype.Z.bind(this));this.C=n,t.B||i.V(function(){e.G(e.C)})},t.prototype.q=function(){return n.u.z(this.T)},t.prototype.I=function(t){var n=this.Q;return n?n.U(t):t},t.prototype.W=function(){return true},t.prototype.X=function(){return __awaiter(this,void 0,void 0,function*(){var t,n=this,e=this.Y(),s="object"==typeof e,r=s?JSON.stringify(this.C):this.C,u=s?JSON.stringify(e):e;if(u!==r)return r=u,e=(t=this.I(e))instanceof Promise?yield t:t,e=yield this.tt(e),this.C=e,this.K=true,(r!==(s?JSON.stringify(e):e)||this.nt(e))&&i.V(function(){n.G(n.C,true)}),this.F()})},t.prototype.it=function(){var t=this.q(),n=!this.et(this.C,t);return n&&this.et(t,this.Y())?(this.C=t,this.K=true,false):n},t.prototype.tt=function(i){return __awaiter(this,void 0,void 0,function*(){return yield n.u.J(this.T,i),this.T in n.u.L&&t.st.push(this.T),this.q()})},t.prototype.nt=function(){return false},t.prototype.et=function(t,n){return t===n},t.rt=null,t.B=false,t})(),n.r=u,o=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.H=function(t){var i=this;this.ut=t.querySelector("#exclusionTemplate").content.querySelector(".exclusionRule"),this.ot=t.querySelector("tbody"),this.at=[],n.h(this.ot,"input",e.ht),n.h(this.ot,"input",this.E),n.h(this.ot,"click",function(t){return i.ct(t)}),this.ft=false,n.h("#exclusionAddButton","click",function(){return i.lt("")},"on")},e.prototype.vt=function(){},e.ht=function(t){var n=t.target,i=n.vnode;i&&(i.pt|=n.classList.contains("pattern")?1:2)},e.prototype.lt=function(t,n){var e,s=false!==n,r=s&&this.ot.childElementCount,u=this.dt(this.ot,{passKeys:"",pattern:t});t&&(u._t={passKeys:"",pattern:""}),e=this.at[this.at.length-1],s&&(r>=4&&this.j.scrollBy(0,40),i.V(function(){return e.mt.focus()})),t&&this.E(),this.vt(1)},e.prototype.G=function(t){var n,e,s;if(!this.ft)for(n of(this.ft=true,u.st&&(this.ut.draggable=true),"en"!==i.m?i.$$("[title]",this.ut):[]))(e=i.y(n.title))&&(n.title=e);return this.ot.textContent="",this.at=[],t.length<=0||(1===t.length?this.dt(this.ot,t[0]):(s=document.createDocumentFragment(),t.forEach(this.dt.bind(this,s)),this.ot.appendChild(s))),this.vt(t.length)},e.prototype.yt=function(){return true},e.prototype.dt=function(t,n){var i,e,s,r,u=n.passKeys,o=n.pattern,a={gt:n,kt:null,pt:0,xt:false,mt:null,bt:null,_t:n};return a.xt=this.yt(a),a.xt?(e=(i=document.importNode(this.ut,true)).querySelector(".pattern"),s=i.querySelector(".passKeys"),r=u.trimRight(),e.value=o,o&&(e.placeholder=""),s.value=r,r&&(s.placeholder=""),a.mt=e,a.bt=s,e.vnode=a,s.vnode=a,this.St(a,o,u),this.at.push(a),t.appendChild(i),a):(this.at.push(a),a)},e.wt=function(t){t.gt.pattern&&t.bt.placeholder&&(t.bt.placeholder="")},e.prototype.ct=function(t){var n,i=t.target;if("path"===i.localName&&(i=i.parentElement),"svg"===i.localName&&(i=i.parentElement),i.classList.contains("remove"))return(i=i.parentNode.parentNode).classList.contains("exclusionRule")?(n=i.querySelector(".pattern").vnode,i.remove(),4&n.pt&&n._t.pattern?Object.assign(n,{gt:{passKeys:"",pattern:""},kt:false,pt:12,mt:null,bt:null}):this.at.splice(this.at.indexOf(n),1),this.E(),this.vt(0)):void 0},e.Nt=function(t,n,i){var e=i.toLowerCase();return n||1!==i.length?i!==e?"<".concat(n,"s-").concat(e,">"):t:i},e.$t=function(t){return t&&t.replace(/<(?!<)((?:[acm]-){0,3})(\S|[A-Za-z]\w+)>/g,e.Nt)},e.prototype.Y=function(t){var n,i,s,r,u,o,h,c,f,l,v,p=[];for(n of(t=true===t,this.at))t&&!n.xt||((i=n.pt)&&3&i?(s=1&i?n.mt.value.trim():n.gt.pattern,r=false,u=2&i?n.bt.value:n.gt.passKeys,s?(1&i&&(o=/^(about|vimium):/i.test(s),(h=s.startsWith(":")?0:s.indexOf("://"))&&(/^[\^*]|[^\\][$()*+?\[\]{|}]/.test(s)?s.startsWith("`")||(s.startsWith("^")?(f=".*$".includes(s.slice(-2))?s.endsWith(".*$")?3:s.endsWith(".*")?2:0:0,s=0!==f&&"\\"!==s[s.length-f]?s.slice(0,-f):s):(r=!s.includes("/",h+3),s.endsWith("*")&&(s=s.slice(0,/^[^\\]\.\*$/.test(s.slice(-3))?-2:-1),r=false),c=(h<0&&!o?"^https?://":"^")+((c=s=s.startsWith(".*")&&!/[(\\[]/.test(s)?"*."+s.slice(2):s).startsWith("*")&&"."!==c[1]?"[^/]"+c:(c=c.replace(/\./g,"\\.")).startsWith("*")?c.replace("*\\.","(?:[^./]+\\.)*?"):c.replace("://*\\.","://(?:[^./]+\\.)*?")),s=a(c,"")?c:s.includes("*")||s.includes("/")||o?":"+s:":https://"+(s.startsWith(".")?s.slice(1):s))):(r=!s.includes("/",h+3)&&!o,s=(h<0&&!o?":http://":":")+(s=s.replace(/\\(.)/g,"$1")))),r&&(s+="/")),2&i&&u&&((l=(u=e.$t(u)).match(/<(?!<)(?:a-)?(?:c-)?(?:m-)?(?:s-)?(?:[a-z]\w+|[^\sA-Z])>|\S/g))&&((v="^"===l[0]&&l.length>1)&&l.shift(),l.sort(),v?l.unshift("^"):"^"===l[0]&&(l.shift(),l.push("^"))),u=(u=l?l.join(" ")+" ":"").replace(/<escape>/gi,"<esc>")),this.St(n,s,u),p.push(n.gt)):this.St(n,"",u)):n.gt.pattern&&p.push(n.gt));return p},e.prototype.St=function(t,n,i){var s=!t.gt.passKeys&&!!i;t.gt={passKeys:i,pattern:n},t.kt=null,t.pt&=-4,s&&e.wt(t)},e.prototype.F=function(){var t,n,i,e;for(t=0,n=this.at;t<n.length;t++)(i=n[t]).xt&&(8&i.pt?n.splice(t--,1):(i._t=i.gt,i.mt.value!==i.gt.pattern&&(i.mt.value=i.gt.pattern),e=i.gt.passKeys.trim(),i.bt.value!==e&&(i.bt.value=e)))},e.prototype.et=function(t,n){return JSON.stringify(t)===JSON.stringify(n)},e})(u),n.s=o,a=function(t,n){try{return new RegExp(t,n)}catch(t){return null}},n.e=i.Ot<48||devicePixelRatio<2&&i.Ot>=61?function(){var t=document.createElement("style"),n=devicePixelRatio,e=i.Ot>=61&&n>=1,s=e||i.Ot>=48?1/n:1;s=(""+(s+=999e-8)).slice(0,7).replace(/\.?0+$/,""),t.textContent=e?"html { --vc-tiny: ".concat(s,"px; }"):"* { border-width: ".concat(s,"px !important; }"),document.head.appendChild(t)}:null,n.t=function(t,n){return i.y(t,n)||""}});