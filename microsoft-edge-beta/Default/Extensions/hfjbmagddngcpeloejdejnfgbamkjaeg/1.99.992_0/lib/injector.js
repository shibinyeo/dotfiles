"use strict";var VimiumInjector;(function(){var t,n=VimiumInjector,e={id:"",alive:-1,host:"",version:"",cache:null,clickable:void 0,eval:null,reload:null,checkIfEnabled:null,$:null,$h:null,$m:null,$r:null,$g:null,getCommandCount:null,callback:null,destroy:null};if(n)for(t of Object.keys(n))e[t]=n[t];e.alive=-1,e.$g=null,VimiumInjector=e})(),(function(t,n){function e(t,e){var o,u,i,r,a,m,h,p,k,C,$,E,w,y=VimiumInjector,L=y&&y.clickable,T=y&&y.callback;if(t||(i=e&&e.message,r=s.id||location.host||location.protocol,u=!!(i&&i.lastIndexOf("not exist")>=0&&s.id),false===t?o=": not in the allow list.":!u&&e?o=i?":\n\t".concat(i):": no backend found.":b>3?(o=i?":\n\t".concat(i):": retried but failed (".concat(t,")."),u=false):(setTimeout(c,200*b),b++,u=true),u||(o=o||" (".concat(b," retries)."),console.log("%cVimium C%c: %cfail%c to inject into %c%s%c %s","color:red","color:auto","color:red","color:auto","color:#0c85e9",r,"color:auto",o),T&&y.callback(-1,o))),y&&"function"==typeof y.destroy&&y.destroy(true),a=t?t.h:"",m=VimiumInjector={id:g,alive:0,host:l?t?t.host:"":g,version:t?t.version:"",cache:null,clickable:L,eval:null,reload:n(f),checkIfEnabled:null,$:null,$h:function(t){return"vimium-c."+t+a},$m:function(t){VimiumInjector&&VimiumInjector.$r("object"==typeof t?t.t:t)},$r:function(){},$g:null!=v?""===v||"true"===v.toLowerCase():null,getCommandCount:null,callback:T||null,destroy:null},h=document.documentElement,!(t&&h instanceof HTMLHtmlElement))return e;for(E of(k=(p=document.contains(d)?d:(document.head||h).lastChild||document.head).nextSibling,C=p.parentElement,$=[],t.s))(w=document.createElement("script")).type="text/javascript",w.async=false,w.src=E,C.insertBefore(w,k),$.push(w);$.length>0&&($[$.length-1].onload=function(){this.onload=null;for(var t=$.length;0<=--t;)$[t].remove()}),T&&m.callback(0,"loading")}function o(){removeEventListener("DOMContentLoaded",o,true),!i||h?h(function(){h(function(){setTimeout(c,0)},{timeout:67})},{timeout:330}):setTimeout(c,67)}var u,c,l=!!0,i=!!0,r=l&&"object"==typeof browser&&!("tagName"in browser)?browser:null,a=!!l&&!!(r&&r.runtime&&r.runtime.connect),s=(a?browser:chrome).runtime,d=document.currentScript,f=d.src,m=f.indexOf("://")+3,v=d.dataset.blockFocus,h=i?window.requestIdleCallback:requestIdleCallback,b=1,g=f.slice(m,f.indexOf("/",m));l&&g.indexOf("-")>0&&(g=d.dataset.vimiumId||"vimium-c@gdh1995.cn"),VimiumInjector.id=g=d.dataset.extensionId||g,i&&(h="function"!=typeof h||"tagName"in h?null:h),u=a?function(){s.sendMessage(g,{handler:99,scripts:true}).then(e,function(t){return e(void 0,t)})}:function(){s.sendMessage(g,{handler:99,scripts:true},function(t){var n=s.lastError;return n?e(void 0,n):e(t),n})},c=function(){try{u()}catch(t){console.log("Can not send message to the extension of %o: %s",g,t&&t.message||t+"")}},"loading"!==document.readyState?o():addEventListener("DOMContentLoaded",o,{capture:true,once:true})})(0,function(t){return function(n){function e(){var e=document.documentElement,o=document.head||document.body||e,u=document.createElement("script");o&&(u.type="text/javascript",u.async=false,u.src=t,console.log("%cVimium C%c begins to reload%s.","color:red","color:auto",1===n?" because it has been updated.":""),o.appendChild(u))}var o,u=VimiumInjector;u&&(o=u.clickable,"function"==typeof u.destroy&&u.destroy(true),u.clickable=o),n?setTimeout(e,200):e()}}),(!document.currentScript||"false"!==(document.currentScript.dataset.vimiumHooks||"").toLowerCase())&&null!==VimiumInjector.clickable&&(function(){var t,n,e,o,u,c,l,i,r;VimiumInjector.clickable=VimiumInjector.clickable||new WeakSet,t=EventTarget,true!==(e=(n=t.prototype).addEventListener).vimiumHooked&&(o=HTMLAnchorElement,u=Element,c=n.addEventListener=function addEventListener(t,n){var c,l,i;return"click"===t&&!(this instanceof o)&&n&&this instanceof u&&(c=VimiumInjector)&&c.clickable&&c.clickable.add(this),2===(i=(l=arguments).length)?e.call(this,t,n):3===i?e.call(this,t,n,l[2]):e.apply(this,l)},i=(l=Function.prototype).toString,r=l.toString=function toString(){return i.apply(this===c?e:this===r?i:this,arguments)},c.vimiumHooked=true,t.vimiumRemoveHooks=function(){delete t.vimiumRemoveHooks,n.addEventListener===c&&(n.addEventListener=e),l.toString===r&&(l.toString=i)},c.prototype=r.prototype=void 0)})();